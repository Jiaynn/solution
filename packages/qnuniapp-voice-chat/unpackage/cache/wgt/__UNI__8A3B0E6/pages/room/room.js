!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=26)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return weex.requireModule(e)}},function(e,t,n){"use strict";var r=n(9),o=n(6),i=n(25);var s=Object(i.a)(o.default,r.b,r.c,!1,null,null,"3ab669b4",!1,r.a,void 0);(function(e){this.options.style||(this.options.style={}),Vue.prototype.__merge_style&&Vue.prototype.__$appStyle__&&Vue.prototype.__merge_style(Vue.prototype.__$appStyle__,this.options.style),Vue.prototype.__merge_style?Vue.prototype.__merge_style(n(24).default,this.options.style):Object.assign(this.options.style,n(24).default)}).call(s),t.default=s.exports},function(e,t,n){"use strict";t.__esModule=!0,t.QNVideoFrameType=t.QNAudioMixerState=t.QNSessionPresetType=t.QNVideoFillModeType=t.QNAVCaptureVideoOrientation=t.QNVideoWaterMarkSize=t.QNAudioDevice=t.QNLiveStreamingErrorInfoCode=t.QNLiveStreamingErrorInfoType=t.QNConnectionDisconnectedReason=t.QNNetworkGrade=t.QNTrackProfile=t.QNRenderMode=t.QNConnectionState=t.QNRTCLogLevel=t.QNRTCTrackKind=t.QNRTCBwePolicy=t.QNRTCPolicy=t.QNRTCCameraFacing=void 0,function(e){e.back="back",e.front="front"}(t.QNRTCCameraFacing||(t.QNRTCCameraFacing={})),function(e){e.forceUDP="forceUDP",e.forceTCP="forceTCP",e.preferUDP="preferUDP"}(t.QNRTCPolicy||(t.QNRTCPolicy={})),function(e){e.TCC="TCC",e.GCC="GCC"}(t.QNRTCBwePolicy||(t.QNRTCBwePolicy={})),function(e){e.audio="audio",e.video="video"}(t.QNRTCTrackKind||(t.QNRTCTrackKind={})),function(e){e.verbose="verbose",e.info="info",e.warning="warning",e.error="error",e.none="none"}(t.QNRTCLogLevel||(t.QNRTCLogLevel={})),function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING",e.RECONNECTED="RECONNECTED"}(t.QNConnectionState||(t.QNConnectionState={})),function(e){e.FILL="FILL",e.ASPECT_FILL="ASPECT_FILL",e.ASPECT_FIT="ASPECT_FIT"}(t.QNRenderMode||(t.QNRenderMode={})),function(e){e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(t.QNTrackProfile||(t.QNTrackProfile={})),function(e){e.INVALID="INVALID",e.EXCELLENT="EXCELLENT",e.GOOD="GOOD",e.FAIR="FAIR",e.POOR="POOR"}(t.QNNetworkGrade||(t.QNNetworkGrade={})),function(e){e.LEAVE="LEAVE",e.KICKED_OUT="KICKED_OUT",e.ROOM_CLOSED="ROOM_CLOSED",e.ROOM_FULL="ROOM_FULL",e.ERROR="ERROR"}(t.QNConnectionDisconnectedReason||(t.QNConnectionDisconnectedReason={})),function(e){e.START="START",e.STOP="STOP",e.UPDATE="UPDATE"}(t.QNLiveStreamingErrorInfoType||(t.QNLiveStreamingErrorInfoType={})),function(e){e.ERROR_NO_PERMISSION="ERROR_NO_PERMISSION",e.ERROR_INVALID_STATE="ERROR_INVALID_STATE",e.ERROR_INVALID_PARAMETER="ERROR_INVALID_PARAMETER",e.ERROR_SIGNAL_TIMEOUT="ERROR_SIGNAL_TIMEOUT",e.SERVER_ERROR="SERVER_ERROR"}(t.QNLiveStreamingErrorInfoCode||(t.QNLiveStreamingErrorInfoCode={})),function(e){e.SPEAKER_PHONE="SPEAKER_PHONE",e.EARPIECE="EARPIECE",e.WIRED_HEADSET="WIRED_HEADSET",e.BLUETOOTH="BLUETOOTH",e.NONE="NONE"}(t.QNAudioDevice||(t.QNAudioDevice={})),function(e){e.LARGE="LARGE",e.MEDIUM="MEDIUM",e.SMALL="SMALL"}(t.QNVideoWaterMarkSize||(t.QNVideoWaterMarkSize={})),function(e){e.AVCaptureVideoOrientationPortrait="AVCaptureVideoOrientationPortrait",e.AVCaptureVideoOrientationLandscapeRight="AVCaptureVideoOrientationLandscapeRight",e.AVCaptureVideoOrientationLandscapeLeft="AVCaptureVideoOrientationLandscapeLeft"}(t.QNAVCaptureVideoOrientation||(t.QNAVCaptureVideoOrientation={})),function(e){e.QNVideoFillModeNone="QNVideoFillModeNone",e.QNVideoFillModeStretch="QNVideoFillModeStretch",e.QNVideoFillModePreserveAspectRatio="QNVideoFillModePreserveAspectRatio",e.QNVideoFillModePreserveAspectRatioAndFill="QNVideoFillModePreserveAspectRatioAndFill"}(t.QNVideoFillModeType||(t.QNVideoFillModeType={})),function(e){e.AVCaptureSessionPreset352x288="AVCaptureSessionPreset352x288",e.AVCaptureSessionPreset640x480="AVCaptureSessionPreset640x480",e.AVCaptureSessionPreset1280x720="AVCaptureSessionPreset1280x720",e.AVCaptureSessionPreset1920x1080="AVCaptureSessionPreset1920x1080",e.AVCaptureSessionPreset3840x2160="AVCaptureSessionPreset3840x2160",e.AVCaptureSessionPresetiFrame960x540="AVCaptureSessionPresetiFrame960x540",e.AVCaptureSessionPresetiFrame1280x720="AVCaptureSessionPresetiFrame1280x720"}(t.QNSessionPresetType||(t.QNSessionPresetType={})),function(e){e.MIXING="MIXING",e.PAUSED="PAUSED",e.STOPPED="STOPPED",e.COMPLETED="COMPLETED"}(t.QNAudioMixerState||(t.QNAudioMixerState={})),function(e){e.YUV_NV21="YUV_NV21",e.TEXTURE_RGB="TEXTURE_RGB",e.TEXTURE_OES="TEXTURE_OES"}(t.QNVideoFrameType||(t.QNVideoFrameType={}))},function(e,t,n){"use strict";(function(e){var n=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};t.__esModule=!0,t.QNTrack=void 0;var r=e("QNRTC-UniPlugin-QNRtcTrack"),o=e("globalEvent"),i=function(){function e(e){var t=e.identifyID,n=e.kind,r=e.tag,o=e.trackID,i=e.raw,s=e.userID;this.identifyID=t,this.kind=n,this.tag=r,this.trackID=o,this.raw=i,this.userID=s}return e.prototype.on=function(e,t){var r=this;o.addEventListener(e,(function(e){var o=e.trackID,i=n(e,["trackID"]);o&&o===r.trackID&&t(i)}))},e.prototype.off=function(e,t){o.removeEventListener(e,t)},e.prototype.getMuted=function(){return r.getMuted(this.identifyID)},e}();t.QNTrack=i}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNLocalTrack=void 0;var i=n(3),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setMuted=function(e){return s.setMuted(this.identifyID,e)},t}(i.QNTrack);t.QNLocalTrack=a}).call(this,n(0).default)},function(e,t){e.exports={"@VERSION":2}},function(e,t,n){"use strict";var r=n(7),o=n.n(r);t.default=o.a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(34))&&r.__esModule?r:{default:r},i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(39)),s=n(40),a=n(23);function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}var c={data:function(){return{isMicOn:!1,screenWidth:0,screenHeight:0,roomId:"",rtcClient:null,imClient:null,rtcInfo:null,imConfig:null,allUserList:null,userInfo:null,roomInfo:null,trackMap:new Map,localMicTrack:null,messages:[],inputValue:"",imAppKey:"cigzypnhoyno"}},methods:{onCloseRoom:function(){uni.navigateBack()},onToggleMic:function(){this.isMicOn=!this.isMicOn,this.localMicTrack.setMuted(!this.isMicOn)},enableHeartBeat:function(){var t=this;!function n(r){t.timer=setTimeout((function(){s.BaseRoomApi.heartBeat({roomId:t.roomId}).then((function(t){e("log","BaseRoomApi.heartBeat result",t," at pages/room/room.nvue:113"),n(t.data.interval)}))}),r)}()},initRTC:function(){var t=this;o.default.configRTC(),this.rtcClient=o.default.createClient(),this.rtcClient.on("onConnectionStateChanged",(function(n){var r=n.state,o=n.info;e("log","onConnectionStateChanged",r,o," at pages/room/room.nvue:131"),"CONNECTED"===r?(t.enableHeartBeat(),t.enableMic(),uni.hideLoading(),(0,a.uniShowToast)({title:"\u623f\u95f4\u8fde\u63a5\u6210\u529f"})):"DISCONNECTED"===r?"KICKED_OUT"===o.reason?(0,a.uniShowModal)({content:"\u88ab\u8e22\u51fa\u623f\u95f4"}).then((function(e){e.confirm&&uni.navigateBack()})):"ROOM_CLOSED"===o.reason?(0,a.uniShowModal)({content:"\u623f\u95f4\u88ab\u5173\u95ed"}):"ROOM_FULL"===o.reason?(0,a.uniShowModal)({content:"\u623f\u95f4\u4eba\u6570\u5df2\u6ee1"}):"ERROR"===o.reason?(0,a.uniShowModal)({content:"\u53d1\u751f\u9519\u8bef\u5f02\u5e38\u65ad\u5f00"}):o.reason:"RECONNECTING"===r?uni.showLoading({title:"\u91cd\u8fde\u4e2d..."}):"CONNECTING"===r?uni.showLoading({title:"\u623f\u95f4\u8fde\u63a5\u4e2d..."}):"RECONNECTED"===r?(uni.hideLoading(),(0,a.uniShowToast)({title:"\u5df2\u91cd\u8fde"})):e("log","unknown state",r," at pages/room/room.nvue:177")})),this.rtcClient.on("onUserJoined",(function(n){var r=n.remoteUserID;n.userData;t.trackMap.set(r,[]),e("log","onUserJoined",n," at pages/room/room.nvue:187")})),this.rtcClient.on("onUserLeft",(function(n){var r=n.remoteUserID;t.trackMap.delete(r),e("log","onUserLeft",n," at pages/room/room.nvue:195")})),this.rtcClient.on("onUserPublished",(function(n){var r=n.remoteUserID,o=n.trackList,i=t.trackMap.get(r)||[];t.trackMap.set(r,i.concat(o)),e("log","onUserPublished",n," at pages/room/room.nvue:209")})),this.rtcClient.on("onUserUnpublished",(function(n){var r=n.remoteUserID,o=n.trackList,i=t.trackMap.get(r)||[],s=o.map((function(e){return e.trackID})),a=i.filter((function(e){return!s.includes(e.trackID)}));t.trackMap.set(r,a),e("log","onUserUnpublished",n," at pages/room/room.nvue:224")})),this.rtcClient.on("onUserReconnected",(function(t){t.remoteUserID;e("log","onUserReconnected",t," at pages/room/room.nvue:231")})),this.rtcClient.on("onUserReconnecting",(function(t){t.remoteUserID;e("log","onUserReconnecting",t," at pages/room/room.nvue:238")}))},enableMic:function(){var t=this;this.localMicTrack=o.default.createMicrophoneAudioTrack({tag:"mic"}),this.rtcClient.publish([this.localMicTrack],(function(n,r){e("log","onEnableMic publish",n,r," at pages/room/room.nvue:249"),n?(t.isMicOn=!0,(0,a.uniShowToast)({title:"\u4e0a\u9ea6\u6210\u529f"})):(0,a.uniShowToast)({title:"\u4e0a\u9ea6\u5931\u8d25, \u9519\u8bef\u4fe1\u606f\uff1a".concat(r.message)})}))},joinRoom:function(){var t=this;return s.BaseRoomApi.joinRoom({roomId:this.roomId}).then((function(n){return t.rtcInfo=n.data.rtcInfo,t.imConfig=n.data.imConfig,t.allUserList=n.data.allUserList,t.userInfo=n.data.userInfo,t.roomInfo=n.data.roomInfo,e("log","roomInfo",t.roomInfo," at pages/room/room.nvue:275"),t.rtcClient.join(t.rtcInfo.roomToken)}))},sendMsg:function(e,t){this.imClient.sysManage.sendGroupMessage({content:JSON.stringify({action:e,msgStr:{senderId:this.userInfo.userId,senderName:this.userInfo.nickname,msgContent:t}}),gid:this.imConfig.imGroupId})},onSendMessage:function(){this.sendMsg("text",this.inputValue),this.inputValue=""},getIMClient:function(){var t=this;return t.initCount=t.initCount||1,new Promise((function(n,r){if(t.initCount>20)return r("Instantiation failed");t.imClient||(t.imClient=i.init({autoLogin:!1,appid:t.imAppKey})),t.imClient&&t.imClient.isReady&&t.imClient.isReady()?(e("log","getIMClient resolve"," at pages/room/room.nvue:317"),n(t.imClient)):(e("log","getIMClient setTimeout"," at pages/room/room.nvue:320"),t.imClientInitTimer=setTimeout((function(){t.initCount++,n(t.getIM)}),1e3))}))},initIM:function(){var t=this;this.getIMClient().then((function(){(0,a.uniShowToast)({title:"IM\u521d\u59cb\u5316\u6210\u529f"});var n=s.StorageApi.getIMConfig();e("log","imConfig",n," at pages/room/room.nvue:334"),t.imClient.login({name:n.imUsername,password:n.imPassword}),t.imClient.on({loginSuccess:function(n){e("log","im loginSuccess",n," at pages/room/room.nvue:341"),(0,a.uniShowToast)({title:"IM\u767b\u5f55\u6210\u529f"}),e("log","this.imConfig",t.imConfig," at pages/room/room.nvue:345"),t.imClient.chatroomManage.join(t.imConfig.imGroupId).catch((function(t){return e("log","chatroomManage error1",t," at pages/room/room.nvue:347"),20017===t.data.code?Promise.resolve(t):Promise.reject(t)})).then((function(n){e("log","chatroomManage result",n," at pages/room/room.nvue:353"),(0,a.uniShowToast)({title:"\u6210\u529f\u52a0\u5165\u804a\u5929\u5ba4"}),t.sendMsg("notice","\u52a0\u5165\u4e86\u804a\u5929\u5ba4")})).catch((function(t){e("log","chatroomManage error2",t," at pages/room/room.nvue:359"),(0,a.uniShowToast)({title:"\u804a\u5929\u5ba4\u52a0\u5165\u5931\u8d25, \u9519\u8bef\u4fe1\u606f: ".concat(t.data.message)})}))},loginFail:function(t){e("log","im loginFail",t," at pages/room/room.nvue:366"),(0,a.uniShowToast)({title:"IM\u767b\u5f55\u5931\u8d25, \u9519\u8bef\u4fe1\u606f: ".concat(JSON.stringify(t))})},imGroupJoined:function(t){e("log","im imGroupJoined",t," at pages/room/room.nvue:372"),(0,a.uniShowToast)({title:"\u6210\u529f\u52a0\u5165\u804a\u5929\u5ba4"})},onGroupMessage:function(n){e("log","onGroupMessage result",n," at pages/room/room.nvue:378");var r=JSON.parse(n.content);t.messages=[{username:r.msgStr.senderName,content:r.msgStr.msgContent,action:r.action}].concat(t.messages)}})}))}},onLoad:function(t){var n=uni.getSystemInfoSync(),r=n.screenWidth,o=n.screenHeight;this.screenWidth=r,this.screenHeight=o,e("log","this.screenWidth",this.screenWidth," at pages/room/room.nvue:399"),e("log","this.screenHeight",this.screenHeight," at pages/room/room.nvue:400"),this.roomId=t.roomId,this.initRTC(),this.initIM(),this.joinRoom()},onUnload:function(){this.sendMsg("notice","\u79bb\u5f00\u4e86\u804a\u5929\u5ba4"),this.rtcClient.leave(),o.default.deinit(),clearTimeout(this.imClientInitTimer),this.imClientInitTimer=null,this.imClient.leave(this.imConfig.imGroupId),s.BaseRoomApi.leaveRoom(this.roomId)}};t.default=c}).call(this,n(10).default)},function(e,t){e.exports={".container":{"":{backgroundImage:["linear-gradient(100deg, #14243d, #223e56)",0,0,0],position:["fixed",0,0,0],top:[0,0,0,0],right:[0,0,0,0],bottom:[0,0,0,0],left:[0,0,0,0]}},".header":{"":{paddingTop:["10",0,0,1],paddingRight:["10",0,0,1],paddingBottom:["10",0,0,1],paddingLeft:["10",0,0,1],display:["flex",0,0,1],flexDirection:["row",0,0,1],alignItems:["center",0,0,1],justifyContent:["space-between",0,0,1]}},".room-info":{"":{display:["flex",0,0,2],flexDirection:["row",0,0,2],alignItems:["center",0,0,2],borderRadius:["52",0,0,2]}},".room-info-image":{"":{width:["32",0,0,3],borderRadius:[50,0,0,3],marginRight:["8",0,0,3]}},".room-info-text-title":{"":{color:["#ffffff",0,0,4],fontSize:["18",0,0,5]}},".room-info-text-total-users":{"":{color:["#ffffff",0,0,4],fontSize:["10",0,0,6]}},".chat":{"":{position:["fixed",0,0,7],bottom:["20",0,0,7]}},".chat-message-panel":{"":{height:["350",0,0,8],marginBottom:["20",0,0,8],transform:["rotate(180deg)",0,0,8]}},".chat-message-cell":{"":{transform:["rotate(180deg)",0,0,9],color:["#ffffff",0,0,9],borderRadius:["6",0,0,9],paddingTop:[0,0,0,9],paddingRight:["8",0,0,9],paddingBottom:[0,0,0,9],paddingLeft:["8",0,0,9]}},".chat-message-cell-content":{"":{width:["210",0,0,10],backgroundColor:["rgba(0,0,0,0.25)",0,0,10],marginTop:["2",0,0,10],marginRight:[0,0,0,10],marginBottom:["2",0,0,10],marginLeft:[0,0,0,10],paddingTop:["5",0,0,10],paddingRight:["5",0,0,10],paddingBottom:["5",0,0,10],paddingLeft:["5",0,0,10],borderRadius:["6",0,0,10]}},".text":{".chat-message-cell-content-username ":{color:["#CCDFFC",1,1,11]},".chat-message-cell-content ":{color:["#ffffff",0,1,12],fontSize:["16",0,1,12]}},".chat-tool":{"":{display:["flex",0,0,13],flexDirection:["row",0,0,13],alignItems:["center",0,0,13],paddingTop:[0,0,0,13],paddingRight:["20",0,0,13],paddingBottom:[0,0,0,13],paddingLeft:["20",0,0,13]}},".chat-tool-input":{"":{flex:[1,0,0,14],height:["40",0,0,14],backgroundColor:["rgba(0,0,0,0.25)",0,0,14],borderRadius:["16",0,0,14],color:["#ffffff",0,0,14],paddingTop:[0,0,0,14],paddingRight:["10",0,0,14],paddingBottom:[0,0,0,14],paddingLeft:["10",0,0,14]}},".chat-tool-button":{"":{height:["40",0,0,15],backgroundColor:["rgba(0,0,0,0.25)",0,0,15],borderWidth:[0,0,0,15],borderStyle:["solid",0,0,15],borderColor:["#000000",0,0,15]}},".icon-mic":{"":{width:["40",0,0,16],marginTop:[0,0,0,16],marginRight:["10",0,0,16],marginBottom:[0,0,0,16],marginLeft:["10",0,0,16]}},".icon-end":{"":{width:["30",0,0,17]}},"@VERSION":2}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("scroll-view",{staticStyle:{flexDirection:"column"},attrs:{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true"}},[r("view",{staticClass:["container"],style:{width:e.screenWidth+"px",height:e.screenHeight+"px"}},[r("view",{staticClass:["header"]},[r("view",{staticClass:["room-info"]},[r("u-image",{staticClass:["room-info-image"],attrs:{src:e.roomInfo&&e.roomInfo.image,mode:"widthFix"}}),r("view",{staticClass:["room-info-text"]},[r("view",[r("u-text",{staticClass:["room-info-text-title"],appendAsTree:!0,attrs:{append:"tree"}},[e._v("\u623f\u95f4\u540d\uff1a"+e._s(e.roomInfo&&e.roomInfo.title))])]),r("view",[r("u-text",{staticClass:["room-info-text-total-users"],appendAsTree:!0,attrs:{append:"tree"}},[e._v("\u4eba\u6570\uff1a"+e._s(e.roomInfo&&e.roomInfo.totalUsers))])])])],1),r("u-image",{staticClass:["icon-end"],attrs:{mode:"widthFix",src:n(30)},on:{click:e.onCloseRoom}})],1),r("view",{staticClass:["chat"],style:{width:e.screenWidth+"px"}},[r("list",{staticClass:["chat-message-panel"]},e._l(e.messages,(function(t,n){return r("cell",{key:n,staticClass:["chat-message-cell"],appendAsTree:!0,attrs:{append:"tree"}},["text"===t.action?r("view",{staticClass:["chat-message-cell-content"]},[r("view",{staticClass:["chat-message-cell-content-username"]},[r("u-text",{staticClass:["text"],appendAsTree:!0,attrs:{append:"tree"}},[e._v(e._s(t.username)+":")])]),r("view",{staticClass:["chat-message-cell-content-content"]},[r("u-text",{staticClass:["text"],appendAsTree:!0,attrs:{append:"tree"}},[e._v(e._s(t.content))])])]):"notice"===t.action?r("view",{staticClass:["chat-message-cell-content"]},[r("view",{staticClass:["chat-message-cell-content-username"]},[r("u-text",{staticClass:["text"],appendAsTree:!0,attrs:{append:"tree"}},[e._v(e._s(t.username)+" "+e._s(t.content))])])]):e._e()])})),0),r("view",{staticClass:["chat-tool"]},[r("u-input",{staticClass:["chat-tool-input"],attrs:{value:e.inputValue},on:{input:function(t){e.inputValue=t.detail.value}}}),r("u-image",{staticClass:["icon-mic"],attrs:{mode:"widthFix",src:n(31)("./icon-mic-"+(e.isMicOn?"on":"off")+".png")},on:{click:e.onToggleMic}}),r("button",{staticClass:["chat-tool-button"],attrs:{type:"primary"},on:{click:e.onSendMessage}},[e._v("\u53d1\u9001")])],1)])])])},o=[]},function(e,t,n){"use strict";function r(e){var t=Object.prototype.toString.call(e);return t.substring(8,t.length-1)}function o(){return"string"==typeof __channelId__&&__channelId__}function i(e,t){switch(r(t)){case"Function":return"function() { [native code] }";default:return t}}Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console[e].apply(console,n)},t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t.shift();if(o())return t.push(t.pop().replace("at ","uni-app:///")),console[s].apply(console,t);var a=t.map((function(e){var t=Object.prototype.toString.call(e).toLowerCase();if("[object object]"===t||"[object array]"===t)try{e="---BEGIN:JSON---"+JSON.stringify(e,i)+"---END:JSON---"}catch(n){e=t}else if(null===e)e="---NULL---";else if(void 0===e)e="---UNDEFINED---";else{var n=r(e).toUpperCase();e="NUMBER"===n||"BOOLEAN"===n?"---BEGIN:"+n+"---"+e+"---END:"+n+"---":String(e)}return e})),u="";if(a.length>1){var c=a.pop();u=a.join("---COMMA---"),0===c.indexOf(" at ")?u+=c:u+="---COMMA---"+c}else u=a[0];console[s](u)}},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNRemoteTrack=void 0;var i=n(3),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.isSubscribed=function(){return s.isSubscribed(this.identifyID)},t}(i.QNTrack);t.QNRemoteTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNLocalVideoTrack=void 0;var i=n(4),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.sendSEI=function(e,t,n){return s.sendSEI(this.identifyID,e,t,n)},t}(i.QNLocalTrack);t.QNLocalVideoTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.request=function(t){var n=t.success,u=t.fail,c=t.url,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["success","fail","url"]),d=a.dev.baseURL;return new Promise((function(t,a){var l=d+c;uni.request(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:l,success:function(i){e("log","uni.request ".concat(l," success"),i," at api/request.js:29"),0===i.data.code?t(i.data):([401001,401003].includes(i.data.code)?(0,r.uniShowModal)({content:"\u767b\u5f55\u6001\u5931\u6548\uff0c\u70b9\u51fb\u786e\u8ba4\u91cd\u65b0\u767b\u5f55",showCancel:!1,success:function(){o.StorageApi.clear(),(0,r.uniNavigateTo)({url:"/pages/login/login"})}}):(0,r.uniShowModal)({content:i.data.message,showCancel:!1}),a(new TypeError(i.data.message))),n&&n(i)},fail:function(t){e("log","uni.request ".concat(l," fail"),t," at api/request.js:55"),u&&u(t),a(t)}},f))}))},t.env=t.config=void 0;var r=n(23),o=n(14);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={dev:{baseURL:"http://10.200.20.28:5080"},prod:{baseURL:"https://niucube-api.qiniu.com"}};t.config=a;t.env="dev"}).call(this,n(10).default)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.StorageApi=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"setAuthorization",value:function(e){return uni.setStorageSync("authorization",e)}},{key:"getAuthorization",value:function(){var e=uni.getStorageSync("authorization");return e?"Bearer ".concat(e):""}},{key:"setIMConfig",value:function(e){return uni.setStorageSync("imConfig",e)}},{key:"getIMConfig",value:function(){return uni.getStorageSync("imConfig")}},{key:"clear",value:function(){return uni.clearStorageSync()}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();t.StorageApi=o},function(e,t,n){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0,t.QNRTCClient=void 0;var o=n(2),i=n(16),s=n(17),a=n(4),u=e("QNRTC-UniPlugin-QNRtcClient"),c=e("globalEvent"),f=function(){function e(){this.variationList=["onUserPublished","onUserUnpublished","onVideoSubscribed","onAudioSubscribed"]}return e.prototype.transformRemoteRTCTrack=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var u=a[n],c=r({identifyID:u.trackID,raw:u},u);u.kind===o.QNRTCTrackKind.audio?t.push(new s.QNRemoteAudioTrack(c)):t.push(new i.QNRemoteVideoTrack(c))}return t},e.prototype.transformLocalRTCTrack=function(e){for(var t=[],n=0,i=e;n<i.length;n++){var s=i[n],u=r({identifyID:s.trackID,userID:"",raw:s},s);s.kind,o.QNRTCTrackKind.audio,t.push(new a.QNLocalTrack(u))}return t},e.prototype.createRemoteTrackDataCallback=function(e){var t=this;return function(n){var r=t.transformRemoteRTCTrack(n.trackList),o={remoteUserID:n.remoteUserID,trackList:r};e(o)}},e.prototype.on=function(e,t){if(this.variationList.some((function(t){return t===e}))){var n=this.createRemoteTrackDataCallback(t);c.addEventListener(e,n)}else c.addEventListener(e,t)},e.prototype.off=function(e,t){c.removeEventListener(e,t)},e.prototype.join=function(e,t){return u.join(e,t)},e.prototype.leave=function(){return u.leave()},e.prototype.publish=function(e,t){return u.publish(e,(function(n){var r=n.onPublished,o=n.data,i=n.error;if(r){var s=function(t){var n=e.findIndex((function(e){return e.identifyID===t}));n>=0&&(e[n].trackID=o[t])};for(var a in o)s(a)}t(r,i)}))},e.prototype.unpublish=function(e){return u.unpublish(e)},e.prototype.subscribe=function(e){return u.subscribe(e)},e.prototype.unsubscribe=function(e){return u.unsubscribe(e)},e.prototype.getSubscribedTracks=function(e){var t=u.getSubscribedTracks(e);return this.transformRemoteRTCTrack(t)},e.prototype.getLocalAudioTrackStats=function(){return u.getLocalAudioTrackStats()},e.prototype.getLocalVideoTrackStats=function(){return u.getLocalVideoTrackStats()},e.prototype.getRemoteAudioTrackStats=function(){return u.getRemoteAudioTrackStats()},e.prototype.getRemoteVideoTrackStats=function(){return u.getRemoteVideoTrackStats()},e.prototype.getUserNetworkQuality=function(e){return u.getUserNetworkQuality(e)},e.prototype.getRemoteUsers=function(){for(var e=[],t=0,n=u.getRemoteUsers();t<n.length;t++){var r=n[t],o=this.transformRemoteRTCTrack(r.audioTracks),i=this.transformRemoteRTCTrack(r.videoTracks);e.push({userID:r.userID,videoTracks:i,audioTracks:o,userData:r.userData})}return e},e.prototype.getPublishedTracks=function(){var e=u.getPublishedTracks();return this.transformLocalRTCTrack(e)},e.prototype.sendMessage=function(e,t,n){return u.sendMessage(e,t,n)},e.prototype.getConnectionState=function(){return u.getConnectionState()},e.prototype.setAutoSubscribe=function(e){return u.setAutoSubscribe(e)},e.prototype.startLiveStreamingWithDirect=function(e){return u.startLiveStreamingWithDirect(e)},e.prototype.startLiveStreamingWithTranscoding=function(e){return u.startLiveStreamingWithTranscoding(e)},e.prototype.stopLiveStreamingWithDirect=function(e){return u.stopLiveStreamingWithDirect(e)},e.prototype.stopLiveStreamingWithTranscoding=function(e){return u.stopLiveStreamingWithTranscoding(e)},e.prototype.setTranscodingLiveStreamingTracks=function(e,t){return u.setTranscodingLiveStreamingTracks(e,t)},e.prototype.removeTranscodingLiveStreamingTracks=function(e,t){return u.removeTranscodingLiveStreamingTracks(e,t)},e}();t.QNRTCClient=f}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNRemoteVideoTrack=void 0;var i=n(11),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setProfile=function(e){return s.setProfile(this.identifyID,e)},t.prototype.isMultiProfileEnabled=function(){return s.isMultiProfileEnabled(this.identifyID)},t.prototype.getProfile=function(){return s.getProfile(this.identifyID)},t}(i.QNRemoteTrack);t.QNRemoteVideoTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNRemoteAudioTrack=void 0;var i=n(11),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setRemoteVolume=function(e){return s.setRemoteVolume(this.identifyID,e)},t.prototype.getRemoteVolume=function(){return s.getRemoteVolume(this.identifyID)},t}(i.QNRemoteTrack);t.QNRemoteAudioTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNCameraVideoTrack=void 0;var i=n(12),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.destroy=function(){return s.destroy(this.identifyID)},t.prototype.setSessionPreset=function(e){return s.setSessionPreset(this.identifyID,e)},t.prototype.startCapture=function(){return s.startCapture(this.identifyID)},t.prototype.stopCapture=function(){return s.stopCapture(this.identifyID)},t.prototype.switchCamera=function(){return s.switchCamera(this.identifyID)},t.prototype.turnLightOn=function(){return s.turnLightOn(this.identifyID)},t.prototype.turnLightOff=function(){return s.turnLightOff(this.identifyID)},t.prototype.manualFocus=function(e,t){return s.manualFocus(this.identifyID,e,t)},t.prototype.setExposureCompensation=function(e){return s.setExposureCompensation(this.identifyID,e)},t.prototype.getMaxExposureCompensation=function(){return s.getMaxExposureCompensation(this.identifyID)},t.prototype.getMinExposureCompensation=function(){return s.getMinExposureCompensation(this.identifyID)},t.prototype.setVideoOrientation=function(e){return s.setVideoOrientation(this.identifyID,e)},t.prototype.getVideoOrientation=function(){return s.getVideoOrientation(this.identifyID)},t.prototype.setZoom=function(e){return s.setZoom(this.identifyID,e)},t.prototype.getZooms=function(){return s.getZooms(this.identifyID)},t.prototype.setPreviewEnabled=function(e){return s.setPreviewEnabled(this.identifyID,e)},t.prototype.setBeauty=function(e){return s.setBeauty(this.identifyID,e)},t.prototype.previewMirrorFrontFacing=function(e){return s.previewMirrorFrontFacing(this.identifyID,e)},t.prototype.previewMirrorRearFacing=function(e){return s.previewMirrorRearFacing(this.identifyID,e)},t.prototype.encodeMirrorFrontFacing=function(e){return s.encodeMirrorFrontFacing(this.identifyID,e)},t.prototype.encodeMirrorRearFacing=function(e){return s.encodeMirrorRearFacing(this.identifyID,e)},t.prototype.pushImage=function(e){return s.pushImage(this.identifyID,e)},t.prototype.setWaterMark=function(e){return s.setWaterMark(this.identifyID,e)},t.prototype.clearWaterMark=function(){return s.clearWaterMark(this.identifyID)},t}(i.QNLocalVideoTrack);t.QNCameraVideoTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNMicrophoneAudioTrack=void 0;var i=n(20),s=n(21),a=e("QNRTC-UniPlugin-QNRtcTrack"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setVolume=function(e){return a.setVolume(this.identifyID,e)},t.prototype.createAudioMixer=function(e){return a.createAudioMixer(this.identifyID,e),new s.QNAudioMixer(this.identifyID,e)},t}(i.QNLocalAudioTrack);t.QNMicrophoneAudioTrack=u}).call(this,n(0).default)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNLocalAudioTrack=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(n(4).QNLocalTrack);t.QNLocalAudioTrack=i},function(e,t,n){"use strict";(function(e){t.__esModule=!0,t.QNAudioMixer=void 0;var n=e("QNRTC-UniPlugin-QNRtcAudioMixer"),r=e("globalEvent"),o=function(){function e(e,t){this.variationList=["onStateChanged"],this.identifyID=e,this.url=t}return e.prototype.createAudioMixerCallback=function(e,t){if("onStateChanged"===e){return function(e){e.state&&t(e)}}},e.prototype.on=function(e,t){if(this.variationList.some((function(t){return t===e}))){var n=this.createAudioMixerCallback(e,t);r.addEventListener(e,n)}else r.addEventListener(e,t)},e.prototype.off=function(e,t){r.removeEventListener(e,t)},e.prototype.start=function(e){n.start(this.identifyID,e)},e.prototype.stop=function(){n.stop(this.identifyID)},e.prototype.resume=function(){n.resume(this.identifyID)},e.prototype.pause=function(){n.pause(this.identifyID)},e.prototype.seekTo=function(e){n.seekTo(this.identifyID,e)},e.prototype.setMixingVolume=function(e,t){n.setMixingVolume(this.identifyID,e,t)},e.prototype.setPlayingVolume=function(e){n.setPlayingVolume(this.identifyID,e)},e.prototype.getDuration=function(){return n.getDuration(this.identifyID)},e.prototype.getCurrentPosition=function(){return n.getCurrentPosition(this.identifyID)},e.prototype.setPlayBack=function(e){n.setPlayBack(this.identifyID,e)},e}();t.QNAudioMixer=o}).call(this,n(0).default)},function(e,t,n){"use strict";(function(e){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.QNScreenVideoTrack=void 0;var i=n(12),s=e("QNRTC-UniPlugin-QNRtcTrack"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setScreenRecorderFrameRate=function(e){return s.setScreenRecorderFrameRate(this.identifyID,e)},t}(i.QNLocalVideoTrack);t.QNScreenVideoTrack=a}).call(this,n(0).default)},function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.uniNavigateTo=function(e){var t=e.success,n=e.fail,r=s(e,["success","fail"]);return new Promise((function(e,i){uni.navigateTo(o({success:function(n){t&&t(n),e(n)},fail:function(e){n&&n(e),i(e)}},r))}))},t.uniShowModal=function(e){var t=e.success,n=e.fail,r=s(e,["success","fail"]);return new Promise((function(e,i){uni.showModal(o({success:function(n){t&&t(n),e(n)},fail:function(e){n&&n(e),i(e)},confirmText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r))}))},t.uniShowToast=function(e){var t=e.success,n=e.fail,r=s(e,["success","fail"]);return new Promise((function(e,i){uni.showToast(o({success:function(n){t&&t(n),e(n)},fail:function(e){n&&n(e),i(e)},icon:"none"},r))}))}},function(e,t,n){"use strict";n.r(t);var r=n(8),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t.default=o.a},function(e,t,n){"use strict";function r(e,t,n,r,o,i,s,a,u,c){var f,d="function"==typeof e?e.options:e;if(u){d.components||(d.components={});var l=Object.prototype.hasOwnProperty;for(var p in u)l.call(u,p)&&!l.call(d.components,p)&&(d.components[p]=u[p])}if(c&&((c.beforeCreate||(c.beforeCreate=[])).unshift((function(){this[c.__module]=this})),(d.mixins||(d.mixins=[])).push(c)),t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),r&&(d.functional=!0),i&&(d._scopeId="data-v-"+i),s?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},d._ssrRegister=f):o&&(f=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o),f)if(d.functional){d._injectStyles=f;var h=d.render;d.render=function(e,t){return f.call(t),h(e,t)}}else{var g=d.beforeCreate;d.beforeCreate=g?[].concat(g,f):[f]}return{exports:e,options:d}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.r(t);n(27),n(29);var r=n(1);r.default.mpType="page",r.default.route="pages/room/room",r.default.el="#root",new Vue(r.default)},function(e,t,n){Vue.prototype.__$appStyle__={},Vue.prototype.__merge_style&&Vue.prototype.__merge_style(n(28).default,Vue.prototype.__$appStyle__)},function(e,t,n){"use strict";n.r(t);var r=n(5),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t.default=o.a},function(e,t){if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){var n=uni.requireGlobal();ArrayBuffer=n.ArrayBuffer,Int8Array=n.Int8Array,Uint8Array=n.Uint8Array,Uint8ClampedArray=n.Uint8ClampedArray,Int16Array=n.Int16Array,Uint16Array=n.Uint16Array,Int32Array=n.Int32Array,Uint32Array=n.Uint32Array,Float32Array=n.Float32Array,Float64Array=n.Float64Array,BigInt64Array=n.BigInt64Array,BigUint64Array=n.BigUint64Array}},function(e,t){e.exports="/pages/room/icon-cancel.png"},function(e,t,n){var r={"./icon-mic-off.png":32,"./icon-mic-on.png":33};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=31},function(e,t){e.exports="/pages/room/icon-mic-off.png"},function(e,t){e.exports="/pages/room/icon-mic-on.png"},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};t.__esModule=!0;var i=n(35);t.default=i.default,o(n(2),t),o(n(37),t),o(n(38),t),o(n(15),t),o(n(18),t),o(n(20),t),o(n(4),t),o(n(12),t),o(n(19),t),o(n(17),t),o(n(11),t),o(n(16),t),o(n(22),t),o(n(3),t),o(n(21),t)},function(e,t,n){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var o=n(36),i=n(15),s=n(18),a=n(19),u=n(22),c=n(3),f=e("QNRTC-UniPlugin-QNRtcEngine"),d=e("globalEvent"),l=e("QNRTC-UniPlugin-QNRtcTrack"),p=e("QNRTC-UniPlugin-QNRtcClient"),h=e("QNRTC-UniPlugin-QNRtcAudioMixer"),g=function(){function e(){}return e.on=function(e,t){d.addEventListener(e,t)},e.off=function(e,t){d.removeEventListener(e,t)},e.requestPermission=function(e){return l.requestPermission(e)},e.isScreenCaptureSupported=function(){return l.isScreenCaptureSupported()},e.configRTC=function(e){var t=r(r({},o.QNRTCConfigurationPreset),e);try{f.initDelegate()}catch(e){}return l.initDelegate(),p.initDelegate(),h.initDelegate(),f.configRTC(t)},e.deinit=function(){return f.deinit()},e.createClient=function(){return f.createRTCClient(),new i.QNRTCClient},e.createMicrophoneAudioTrack=function(e){var t=r(r({},o.QNMicrophoneAudioTrackConfigPreset),e),n=f.createMicrophoneAudioTrack(t);return new a.QNMicrophoneAudioTrack(r({trackID:"",raw:n,userID:""},n))},e.createCameraVideoTrack=function(e){var t=r(r({},o.QNCameraVideoTrackConfigPreset),e),n=f.createCameraVideoTrack(t);return new s.QNCameraVideoTrack(r({trackID:"",raw:n,userID:""},n))},e.createScreenVideoTrack=function(e){var t=r(r({},o.QNScreenVideoTrackConfigPreset),e),n=f.createScreenVideoTrack(t);return new u.QNScreenVideoTrack(r({trackID:"",raw:n,userID:""},n))},e.createCustomAudioTrack=function(e){var t=r(r({},o.QNCustomAudioTrackConfigPreset),e),n=f.createCustomAudioTrack(t);return new c.QNTrack(r({trackID:"",raw:n,userID:""},n))},e.createCustomVideoTrack=function(e){var t=r(r({},o.QNCustomVideoTrackConfigPreset),e),n=f.createCustomVideoTrack(t);return new c.QNTrack(r({trackID:"",raw:n,userID:""},n))},e.setAudioRouteToSpeakerphone=function(e){return f.setAudioRouteToSpeakerphone(e)},e.enableFileLogging=function(){return f.enableFileLogging()},e}();t.default=g}).call(this,n(0).default)},function(e,t,n){"use strict";t.__esModule=!0,t.QNCustomVideoTrackConfigPreset=t.QNScreenVideoTrackConfigPreset=t.QNCameraVideoTrackConfigPreset=t.QNCustomAudioTrackConfigPreset=t.QNMicrophoneAudioTrackConfigPreset=t.QNRTCConfigurationPreset=void 0;var r=n(2);t.QNRTCConfigurationPreset={policy:r.QNRTCPolicy.forceUDP,stereo:!1,logLevel:r.QNRTCLogLevel.info,bwePolicy:r.QNRTCBwePolicy.TCC,allowAudioMixWithOthers:!0,hWCodecEnabled:!0,maintainResolution:!1,fieldTrials:"",encoderQualityMode:!1,isAEC3Enabled:!0},t.QNMicrophoneAudioTrackConfigPreset={tag:"",bitrate:24,BitsPerSample:16,ChannelCount:1,SampleRate:16e3,communicationModeOn:!0},t.QNCustomAudioTrackConfigPreset={tag:"",bitrate:24,BitsPerSample:16,ChannelCount:1,SampleRate:16e3},t.QNCameraVideoTrackConfigPreset={tag:"",bitrate:800,width:640,height:480,multiStreamEnable:!1,cameraFacing:r.QNRTCCameraFacing.front,frameRate:20,captureWidth:640,captureHeight:480,captureFrameRate:20,sessionPreset:r.QNSessionPresetType.AVCaptureSessionPreset640x480},t.QNScreenVideoTrackConfigPreset={tag:"",bitrate:800,width:640,height:480,multiStreamEnable:!1,frameRate:20},t.QNCustomVideoTrackConfigPreset={tag:"",bitrate:800,width:640,height:480,multiStreamEnable:!1,frameRate:20}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};t.__esModule=!0,o(n(2),t)},function(e,t,n){"use strict";t.__esModule=!0},function(e,t,n){(function(e){function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(t){"use strict";var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=47)}([function(e,t,n){e.exports=function(){var e={};function t(){e.converter._configure(),e.decoder._configure(),e.encoder._configure(),e.Field._configure(),e.MapField._configure(),e.Message._configure(),e.Namespace._configure(),e.Method._configure(),e.ReflectionObject._configure(),e.OneOf._configure(),e.parse._configure(),e.Reader._configure(),e.Root._configure(),e.Service._configure(),e.verifier._configure(),e.Type._configure(),e.types._configure(),e.wrappers._configure(),e.Writer._configure()}if(e.build="minimal",e.Writer=n(19),e.encoder=n(28),e.Reader=n(26),e.util=n(1),e.rpc=n(24),e.roots=n(20),e.verifier=n(27),e.tokenize=n(23),e.parse=n(22),e.common=n(25),e.ReflectionObject=n(7),e.Namespace=n(9),e.Root=n(12),e.Enum=n(4),e.Type=n(6),e.Field=n(5),e.OneOf=n(10),e.MapField=n(16),e.Service=n(13),e.Method=n(17),e.converter=n(31),e.decoder=n(29),e.Message=n(18),e.wrappers=n(30),e.types=n(8),e.util=n(1),e.configure=t,e.load=function(t,n,r){return(n="function"==typeof n?(r=n,new e.Root):n||new e.Root).load(t,r)},e.loadSync=function(t,n){return(n=n||new e.Root).loadSync(t)},e.parseFromPbString=function(t,n,r){return(n="function"==typeof n?(r=n,new e.Root):n||new e.Root).parseFromPbString(t,r)},t(),arguments&&arguments.length)for(var r=0;r<arguments.length;r++){var o=arguments[r];if(o.hasOwnProperty("exports"))return void(o.exports=e)}return e}()},function(e,t,n){var r=e.exports,o=n(20);r.LongBits=n(15),r.Long=n(41),r.pool=n(42),r.float=n(43),r.asPromise=n(44),r.EventEmitter=n(45),r.path=n(46),r.base64=n(21),r.utf8=n(11),r.compareFieldsById=function(e,t){return e.id-t.id},r.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},r.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],o=e[n++];void 0!==o&&(t[r]=o)}return t},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},r.isObject=function(e){return e&&"object"==typeof e},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;-1<n;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.merge=function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e},r.decorateType=function(e,t){return e.$type?(t&&e.$type.name!==t&&(r.decorateRoot.remove(e.$type),e.$type.name=t,r.decorateRoot.add(e.$type)),e.$type):(Type=Type||n(6),t=new Type(t||e.name),r.decorateRoot.add(t),t.ctor=e,Object.defineProperty(e,"$type",{value:t,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:t,enumerable:!1}),t)},r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.copy=function(e){if("object"!=typeof e)return e;var t,n={};for(t in e)n[t]=e[t];return n},r.deepCopy=function e(t){if("object"!=typeof t)return t;var n,r={};for(n in t)r[n]=e(t[n]);return r},r.ProtocolError=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&merge(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r.Buffer=null,r.newBuffer=function(e){return"number"==typeof e?new r.Array(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.stringToBytes=function(e){for(var t,n=[],r=e.length,o=0;o<r;o++)65536<=(t=e.charCodeAt(o))&&t<=1114111?(n.push(t>>18&7|240),n.push(t>>12&63|128),n.push(t>>6&63|128),n.push(63&t|128)):2048<=t&&t<=65535?(n.push(t>>12&15|224),n.push(t>>6&63|128),n.push(63&t|128)):128<=t&&t<=2047?(n.push(t>>6&31|192),n.push(63&t|128)):n.push(255&t);return n},r.byteToString=function(e){if("string"==typeof e)return e;for(var t="",n=e,r=0;r<n.length;r++){var o=n[r].toString(2),i=o.match(/^1+?(?=0)/);if(i&&8==o.length){for(var s=i[0].length,a=n[r].toString(2).slice(7-s),u=1;u<s;u++)a+=n[u+r].toString(2).slice(2);t+=String.fromCharCode(parseInt(a,2)),r+=s-1}else t+=String.fromCharCode(n[r])}return t},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Object.defineProperty(r,"decorateRoot",{get:function(){return o.decorated||(o.decorated=new(n(12)))}})},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.xsync||(e.roots.xsync=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{Frame:{fields:{vsn:{type:"VSN",id:1},compress_method:{type:"CompressMethod",id:2},command:{type:"Command",id:3},payload:{type:"bytes",id:4},encrypt_method:{type:"EncryptMethod",id:5},encrypt_key:{type:"bytes",id:6},check_sum:{type:"uint32",id:7},tag:{type:"string",id:8}},nested:{VSN:{values:{XSYNC_V1:0,XSYNC_V2:1}},Command:{values:{UNREAD:0,SYNC:1,NOTICE:2,PROVISION:3}},CompressMethod:{values:{NONE:0,ZLIB:1}},EncryptMethod:{values:{ENCRYPT_NONE:0,AES_CBC_128:1,AES_CBC_256:2,CUSTOM:3}}}},Status:{fields:{code:{type:"ErrorCode",id:1},reason:{type:"string",id:2}},nested:{ErrorCode:{values:{UNKNOWN:0,OK:1,FAIL:2,UNKNOWN_COMMAND:3,PB_PARSER_ERROR:4,DECRYPT_FAILURE:5,PUBLIC_KEY_CHANGED:6,INVALID_TOKEN:7,INVALID_PARAMETER:8,UNAUTHORIZED:9,USER_FROZEN:10,USER_BANNED:11,WORD_CENSORED:12,TOO_MANY_DEVICES:13,ENCRYPT_METHOD_UNSUPPORTED:14,DEVICE_GUID_CONFLICT:15,CHECK_SUM_FAILURE:16,INVALID_LICENSE:17,LICENSE_LIMIT:18,APP_FROZEN:19}}}},ConversationUnread:{fields:{xid:{type:"XID",id:1},n:{type:"uint32",id:2},type:{type:"ConvType",id:3}},nested:{ConvType:{values:{UNKNOWN:0,CHAT:1,GROUPCHAT:2}}}},UnreadUL:{fields:{}},UnreadDL:{fields:{status:{type:"Status",id:1},unread:{rule:"repeated",type:"ConversationUnread",id:2}}},SyncUL:{fields:{xid:{type:"XID",id:1},key:{type:"uint64",id:2},meta:{type:"Meta",id:3},is_full_sync:{type:"bool",id:4},full_sync_num:{type:"sint32",id:5}}},SyncDL:{fields:{status:{type:"Status",id:1},metas:{rule:"repeated",type:"Meta",id:2},next_key:{type:"uint64",id:3},xid:{type:"XID",id:4},client_mid:{type:"uint64",id:5},server_mid:{type:"uint64",id:6},server_time:{type:"uint64",id:7},is_full_sync:{type:"bool",id:8},prev_mid:{type:"uint64",id:9},is_eager_sync:{type:"bool",id:10}}},Notice:{fields:{xid:{type:"XID",id:1}}},Provision:{fields:{status:{type:"Status",id:1},xid:{type:"XID",id:2},password:{type:"string",id:5},token:{type:"string",id:6},os_type:{type:"OsType",id:7},sdk_vsn:{type:"string",id:8},is_manual_login:{type:"bool",id:9},device_guid:{type:"string",id:10},device_notifier:{type:"string",id:11},device_token:{type:"string",id:12},device_info:{type:"string",id:13},last_login_time:{type:"uint64",id:14}},nested:{OsType:{values:{UNKNOWN:0,IOS:1,ANDR:2,WIN:3,OSX:4,LINUX:5,WEB:6}}}},Meta:{fields:{id:{type:"uint64",id:1},from:{type:"XID",id:2},to:{type:"XID",id:3},timestamp:{type:"uint64",id:4},ns:{type:"NameSpace",id:5},payload:{type:"bytes",id:6}},nested:{NameSpace:{values:{UNKNOWN:0,MESSAGE:1,GROUP_NOTICE:2,ROSTER_NOTICE:3,USER_NOTICE:4,INFO:5,CONVERSATION:6,PUSH:7}}}},XID:{fields:{uid:{type:"uint64",id:1},deviceSN:{type:"uint32",id:2}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function o(e){return!0===(e&&e.__isLong__)}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=o;var i={},s={};function a(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=c(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=c(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function u(e,t){if(isNaN(e))return t?m:v;if(t){if(e<0)return m;if(h<=e)return O}else{if(e<=-g)return A;if(g<=e+1)return N}return e<0?u(-e,t).neg():c(e%p|0,e/p|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=u,r.fromBits=c;var f=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if(t="number"==typeof t?(n=t,!1):!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return d(e.substring(1),t,n).neg();for(var o=u(f(n,8)),i=v,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),n);i=a<8?(a=u(f(n,a)),i.mul(a).add(u(c))):(i=i.mul(o)).add(u(c))}return i.unsigned=t,i}function l(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?d(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=l;var p=4294967296,h=p*p,g=h/2,y=a(1<<24),v=a(0);r.ZERO=v;var m=a(0,!0);r.UZERO=m;var _=a(1);r.ONE=_;var E=a(1,!0);r.UONE=E;var b=a(-1);r.NEG_ONE=b;var N=c(-1,2147483647,!1);r.MAX_VALUE=N;var O=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=O;var A=c(0,-2147483648,!1);r.MIN_VALUE=A;var w=r.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},w.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(A)){var t=u(e),n=this.div(t);return t=n.mul(t).sub(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=u(f(e,6),this.unsigned),o=this,i="";;){var s=o.div(r),a=(o.sub(s.mul(r)).toInt()>>>0).toString(e);if((o=s).isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||0<=this.high},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(e){return o(e)||(e=l(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},w.eq=w.equals,w.notEquals=function(e){return!this.eq(e)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(e){return this.comp(e)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(e){return this.comp(e)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(e){return 0<this.comp(e)},w.gt=w.greaterThan,w.greaterThanOrEqual=function(e){return 0<=this.comp(e)},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(e){if(o(e)||(e=l(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(_)},w.neg=w.negate,w.add=function(e){o(e)||(e=l(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,f=0,d=0,p=0,h=0;return p+=(h+=i+(65535&e.low))>>>16,d+=(p+=r+u)>>>16,f+=(d+=n+a)>>>16,f+=t+s,c((p&=65535)<<16|(h&=65535),(f&=65535)<<16|(d&=65535),this.unsigned)},w.subtract=function(e){return o(e)||(e=l(e)),this.add(e.neg())},w.sub=w.subtract,w.multiply=function(e){if(this.isZero())return v;if(o(e)||(e=l(e)),n)return c(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(A))return e.isOdd()?A:v;if(e.eq(A))return this.isOdd()?A:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,f=65535&e.high,d=e.low>>>16,p=65535&e.low,h=0,g=0,m=0;return e=0,m+=(e+=s*p)>>>16,g+=(m+=i*p)>>>16,m&=65535,g+=(m+=s*d)>>>16,h+=(g+=r*p)>>>16,g&=65535,h+=(g+=i*d)>>>16,g&=65535,h+=(g+=s*f)>>>16,h+=t*p+r*d+i*f+s*a,c((m&=65535)<<16|(e&=65535),(h&=65535)<<16|(g&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(e){if((e=o(e)?e:l(e)).isZero())throw Error("division by zero");var t,r;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:v;if(this.unsigned){if((e=e.unsigned?e:e.toUnsigned()).gt(this))return m;if(e.gt(this.shru(1)))return E;r=m}else{if(this.eq(A))return e.eq(_)||e.eq(b)?A:e.eq(A)?_:(i=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?_:b:(t=this.sub(e.mul(i)),i.add(t.div(e)));if(e.eq(A))return this.unsigned?m:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=v}for(t=this;t.gte(e);){for(var i=Math.max(1,Math.floor(t.toNumber()/e.toNumber())),s=Math.ceil(Math.log(i)/Math.LN2),a=s<=48?1:f(2,s-48),d=u(i),p=d.mul(e);p.isNegative()||p.gt(t);)p=(d=u(i-=a,this.unsigned)).mul(e);d.isZero()&&(d=_),r=r.add(d),t=t.sub(p)}return r},w.div=w.divide,w.modulo=function(e){return o(e)||(e=l(e)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.and=function(e){return o(e)||(e=l(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},w.or=function(e){return o(e)||(e=l(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},w.xor=function(e){return o(e)||(e=l(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},w.shiftLeft=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(e){if(o(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},w.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){e.exports=i;var r=n(7);((i.prototype=Object.create(r.prototype)).constructor=i).className="Enum";var o=n(9);function i(e,t,n,o,i){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=o,this.comments=i||{},this.reserved=void 0,t)for(var s=Object.keys(t),a=0;a<s.length;++a)"number"==typeof t[s[a]]&&(this.valuesById[this.values[s[a]]=t[s[a]]]=s[a])}i.fromJSON=function(e,t){return(e=new i(e,t.values,t.options,t.comment,t.comments)).reserved=t.reserved,e},i.prototype.toJSON=function(e){return e=!!e&&Boolean(e.keepComments),util.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",e?this.comment:void 0,"comments",e?this.comments:void 0])},i.prototype.add=function(e,t,n){if(!util.isString(e))throw TypeError("name must be a string");if(!util.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},i.prototype.remove=function(e){if(!util.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},i.prototype.isReservedId=function(e){return o.isReservedId(this.reserved,e)},i.prototype.isReservedName=function(e){return o.isReservedName(this.reserved,e)}},function(e,t,n){e.exports=c;var r,o,i,s,a=n(7);((c.prototype=Object.create(a.prototype)).constructor=c).className="Field";var u=/^required|optional|repeated$/;function c(e,t,n,r,s,c,f){if(i.isObject(r)?(f=s,c=r,r=s=void 0):i.isObject(s)&&(f=c,c=s,s=void 0),a.call(this,e,c),!i.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!i.isString(n))throw TypeError("type must be a string");if(void 0!==r&&!u.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!i.isString(s))throw TypeError("extend must be a string");this.rule=r&&"optional"!==r?r:void 0,this.type=n,this.id=t,this.extend=s||void 0,this.required="required"===r,this.optional=!this.required,this.repeated="repeated"===r,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!i.Long&&void 0!==o.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=f}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),a.prototype.setOption.call(this,e,t,n)},c.prototype.toJSON=function(e){return e=!!e&&Boolean(e.keepComments),i.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])},c.prototype.resolve=function(){return this.resolved?this:(void 0===(this.typeDefault=o.defaults[this.type])&&(this.resolvedType=(this.declaringField||this).parent.lookupTypeOrEnum(this.type),this.resolvedType instanceof s?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof r&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof r)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long?(this.typeDefault=i.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault)):this.bytes&&"string"==typeof this.typeDefault&&(i.utf8.write(this.typeDefault,e=i.newBuffer(i.utf8.length(this.typeDefault)),0),this.typeDefault=e),this.map?this.defaultValue=i.emptyObject:this.repeated?this.defaultValue=i.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof s&&(this.parent.ctor.prototype[this.name]=this.defaultValue),a.prototype.resolve.call(this));var e},c.d=function(e,t,n,r){return"function"==typeof t?t=i.decorateType(t).name:t&&"object"==typeof t&&(t=i.decorateEnum(t).name),function(o,s){i.decorateType(o.constructor).add(new c(s,e,t,n,{default:r}))}},c._configure=function(){s=n(6),r=n(4),o=n(8),i=n(1)}},function(e,t,n){e.exports=m;var r,o,i,s,a,u,c,f,d,l,p,h,g,y,v=n(9);function m(e,t){v.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function _(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}((m.prototype=Object.create(v.prototype)).constructor=m).className="Type",Object.defineProperties(m.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=c.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=c.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=m.generateConstructor(this))},set:function(e){var t=e.prototype;t instanceof i||((e.prototype=new i).constructor=e,c.merge(e.prototype,t)),e.$type=e.prototype.$type=this,c.merge(e,i,!0),c.merge(e.prototype,i,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n){var o=this._oneofsArray[n].resolve().name,s=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=0;return{setter:function(n){if(!(e.indexOf(n)<0)){t[n]=1;for(var r=0;r<e.length;++r)e[r]!==n&&delete this[e[r]]}},getter:function(){for(var e=Object.keys(this),n=e.length-1;-1<n;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}}}(this._oneofsArray[n].oneof);r[o]={get:s.getter,set:s.setter}}n&&Object.defineProperties(e.prototype,r)}}}),m.generateConstructor=function(e){return function(t){for(var n,r=0;r<e.fieldsArray.length;r++)(n=e._fieldsArray[r]).map?this[n.name]={}:n.repeated&&(this[n.name]=[]);if(t)for(var o=Object.keys(t),i=0;i<o.length;++i)null!=t[o[i]]&&(this[o[i]]=t[o[i]])}},m.fromJSON=function(e,t){var n=new m(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var i=Object.keys(t.fields),a=0;a<i.length;++a)n.add((void 0!==t.fields[i[a]].keyType?y:o).fromJSON(i[a],t.fields[i[a]]));if(t.oneofs)for(i=Object.keys(t.oneofs),a=0;a<i.length;++a)n.add(s.fromJSON(i[a],t.oneofs[i[a]]));if(t.nested)for(i=Object.keys(t.nested),a=0;a<i.length;++a){var u=t.nested[i[a]];n.add((void 0!==u.id?o:void 0!==u.fields?m:void 0!==u.values?r:void 0!==u.methods?p:v).fromJSON(i[a],u))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},m.prototype.toJSON=function(e){var t=v.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return{options:t&&t.options||void 0,oneofs:v.arrayToJSON(this.oneofsArray,e),fields:v.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},extensions:this.extensions&&this.extensions.length?this.extensions:void 0,reserved:this.reserved&&this.reserved.length?this.reserved:void 0,group:this.group||void 0,nested:t&&t.nested||void 0,comment:n?this.comment:void 0}},m.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return v.prototype.resolveAll.call(this)},m.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},m.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById&&this._fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),(this.fields[e.name]=e).message=this,e.onAdd(this),_(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),(this.oneofs[e.name]=e).onAdd(this),_(this)):v.prototype.add.call(this,e)},m.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),_(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),_(this)}return v.prototype.remove.call(this,e)},m.prototype.isReservedId=function(e){return v.isReservedId(this.reserved,e)},m.prototype.isReservedName=function(e){return v.isReservedName(this.reserved,e)},m.prototype.create=function(e){return new this.ctor(e)},m.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=d(this)({Writer:a,types:t,util:c}),this.decode=l(this)({Reader:u,types:t,util:c}),this.verify=f(this)({types:t,util:c}),this.fromObject=g.fromObject(this)({types:t,util:c}),this.toObject=g.toObject(this)({types:t,util:c});var r=h[e];return r&&((e=Object.create(this)).fromObject=this.fromObject,this.fromObject=r.fromObject.bind(e),e.toObject=this.toObject,this.toObject=r.toObject.bind(e)),this},m.prototype.encode=function(e,t){return this.setup().encode(e,t)},m.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},m.prototype.decode=function(e,t){return this.setup().decode(e,t)},m.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},m.prototype.verify=function(e){return this.setup().verify(e)},m.prototype.fromObject=function(e){return this.setup().fromObject(e)},m.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},m.d=function(e){return function(t){c.decorateType(t,e)}},m._configure=function(){r=n(4),o=n(5),i=n(18),s=n(10),a=n(19),u=n(26),c=n(1),f=n(27),d=n(28),l=n(29),p=n(13),h=n(30),g=n(31),y=n(16)}},function(e,t,n){var r,o;function i(e,t){if(!r.isString(e))throw TypeError("name must be a string");if(t&&!r.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}(e.exports=i).className="ReflectionObject",Object.defineProperties(i.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),i.prototype.toJSON=function(){throw Error()},i.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1,(e=e.root)instanceof o&&e._handleAdd(this)},i.prototype.onRemove=function(e){(e=e.root)instanceof o&&e._handleRemove(this),this.parent=null,this.resolved=!1},i.prototype.resolve=function(){return this.resolved||this.root instanceof o&&(this.resolved=!0),this},i.prototype.getOption=function(e){if(this.options)return this.options[e]},i.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},i.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},i.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},i._configure=function(e){o=n(12),r=n(1)}},function(e,t,n){e=e.exports;var r=n(1),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function i(e,t){var n=0,r={};for(t|=0;n<e.length;)r[o[n+t]]=e[n++];return r}e.basic=i([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),e.defaults=i([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),e.long=i([0,0,0,1,1],7),e.mapKey=i([0,0,0,5,5,0,0,0,1,1,0,2],2),e.packed=i([1,5,0,0,0,5,5,0,0,0,1,1,0]),e._configure=function(){n(1)}},function(e,t,n){e.exports=f;var r,o,i,s,a,u=n(7);function c(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function f(e,t){u.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}((f.prototype=Object.create(u.prototype)).constructor=f).className="Namespace",f.fromJSON=function(e,t){return new f(e,t.options).addJSON(t.nested)},f.arrayToJSON=c,f.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>=t)return!0;return!1},f.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(f.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=i.toArray(this.nested))}}),f.prototype.toJSON=function(e){return i.toObject(["options",this.options,"nested",c(this.nestedArray,e)])},f.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),i=0;i<n.length;++i)t=e[n[i]],this.add((void 0!==t.fields?s:void 0!==t.values?r:void 0!==t.methods?a:void 0!==t.id?o:f).fromJSON(n[i],t));return this},f.prototype.get=function(e){return this.nested&&this.nested[e]||null},f.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof r)return this.nested[e].values;throw Error("no such enum: "+e)},f.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof s||e instanceof r||e instanceof a||e instanceof f))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof f&&e instanceof f)||t instanceof s||t instanceof a)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return(this.nested[e.name]=e).onAdd(this),d(this)},f.prototype.remove=function(e){if(!(e instanceof u))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},f.prototype.define=function(e,t){if(i.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;0<e.length;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof f))throw Error("path conflicts with non-namespace objects")}else n.add(n=new f(r))}return t&&n.addJSON(t),n},f.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof f?e[t++].resolveAll():e[t++].resolve();return this.resolve()},f.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),i.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||-1<t.indexOf(r.constructor))return r}else if(r instanceof f&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var o=0;o<this.nestedArray.length;++o)if(this._nestedArray[o]instanceof f&&(r=this._nestedArray[o].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},f.prototype.lookupType=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such type: "+e);return t},f.prototype.lookupEnum=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},f.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[s,r]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},f.prototype.lookupService=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},f._configure=function(){r=n(4),o=n(5),i=n(1),s=n(6),a=n(13)}},function(e,t,n){e.exports=s;var r,o,i=n(7);function s(e,t,n,r){if(Array.isArray(t)||(n=t,t=void 0),i.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=r}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}((s.prototype=Object.create(i.prototype)).constructor=s).className="OneOf",s.fromJSON=function(e,t){return new s(e,t.oneof,t.options,t.comment)},s.prototype.toJSON=function(e){return e=!!e&&Boolean(e.keepComments),o.toObject(["options",this.options,"oneof",this.oneof,"comment",e?this.comment:void 0])},s.prototype.add=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),a(e.partOf=this),this},s.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),-1<(t=this.oneof.indexOf(e.name))&&this.oneof.splice(t,1),e.partOf=null,this},s.prototype.onAdd=function(e){i.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this).fieldsArray.push(n)}a(this)},s.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);i.prototype.onRemove.call(this,e)},s.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new s(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}},s._configure=function(){r=n(5),o=n(1)}},function(e,t,n){(e=e.exports).length=function(e){for(var t,n=0,r=0;r<e.length;++r)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:55296==(64512&t)&&56320==(64512&e.charCodeAt(r+1))?(++r,n+=4):n+=3;return n},e.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],s=0;t<n;)(r=e[t++])<128?i[s++]=r:191<r&&r<224?i[s++]=(31&r)<<6|63&e[t++]:239<r&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(r>>10),i[s++]=56320+(1023&r)):i[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],8191<s&&((o=o||[]).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},e.write=function(e,t,n){for(var r,o,i=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(s+1)))?(++s,t[n++]=(r=65536+((1023&r)<<10)+(1023&o))>>18|240,t[n++]=r>>12&63|128):t[n++]=r>>12|224,t[n++]=r>>6&63|128),t[n++]=63&r|128);return n-i}},function(e,t,n){e.exports=d;var r=n(9);((d.prototype=Object.create(r.prototype)).constructor=d).className="Root";var o,i,s,a=n(5),u=n(4),c=n(10),f=n(1);function d(e){r.call(this,"",e),this.deferred=[],this.files=[],this.names=[]}function l(){}d.fromJSON=function(e,t){return e="string"==typeof e?JSON.parse(e):e,t=t||new d,e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=f.path.resolve,d.prototype.parseFromPbString=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var o=this;if(!r)return f.asPromise(e,o,t,n);var a=null;if("string"==typeof t)a=JSON.parse(t);else{if("object"!=typeof t)return;a=t}function u(e,t){var n;r&&(n=r,r=null,n(e,t))}function c(e,t){try{if(f.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),f.isString(t)){i.filename=e;var r,s=i(t,o,n),a=0;if(s.imports)for(;a<s.imports.length;++a)d(r=s.imports[a]);if(s.weakImports){for(a=0;a<s.weakImports.length;++a)r=s.weakImports[a];d(r)}}else o.setOptions(t.options).addJSON(t.nested)}catch(e){u(e)}u(null,o)}function d(e){-1<o.names.indexOf(e)||(o.names.push(e),e in s&&c(e,s[e]))}c(a.name,a.pbJsonStr)},d.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var o=this;if(!r)return f.asPromise(e,o,t,n);var a=r===l;function u(e,t){if(r){var n=r;if(r=null,a)throw e;n(e,t)}}function c(e,t){try{if(f.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),f.isString(t)){i.filename=e;var r,s=i(t,o,n),c=0;if(s.imports)for(;c<s.imports.length;++c)(r=o.resolvePath(e,s.imports[c]))&&d(r);if(s.weakImports)for(c=0;c<s.weakImports.length;++c)(r=o.resolvePath(e,s.weakImports[c]))&&d(r,!0)}else o.setOptions(t.options).addJSON(t.nested)}catch(e){u(e)}a||p||u(null,o)}function d(e,t){var n,i=e.lastIndexOf("google/protobuf/");if(-1<i&&(i=e.substring(i))in s&&(e=i),!(-1<o.files.indexOf(e)))if(o.files.push(e),e in s)a?c(e,s[e]):(++p,setTimeout((function(){--p,c(e,s[e])})));else if(a){try{n=f.fs.readFileSync(e).toString("utf8")}catch(e){return t||u(e),0}c(e,n)}else++p,f.fetch(e,(function(n,i){--p,r&&(n?t?p||u(null,o):u(n):c(e,i))}))}var p=0;f.isString(t)&&(t=[t]);for(var h,g=0;g<t.length;++g)(h=o.resolvePath("",t[g]))&&d(h);if(a)return o;p||u(null,o)},d.prototype.loadSync=function(e,t){if(!f.isNode)throw Error("not supported");return this.load(e,t,l)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function h(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return(r.declaringField=t).extensionField=r,n.add(r),1}}d.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||h(0,e)||this.deferred.push(e);else if(e instanceof u)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof o)for(var t=0;t<this.deferred.length;)h(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);p.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){var t;if(e instanceof a)void 0!==e.extend&&(e.extensionField?(e.extensionField.parent.remove(e.extensionField),e.extensionField=null):-1<(t=this.deferred.indexOf(e))&&this.deferred.splice(t,1));else if(e instanceof u)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);p.test(e.name)&&delete e.parent[e.name]}},d._configure=function(){o=n(6),i=n(22),s=n(25),a=n(5),u=n(4),c=n(10),f=n(1)}},function(e,t,n){e.exports=a;var r,o,i,s=n(9);function a(e,t){s.call(this,e,t),this.methods={},this._methodsArray=null}function u(e){return e._methodsArray=null,e}((a.prototype=Object.create(s.prototype)).constructor=a).className="Service",a.fromJSON=function(e,t){var n=new a(e,t.options);if(t.methods)for(var o=Object.keys(t.methods),i=0;i<o.length;++i)n.add(r.fromJSON(o[i],t.methods[o[i]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},a.prototype.toJSON=function(e){var t=s.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",s.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||s.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return s.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof r?u((this.methods[e.name]=e).parent=this):s.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof r){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,u(this)}return s.prototype.remove.call(this,e)},a.prototype.create=function(e,t,n){for(var r,s=new i.Service(e,t,n),a=0;a<this.methodsArray.length;++a){var u=o.lcFirst((r=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");s[u]=o.codegen(["r","c"],o.isReserved(u)?u+"_":u)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return s},a._configure=function(){r=n(17),o=n(1),i=n(24)}},function(e,t,i){var s=i(38),a=i(39),u=i(40);function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function f(e,t){return t.encode?(t.strict?s:encodeURIComponent)(e):e}function d(e,t){return t.decode?a(e):e}function l(e){var t=e.indexOf("#");return-1!==t?e.slice(0,t):e}function p(e){var t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function h(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function g(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return function(t,n,r){n="string"==typeof n&&-1<n.split("").indexOf(e.arrayFormatSeparator)?n.split(e.arrayFormatSeparator).map((function(t){return d(t,e)})):null===n?n:d(n,e),r[t]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;var s,a=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}(e.split("&"));try{for(a.s();!(s=a.n()).done;){var f=s.value,l=r(u(t.decode?f.replace(/\+/g," "):f,"="),2),p=l[0],g=l[1];g=void 0===g?null:["comma","separator"].includes(t.arrayFormat)?g:d(g,t),n(d(p,t),g,i)}}catch(e){a.e(e)}finally{a.f()}for(var y=0,v=Object.keys(i);y<v.length;y++){var m=v[y],_=i[m];if("object"==typeof _&&null!==_)for(var E=0,b=Object.keys(_);E<b.length;E++){var N=b[E];_[N]=h(_[N],t)}else i[m]=h(_,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((function(e,t){var n=i[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))}t.extract=p,t.parse=g,t.stringify=function(e,t){if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);for(var r,o=function(e){switch(e.arrayFormat){case"index":return function(t){return function(r,o){var i=r.length;return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[[f(t,e),"[",i,"]"].join("")]:[[f(t,e),"[",f(i,e),"]=",f(o,e)].join("")])}};case"bracket":return function(t){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[[f(t,e),"[]"].join("")]:[[f(t,e),"[]=",f(o,e)].join("")])}};case"comma":case"separator":return function(t){return function(n,r){return null==r||0===r.length?n:0===n.length?[[f(t,e),"=",f(r,e)].join("")]:[[n,f(r,e)].join(e.arrayFormatSeparator)]}};default:return function(t){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:[].concat(n(r),null===o?[f(t,e)]:[[f(t,e),"=",f(o,e)].join("")])}}}}(t),i={},s=0,a=Object.keys(e);s<a.length;s++){var u=a[s];r=u,t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r]||(i[u]=e[u])}var d=Object.keys(i);return!1!==t.sort&&d.sort(t.sort),d.map((function(n){var r=e[n];return void 0===r?"":null===r?f(n,t):Array.isArray(r)?r.reduce(o(n),[]).join("&"):f(n,t)+"="+f(r,t)})).filter((function(e){return 0<e.length})).join("&")},t.parseUrl=function(e,t){t=Object.assign({decode:!0},t);var n=r(u(e,"#"),2),o=n[0],i=n[1];return Object.assign({url:o.split("?")[0]||"",query:g(p(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:d(i,t)}:{})},t.stringifyUrl=function(e,n){n=Object.assign({encode:!0,strict:!0},n);var r=l(e.url).split("?")[0]||"",o=t.extract(e.url);o=t.parse(o,{sort:!1}),o=Object.assign(o,e.query);var i=t.stringify(o,n);i=i&&"?"+i;var s=function(e){var t="",n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(s="#"+f(e.fragmentIdentifier,n)),"".concat(r).concat(i).concat(s)}},function(e,t){function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=(e.exports=n).zero=new n(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1},n.zeroHash="\0\0\0\0\0\0\0\0",n.fromNumber=function(e){if(0===e)return r;var t=e<0,o=(e=t?-e:e)>>>0;return e=(e-o)/4294967296>>>0,t&&(e=~e>>>0,o=~o>>>0,4294967295<++o&&(o=0,4294967295<++e&&(e=0))),new n(o,e)},n.from=function(e){return"number"==typeof e?n.fromNumber(e):"string"==typeof e||e instanceof String?n.fromNumber(parseInt(e,10)):e.low||e.high?new n(e.low>>>0,e.high>>>0):r},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0;return e=~this.hi>>>0,-(t+4294967296*(e=t?e:e+1>>>0))}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var o=String.prototype.charCodeAt;n.fromHash=function(e){return"\0\0\0\0\0\0\0\0"===e?r:new n((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0==n?0==t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){e.exports=s;var r,o,i=n(5);function s(e,t,n,r,s,a){if(i.call(this,e,t,r,void 0,void 0,s,a),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}((s.prototype=Object.create(i.prototype)).constructor=s).className="MapField",s.fromJSON=function(e,t){return new s(e,t.id,t.keyType,t.type,t.options,t.comment)},s.prototype.toJSON=function(e){return e=!!e&&Boolean(e.keepComments),o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===r.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},s.d=function(e,t,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(r,i){o.decorateType(r.constructor).add(new s(i,e,t,n))}},s._configure=function(){r=n(8),o=n(1)}},function(e,t,n){e.exports=i;var r,o=n(7);function i(e,t,n,i,s,a,u,c){if(r.isObject(s)?(u=s,s=a=void 0):r.isObject(a)&&(u=a,a=void 0),void 0!==t&&!r.isString(t))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(i))throw TypeError("responseType must be a string");o.call(this,e,u),this.type=t||"rpc",this.requestType=n,this.requestStream=!!s||void 0,this.responseType=i,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c}((i.prototype=Object.create(o.prototype)).constructor=i).className="Method",i.fromJSON=function(e,t){return new i(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},i.prototype.toJSON=function(e){return e=!!e&&Boolean(e.keepComments),r.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",e?this.comment:void 0])},i.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),o.prototype.resolve.call(this))},i._configure=function(){r=n(1)}},function(e,t,n){var r;function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}(e.exports=o).create=function(e){return this.$type.create(e)},o.encode=function(e,t){return arguments.length?1==arguments.length?this.$type.encode(e):this.$type.encode(e,t):this.$type.encode(this)},o.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},o.decode=function(e){return this.$type.decode(e)},o.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},o.verify=function(e){return this.$type.verify(e)},o.fromObject=function(e){return this.$type.fromObject(e)},o.toObject=function(e,t){return this.$type.toObject(e=e||this,t)},o.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)},o.set=function(e,t){o[e]=t},o.get=function(e){return o[e]},o._configure=function(){r=n(1)}},function(e,t,n){e.exports=c;var r,o=n(1),i=n(11);function s(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function a(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function c(){this.len=0,this.head=new s(a,0,0),this.tail=this.head,this.states=null}function f(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function l(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function p(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}c.create=o.Buffer?function(){return(c.create=function(){return new(void 0)})()}:function(){return new c},c.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(c.alloc=o.pool(c.alloc,o.Array.prototype.subarray)),c.prototype._push=function(e,t,n){return this.tail=this.tail.next=new s(e,t,n),this.len+=t,this},(d.prototype=Object.create(s.prototype)).fn=function(e,t,n){for(;127<e;)t[n++]=127&e|128,e>>>=7;t[n]=e},c.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},c.prototype.int32=function(e){return e<0?this._push(l,10,r.fromNumber(e)):this.uint32(e)},c.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},c.prototype.uint64=function(e){return e=r.from(e),this._push(l,e.length(),e)},c.prototype.int64=c.prototype.uint64,c.prototype.sint64=function(e){return e=r.from(e).zzEncode(),this._push(l,e.length(),e)},c.prototype.bool=function(e){return this._push(f,1,e?1:0)},c.prototype.sfixed32=c.prototype.fixed32=function(e){return this._push(p,4,e>>>0)},c.prototype.fixed64=function(e){return e=r.from(e),this._push(p,4,e.lo)._push(p,4,e.hi)},c.prototype.sfixed64=c.prototype.fixed64,c.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},c.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var h=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};c.prototype.bytes=function(e){var t,n=e.length>>>0;return n?(o.isString(e)&&(t=c.alloc(n=i.length(e)),i.write(e,t,0),e=t),this.uint32(n)._push(h,n,e)):this._push(f,1,0)},c.prototype.string=function(e){var t=i.length(e);return t?this.uint32(t)._push(i.write,t,e):this._push(f,1,0)},c.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new s(a,0,0),this.len=0,this},c.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(a,0,0),this.len=0),this},c.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},c.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},c._configure=function(){r=n(15),n(21),i=n(11)}},function(e,t){e.exports={}},function(e,t,n){(e=e.exports).length=function(e){var t=e.length;if(!t)return 0;for(var n=0;1<--t%4&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),o=new Array(123),i=0;i<64;)o[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;e.encode=function(e,t,n){for(var o,i=null,s=[],a=0,u=0;t<n;){var c=e[t++];switch(u){case 0:s[a++]=r[c>>2],o=(3&c)<<4,u=1;break;case 1:s[a++]=r[o|c>>4],o=(15&c)<<2,u=2;break;case 2:s[a++]=r[o|c>>6],s[a++]=r[63&c],u=0}8191<a&&((i=i||[]).push(String.fromCharCode.apply(String,s)),a=0)}return u&&(s[a++]=r[o],s[a++]=61,1===u&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))},e.decode=function(e,t,n){for(var r,i=n,s=0,a=0;a<e.length;){var u=e.charCodeAt(a++);if(61===u&&1<s)break;if(void 0===(u=o[u]))throw Error("invalid encoding");switch(s){case 0:r=u,s=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,s=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,s=3;break;case 3:t[n++]=(3&r)<<6|u,s=0}}if(1===s)throw Error("invalid encoding");return n-i},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){var r,o,i,s,a,u,c,f,d,l,p;(e.exports=A).filename=null,A.defaults={keepCase:!1};var h=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,y=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,m=/^0[0-7]+$/,_=/^-?0[0-7]+$/,E=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,b=/^[a-zA-Z_][a-zA-Z_0-9]*$/,N=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,O=/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/;function A(e,t,n){t instanceof o||(n=t,t=new o),n=n||A.defaults;var w,S,T,R,I,C=r(e,n.alternateCommentMode||!1),k=C.next,M=C.push,D=C.peek,U=C.skip,P=C.cmnt,x=!0,L=!1,j=t,G=n.keepCase?function(e){return e}:p.camelCase;function B(e,t,n){var r=A.filename;return n||(A.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+C.line+")")}function V(){var e,t=[];do{if('"'!==(e=k())&&"'"!==e)throw B(e)}while(t.push(k()),U(e),'"'===(e=D())||"'"===e);return t.join("")}function F(e){var t=k();switch(t){case"'":case'"':return M(t),V();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e){var t=1;switch("-"===e.charAt(0)&&(t=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return t*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(h.test(e))return t*parseInt(e,10);if(y.test(e))return t*parseInt(e,16);if(m.test(e))return t*parseInt(e,8);if(E.test(e))return t*parseFloat(e);throw B(e,"number",!0)}(t)}catch(n){if(e&&N.test(t))return t;throw B(t,"value")}}function Q(e,t){for(var n;!t||'"'!==(n=D())&&"'"!==n?e.push([n=q(k()),U("to",!0)?q(k()):n]):e.push(V()),U(",",!0););U(";")}function q(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw B(e,"id");if(g.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(_.test(e))return parseInt(e,8);throw B(e,"id")}function K(e,t){switch(t){case"option":return H(e,t),U(";"),1;case"message":return function(e,t){if(!b.test(t=k()))throw B(t,"type name");var n=new i(t);J(n,(function(e){if(!K(n,e))switch(e){case"map":!function(e){U("<");var t=k();if(void 0===l.mapKey[t])throw B(t,"type");U(",");var n=k();if(!N.test(n))throw B(n,"type");U(">");var r=k();if(!b.test(r))throw B(r,"name");U("=");var o=new a(G(r),q(k()),t,n);J(o,(function(e){if("option"!==e)throw B(e);H(o,e),U(";")}),(function(){z(o)})),e.add(o)}(n);break;case"required":case"optional":case"repeated":W(n,e);break;case"oneof":!function(e,t){if(!b.test(t=k()))throw B(t,"name");var n=new u(G(t));J(n,(function(e){"option"===e?(H(n,e),U(";")):(M(e),W(n,"optional"))})),e.add(n)}(n);break;case"extensions":Q(n.extensions||(n.extensions=[]));break;case"reserved":Q(n.reserved||(n.reserved=[]),!0);break;default:if(!L||!N.test(e))throw B(e);M(e),W(n,"optional")}})),e.add(n)}(e,t),1;case"enum":return function(e,t){if(!b.test(t=k()))throw B(t,"name");var n=new c(t);J(n,(function(e){switch(e){case"option":H(n,e),U(";");break;case"reserved":Q(n.reserved||(n.reserved=[]),!0);break;default:!function(e,t){if(!b.test(t))throw B(t,"name");U("=");var n=q(k(),!0),r={};J(r,(function(e){if("option"!==e)throw B(e);H(r,e),U(";")}),(function(){z(r)})),e.add(t,n,r.comment)}(n,e)}})),e.add(n)}(e,t),1;case"service":return function(e,t){if(!b.test(t=k()))throw B(t,"service name");var n=new f(t);J(n,(function(e){if(!K(n,e)){if("rpc"!==e)throw B(e);!function(e,t){var n=t;if(!b.test(t=k()))throw B(t,"name");var r,o,i,s=t;if(U("("),U("stream",!0)&&(o=!0),!N.test(t=k()))throw B(t);if(r=t,U(")"),U("returns"),U("("),U("stream",!0)&&(i=!0),!N.test(t=k()))throw B(t);t=t,U(")");var a=new d(s,n,r,t,o,i);J(a,(function(e){if("option"!==e)throw B(e);H(a,e),U(";")})),e.add(a)}(n,e)}})),e.add(n)}(e,t),1;case"extend":return function(e,t){if(!N.test(t=k()))throw B(t,"reference");var n=t;J(null,(function(t){switch(t){case"required":case"repeated":case"optional":W(e,t,n);break;default:if(!L||!N.test(t))throw B(t);M(t),W(e,"optional",n)}}))}(e,t),1}}function J(e,t,n){var r,o=C.line;if(e&&(e.comment=P(),e.filename=A.filename),U("{",!0)){for(;"}"!==(r=k());)t(r);U(";",!0)}else n&&n(),U(";"),e&&"string"!=typeof e.comment&&(e.comment=P(o))}function W(e,t,n){var r=k();if("group"!==r){if(!N.test(r))throw B(r,"type");var o=k();if(!b.test(o))throw B(o,"name");o=G(o),U("=");var a=new s(o,q(k()),r,t,n);J(a,(function(e){if("option"!==e)throw B(e);H(a,e),U(";")}),(function(){z(a)})),e.add(a),L||!a.repeated||void 0===l.packed[r]&&void 0!==l.basic[r]||a.setOption("packed",!1,!0)}else!function(e,t){var n=k();if(!b.test(n))throw B(n,"name");var r=p.lcFirst(n);n===r&&(n=p.ucFirst(n)),U("=");var o=q(k()),a=new i(n);a.group=!0,(t=new s(r,o,n,t)).filename=A.filename,J(a,(function(e){switch(e){case"option":H(a,e),U(";");break;case"required":case"optional":case"repeated":W(a,e);break;default:throw B(e)}})),e.add(a).add(t)}(e,t)}function H(e,t){var n=U("(",!0);if(!N.test(t=k()))throw B(t,"name");var r=t;n&&(U(")"),r="("+r+")",t=D(),O.test(t)&&(r+=t,k())),U("="),function e(t,n){if(U("{",!0))do{if(!b.test(I=k()))throw B(I,"name");"{"===D()?e(t,n+"."+I):(U(":"),"{"===D()?e(t,n+"."+I):Y(t,n+"."+I,F(!0)))}while(!U("}",!0));else Y(t,n,F(!0))}(e,r)}function Y(e,t,n){e.setOption&&e.setOption(t,n)}function z(e){if(U("[",!0)){for(;H(e,"option"),U(",",!0););U("]")}return e}for(;null!==(I=k());)switch(I){case"package":if(!x)throw B(I);!function(){if(void 0!==w)throw B("package");if(w=k(),!N.test(w))throw B(w,"name");j=j.define(w),U(";")}();break;case"import":if(!x)throw B(I);!function(){var e,t;switch(D()){case"weak":e=T=T||[],k();break;case"public":k();default:e=S=S||[]}t=V(),U(";"),e.push(t)}();break;case"syntax":if(!x)throw B(I);!function(){if(U("="),R=V(),!(L="proto3"===R)&&"proto2"!==R)throw B(R,"syntax");U(";")}();break;case"option":if(!x)throw B(I);H(j,I),U(";");break;default:if(K(j,I)){x=!1;continue}throw B(I)}return A.filename=null,{package:w,imports:S,weakImports:T,syntax:R,root:t}}A._configure=function(){r=n(23),o=n(12),i=n(6),s=n(5),a=n(16),u=n(10),c=n(4),f=n(13),d=n(17),l=n(8),p=n(1)}},function(e,t){e.exports=l;var n=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,o=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,i=/^ *[*/]+ */,s=/^\s*\*?\/*/,a=/\n/g,u=/\s/,c=/\\(.?)/g,f={0:"\0",r:"\r",n:"\n",t:"\t"};function d(e){return e.replace(c,(function(e,t){switch(t){case"\\":case"":return t;default:return f[t]||""}}))}function l(e,t){e=e.toString();var c=0,f=e.length,l=1,p=null,h=null,g=0,y=!1,v=[],m=null;function _(e){return Error("illegal "+e+" (line "+l+")")}function E(t){return e.charAt(t)}function b(n,r){p=e.charAt(n++),g=l,y=!1;var o,u=n-(t?2:3);do{if(--u<0||"\n"===(o=e.charAt(u))){y=!0;break}}while(" "===o||"\t"===o);for(var c=e.substring(n,r).split(a),f=0;f<c.length;++f)c[f]=c[f].replace(t?s:i,"").trim();h=c.join("\n").trim()}function N(t){var n=O(t);return n=e.substring(t,n),/^\s*\/{1,2}/.test(n)}function O(e){for(var t=e;t<f&&"\n"!==E(t);)t++;return t}function A(){if(0<v.length)return v.shift();if(m)return function(){var t="'"===m?o:r;t.lastIndex=c-1;var n=t.exec(e);if(!n)throw _("string");return c=t.lastIndex,w(m),m=null,d(n[1])}();var i,s,a,p,h;do{if(c===f)return null;for(i=!1;u.test(a=E(c));)if("\n"===a&&++l,++c===f)return null;if("/"===E(c)){if(++c===f)throw _("comment");if("/"===E(c))if(t){if(h=!1,N(p=c))for(h=!0;(c=O(c))!==f&&N(++c););else c=Math.min(f,O(c)+1);h&&b(p,c),l++,i=!0}else{for(h="/"===E(p=c+1);"\n"!==E(++c);)if(c===f)return null;++c,h&&b(p,c-1),++l,i=!0}else{if("*"!==(a=E(c)))return"/";p=c+1,h=t||"*"===E(p);do{if("\n"===a&&++l,++c===f)throw _("comment")}while(s=a,a=E(c),"*"!==s||"/"!==a);++c,h&&b(p,c-2),i=!0}}}while(i);var g=c;if(n.lastIndex=0,!n.test(E(g++)))for(;g<f&&!n.test(E(g));)++g;var y=e.substring(c,c=g);return'"'!==y&&"'"!==y||(m=y),y}function w(e){v.push(e)}function S(){if(!v.length){var e=A();if(null===e)return null;w(e)}return v[0]}return Object.defineProperty({next:A,peek:S,push:w,skip:function(e,t){var n=S();if(n===e)return A(),!0;if(!t)throw _("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var n=null;return void 0===e?g===l-1&&(t||"*"===p||y)&&(n=h):(g<e&&S(),g!==e||y||!t&&"/"!==p||(n=h)),n}},"line",{get:function(){return l}})}l.unescape=d},function(e,t,n){e.exports=o;var r=n(1);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}((o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o).prototype.rpcCall=function e(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t){e.exports=r;var n=/\/|\./;function r(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:e={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:e}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},function(e,t,n){e.exports=a;var r,o,i=n(1);function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function a(e){this.buf=e,this.pos=0,this.len=e.length}var u,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new a(e);if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return new a(new Uint8Array(e));throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new a(e);throw Error("illegal buffer")};function f(){var e=new r(0,0),t=0;if(!(4<this.len-this.pos)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,4<this.len-this.pos){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function l(){if(this.pos+8>this.len)throw s(this,8);return new r(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}a.create=i.Buffer?function(e){return(a.create=function(e){return i.Buffer.isBuffer(e)?new(void 0)(e):c(e)})(e)}:c,a.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,a.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),a.prototype.int32=function(){return 0|this.uint32()},a.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},a.prototype.bool=function(){return 0!==this.uint32()},a.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|d(this.buf,this.pos+=4)},a.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},a.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},a.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},a.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},a.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},a.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},a._configure=function(){r=n(15),o=n(11);var e=i.Long?"toLong":"toNumber";i.merge(a.prototype,{int64:function(){return f.call(this)[e](!1)},uint64:function(){return f.call(this)[e](!0)},sint64:function(){return f.call(this).zzDecode()[e](!1)},fixed64:function(){return l.call(this)[e](!0)},sfixed64:function(){return l.call(this)[e](!1)}})}},function(e,t,n){var r,o;function i(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function s(e,t,n,s){if(s=s.types,e.resolvedType){if(e.resolvedType instanceof r){if(Object.keys(e.resolvedType.values).indexOf(n)<0)return i(e,"enum value")}else if(t=s[t].verify(n))return e.name+"."+t}else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!o.isInteger(n))return i(e,"integer");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!(o.isInteger(n)||n&&o.isInteger(n.low)&&o.isInteger(n.high)))return i(e,"integer|Long");break;case"float":case"double":if("number"!=typeof n)return i(e,"number");break;case"bool":if("boolean"!=typeof n)return i(e,"boolean");break;case"string":if(!o.isString(n))return i(e,"string");break;case"bytes":if(!(n&&"number"==typeof n.length||o.isString(n)))return i(e,"buffer")}}(e.exports=function(e){return function(t){return function(n){var r;if("object"!=typeof n||null===n)return"object expected";var a,u={};e.oneofsArray.length&&(a={});for(var c=0;c<e.fieldsArray.length;++c){var f=e._fieldsArray[c].resolve(),d=n[f.name];if(!f.optional||null!=d&&n.hasOwnProperty(f.name))if(f.map){if(!o.isObject(d))return i(f,"object");for(var l=Object.keys(d),p=0;p<l.length;++p){if(r=function(e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!o.key32Re.test(t))return i(e,"integer key");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!o.key64Re.test(t))return i(e,"integer|Long key");break;case"bool":if(!o.key2Re.test(t))return i(e,"boolean key")}}(f,l[p]))return r;if(r=s(f,c,d[l[p]],t))return r}}else if(f.repeated){if(!Array.isArray(d))return i(f,"array");for(p=0;p<d.length;++p)if(r=s(f,c,d[p],t))return r}else{if(f.partOf){var h=f.partOf.name;if(1===u[f.partOf.name]&&1===a[h])return f.partOf.name+": multiple values";a[h]=1}if(r=s(f,c,d,t))return r}}}}})._configure=function(){r=n(4),o=n(1)}},function(t,n,r){var o,i;(t.exports=function(t){return function(n){var r=n.Writer,s=n.types,a=n.util;return function(n,u){u=u||r.create();for(var c=t.fieldsArray.slice().sort(a.compareFieldsById),f=0;f<c.length;f++){var d=c[f],l=t._fieldsArray.indexOf(d),p=d.resolvedType instanceof o?"uint32":d.type,h=i.basic[p],g=n[d.name];if(d.resolvedType instanceof o&&"string"==typeof g&&(g=s[l].values[g]),d.map){if(null!=g&&n.hasOwnProperty(d.name))for(var y=Object.keys(g),v=0;v<y.length;++v)u.uint32((d.id<<3|2)>>>0).fork().uint32(8|i.mapKey[d.keyType])[d.keyType](y[v]),(void 0===h?s[l].encode(g[y[v]],u.uint32(18).fork()).ldelim():u.uint32(16|h)[p](g[y[v]])).ldelim()}else if(d.repeated){if(g&&g.length)if(d.packed&&void 0!==i.packed[p]){u.uint32((d.id<<3|2)>>>0).fork();for(var m=0;m<g.length;m++)u[p](g[m]);u.ldelim()}else for(var _=0;_<g.length;_++)void 0===h?d.resolvedType.group?s[l].encode(g[_],u.uint32((d.id<<3|3)>>>0)).uint32((d.id<<3|4)>>>0):s[l].encode(g[_],u.uint32((d.id<<3|2)>>>0).fork()).ldelim():u.uint32((d.id<<3|h)>>>0)[p](g[_])}else(!d.optional||null!=g&&n.hasOwnProperty(d.name))&&(d.optional||null!=g&&n.hasOwnProperty(d.name)||e("warn","\u6ce8\u610f\u5566!!!\u5f88\u5927\u6982\u7387\u4f1a\u62a5\u9519 \u7c7b\u578b:",n.$type?n.$type.name:"\u4e0d\u6653\u5f97","\u6ca1\u6709\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5c5e\u6027:",d.name,"\u68c0\u67e5\u662f\u4e0d\u662fproto\u6587\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u4e86required"," at libs/qnuniapp-im.js:1"),void 0===h?d.resolvedType.group?s[l].encode(g,u.uint32((d.id<<3|3)>>>0)).uint32((d.id<<3|4)>>>0):s[l].encode(g,u.uint32((d.id<<3|2)>>>0).fork()).ldelim():u.uint32((d.id<<3|h)>>>0)[p](g))}return u}}})._configure=function(){o=r(4),i=r(8)}},function(e,t,n){var r,o,i;(e.exports=function(e){return function(t){var n=t.Reader,s=t.types,a=t.util;return function(t,u){t instanceof n||(t=n.create(t));for(var c,f=void 0===u?t.len:t.pos+u,d=new this.ctor;t.pos<f;){var l=t.uint32();if(e.group&&4==(7&l))break;for(var p=l>>>3,h=0,g=!1;h<e.fieldsArray.length;++h){var y=e._fieldsArray[h].resolve(),v=y.name,m=y.resolvedType instanceof r?"int32":y.type;if(p==y.id){if(g=!0,y.map)t.skip().pos++,d[v]===a.emptyObject&&(d[v]={}),c=t[y.keyType](),t.pos++,null!=o.long[y.keyType]?null==o.basic[m]?d[v]["object"==typeof c?a.longToHash(c):c]=s[h].decode(t,t.uint32()):d[v]["object"==typeof c?a.longToHash(c):c]=t[m]():null==o.basic[m]?d[v]=s[h].decode(t,t.uint32()):d[v]=t[m]();else if(y.repeated)if(d[v]&&d[v].length||(d[v]=[]),null!=o.packed[m]&&2==(7&l))for(var _=t.uint32()+t.pos;t.pos<_;)d[v].push(t[m]());else null==o.basic[m]?y.resolvedType.group?d[v].push(s[h].decode(t)):d[v].push(s[h].decode(t,t.uint32())):d[v].push(t[m]());else null==o.basic[m]?y.resolvedType.group?d[v]=s[h].decode(t):d[v]=s[h].decode(t,t.uint32()):d[v]=t[m]();break}}g||t.skipType(7&l)}for(h=0;h<e._fieldsArray.length;++h){var E=e._fieldsArray[h];if(E.required&&!d.hasOwnProperty(E.name))throw i.ProtocolError("missing required '"+E.name+"'",{instance:d})}return d}}})._configure=function(){r=n(4),o=n(8),i=n(1)}},function(e,t,n){var r;(t=t)[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n;return t&&t.json&&e.type_url&&e.value&&(n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),(n=this.lookup(n))&&(e=n.decode(e.value))),e instanceof this.ctor||!(e instanceof r)?this.toObject(e,t):((t=e.$type.toObject(e,t))["@type"]=e.$type.fullName,t)}},t._configure=function(){r=n(18)}},function(e,t,n){var r,o;function i(e,t,n,i){var s=i.m,a=i.d,u=i.types,c=i.ksi,f=void 0!==c;if(e.resolvedType)if(e.resolvedType instanceof r){for(var d=f?a[n][c]:a[n],l=e.resolvedType.values,p=Object.keys(l),h=0;h<p.length;h++)if(!(e.repeated&&l[p[h]]===e.typeDefault||p[h]!=d&&l[p[h]]!=d)){f?s[n][c]=l[p[h]]:s[n]=l[p[h]];break}}else{if("object"!=typeof(f?a[n][c]:a[n]))throw TypeError(e.fullName+": object expected");f?s[n][c]=u[t].fromObject(a[n][c]):s[n]=u[t].fromObject(a[n])}else{var g=!1;switch(e.type){case"double":case"float":f?s[n][c]=Number(a[n][c]):s[n]=Number(a[n]);break;case"uint32":case"fixed32":f?s[n][c]=a[n][c]>>>0:s[n]=a[n]>>>0;break;case"int32":case"sint32":case"sfixed32":f?s[n][c]=0|a[n][c]:s[n]=0|a[n];break;case"uint64":g=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":o.Long?f?s[n][c]=o.Long.fromValue(a[n][c]).unsigned=g:s[n]=o.Long.fromValue(a[n]).unsigned=g:"string"==typeof(f?a[n][c]:a[n])?f?s[n][c]=parseInt(a[n][c],10):s[n]=parseInt(a[n],10):"number"==typeof(f?a[n][c]:a[n])?f?s[n][c]=a[n][c]:s[n]=a[n]:"object"==typeof(f?a[n][c]:a[n])&&(f?s[n][c]=new o.LongBits(a[n][c].low>>>0,a[n][c].high>>>0).toNumber(g):s[n]=new o.LongBits(a[n].low>>>0,a[n].high>>>0).toNumber(g));break;case"bytes":"string"==typeof(f?a[n][c]:a[n])?f?o.base64.decode(a[n][c],s[n][c]=o.newBuffer(o.base64.length(a[n][c])),0):o.base64.decode(a[n],s[n]=o.newBuffer(o.base64.length(a[n])),0):(f?a[n][c]:a[n]).length&&(f?s[n][c]=a[n][c]:s[n]=a[n]);break;case"string":f?s[n][c]=String(a[n][c]):s[n]=String(a[n]);break;case"bool":f?s[n][c]=Boolean(a[n][c]):s[n]=Boolean(a[n])}}}function s(e,t,n,i){var s=i.m,a=i.d,u=i.types,c=i.ksi,f=i.o,d=void 0!==c;if(e.resolvedType)e.resolvedType instanceof r?d?a[n][c]=f.enums===String?u[t].values[s[n][c]]:s[n][c]:a[n]=f.enums===String?u[t].values[s[n]]:s[n]:d?a[n][c]=u[t].toObject(s[n][c],f):a[n]=u[t].toObject(s[n],f);else{var l=!1;switch(e.type){case"double":case"float":d?a[n][c]=f.json&&!isFinite(s[n][c])?String(s[n][c]):s[n][c]:a[n]=f.json&&!isFinite(s[n])?String(s[n]):s[n];break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":"number"==typeof s[n][c]?d?a[n][c]=f.longs===String?String(s[n][c]):s[n][c]:a[n]=f.longs===String?String(s[n]):s[n]:d?a[n][c]=f.longs===String?o.Long.prototype.toString.call(s[n][c]):f.longs===Number?new o.LongBits(s[n][c].low>>>0,s[n][c].high>>>0).toNumber(l):s[n][c]:a[n]=f.longs===String?o.Long.prototype.toString.call(s[n]):f.longs===Number?new o.LongBits(s[n].low>>>0,s[n].high>>>0).toNumber(l):s[n];break;case"bytes":d?a[n][c]=f.bytes===String?o.base64.encode(s[n][c],0,s[n][c].length):f.bytes===Array?Array.prototype.slice.call(s[n][c]):s[n][c]:a[n]=f.bytes===String?o.base64.encode(s[n],0,s[n].length):f.bytes===Array?Array.prototype.slice.call(s[n]):s[n];break;default:d?a[n][c]=s[n][c]:a[n]=s[n]}}}(e=e.exports)._configure=function(){r=n(4),o=n(1)},e.fromObject=function(e){var t=e.fieldsArray;return function(e){return function(n){if(n instanceof this.ctor)return n;if(!t.length)return new this.ctor;for(var s=new this.ctor,a=0;a<t.length;++a){var u=t[a].resolve(),c=u.name;if(u.map){if(n[c]){if("object"!=typeof n[c])throw TypeError(u.fullName+": object expected");s[c]={}}for(var f=Object.keys(n[c]),d=0;d<f.length;++d)i(u,a,c,o.merge(o.copy(e),{m:s,d:n,ksi:f[d]}))}else if(u.repeated){if(n[c]){if(!Array.isArray(n[c]))throw TypeError(u.fullName+": array expected");for(s[c]=[],d=0;d<n[c].length;++d)i(u,a,c,o.merge(o.copy(e),{m:s,d:n,ksi:d}))}}else(u.resolvedType instanceof r||null!=n[c])&&i(u,a,c,o.merge(o.copy(e),{m:s,d:n}))}return s}}},e.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);return function(n){return t.length?function(i,a){a=a||{};for(var u,c,f={},d=[],l=[],p=[],h=0;h<t.length;++h)t[h].partOf||(t[h].resolve().repeated?d:t[h].map?l:p).push(t[h]);if(d.length&&(a.arrays||a.defaults))for(h=0;h<d.length;++h)f[d[h].name]=[];if(l.length&&(a.objects||a.defaults))for(h=0;h<l.length;++h)f[l[h].name]={};if(p.length&&a.defaults)for(h=0;h<p.length;++h)v=(u=p[h]).name,u.resolvedType instanceof r?f[v]=a.enums=String?u.resolvedType.valuesById[u.typeDefault]:u.typeDefault:u.long?o.Long?(c=new o.Long(u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned),f[v]=a.longs===String?c.toString():a.longs===Number?c.toNumber():c):f[v]=a.longs===String?u.typeDefault.toString():u.typeDefault.toNumber():u.bytes?f[v]=a.bytes===String?String.fromCharCode.apply(String,u.typeDefault):Array.prototype.slice.call(u.typeDefault).join("*..*").split("*..*"):f[v]=u.typeDefault;for(h=0;h<t.length;++h){var g,y,v=(u=t[h]).name,m=e._fieldsArray.indexOf(u);if(u.map){if(i[v]&&(g=Object.keys(i[v]).length))for(f[v]={},y=0;y<g.length;++y)s(u,m,v,o.merge(o.copy(n),{m:i,d:f,ksi:g[y],o:a}))}else if(u.repeated){if(i[v]&&i[v].length)for(f[v]=[],y=0;y<i[v].length;++y)s(u,m,v,o.merge(o.copy(n),{m:i,d:f,ksi:y,o:a}))}else null!=i[v]&&i.hasOwnProperty(v)&&s(u,m,v,o.merge(o.copy(n),{m:i,d:f,o:a})),u.partOf&&a.oneofs&&(f[u.partOf.name]=v)}return f}:function(){return{}}}}},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.messagebody||(e.roots.messagebody=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{MessageOperation:{fields:{type:{type:"OpType",id:1},mid:{type:"uint64",id:2},xid:{type:"XID",id:3}},nested:{OpType:{values:{UNKNOWN:0,READ_ACK:1,READ_ALL:2,READ_CANCEL:3,DELIVER_ACK:4,RECALL:5,DELETE:6,PLAY_ACK:7}}}},MessageBody:{fields:{type:{type:"Type",id:1},content:{type:"string",id:4},ctype:{type:"ContentType",id:5},operation:{type:"MessageOperation",id:6},config:{type:"string",id:7},attachment:{type:"string",id:8},ext:{type:"string",id:9},qos:{type:"QoS",id:10},sender_name:{type:"string",id:11},is_system:{type:"bool",id:12},priority:{type:"uint32",id:13},status:{type:"Status",id:14}},nested:{Type:{values:{NORMAL:0,OPER:1,CHAT:2,GROUPCHAT:3}},ContentType:{values:{TEXT:0,IMAGE:1,AUDIO:2,VIDEO:3,FILE:4,LOCATION:5,COMMAND:6,FORWARD:7}},QoS:{values:{AT_LEAST_ONCE:0,AT_MOST_ONCE:1,EXACTLY_ONCE:2}},Status:{values:{UNREAD:0,DELIVERED:1,READ:2}}}},XID:{fields:{uid:{type:"uint64",id:1},deviceSN:{type:"uint32",id:2}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.groupnotice||(e.roots.groupnotice=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{GroupNotice:{fields:{type:{type:"Type",id:1},gid:{type:"XID",id:2},from:{type:"XID",id:3},to:{rule:"repeated",type:"XID",id:4},content:{type:"string",id:5}},nested:{Type:{values:{UNKNOWN:0,PRESENCE:1,ABSENCE:2,CREATED:3,DESTROYED:4,JOINED:5,LEAVED:6,APPLYED:7,APPLY_ACCEPTED:8,APPLY_DECLINED:9,INVITED:10,INVITE_ACCEPTED:11,INVITE_DECLINED:12,KICKED:13,BLOCKED:14,UNBLOCKED:15,OWNER_ASSIGNED:16,ADMIN_GRANTED:17,ADMIN_REVOKED:18,MUTED:19,UNMUTED:20,BANNED:21,UNBANNED:22,INFO_UPDATED:23,ANNOUNCEMENT_UPDATED:24,MESSAGE_SETTING:25,FILE_UPLOADED:26,FILE_DELETED:27,FILE_UPDATED:28}}}},XID:{fields:{uid:{type:"uint64",id:1},deviceSN:{type:"uint32",id:2}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.rosternotice||(e.roots.rosternotice=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{RosterNotice:{fields:{type:{type:"Type",id:1},from:{type:"XID",id:2},to:{rule:"repeated",type:"XID",id:3},content:{type:"string",id:4},roster_vsn:{type:"string",id:5}},nested:{Type:{values:{UNKNOWN:0,ADDED:1,REMOVED:2,ACCEPTED:3,DECLINED:4,APPLIED:7,BLOCKED:5,UNBLOCKED:6,INFO_UPDATED:8,MUTED:9,UNMUTED:10}}}},XID:{fields:{uid:{type:"uint64",id:1},deviceSN:{type:"uint32",id:2}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.usernotice||(e.roots.usernotice=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{UserNotice:{fields:{type:{type:"Type",id:1},content:{type:"string",id:2}},nested:{Type:{values:{UNKNOWN:0,PASSWORD_CHANGED:1,FROZEN:2,REMOVED:3,KICK_BY_SAME_DEVICE:4,KICKED_BY_OTHER_DEVICE:5,INFO_UPDATED:6,DEVICE_LOGIN:7,DEVICE_LOGOUT:8,DEVICE_ADDED:9,DEVICE_REMOVED:10,CLUSTER_CHANGED:11}}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.info||(e.roots.info=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{Info:{fields:{sdk_vsn:{type:"string",id:1},network:{type:"Network",id:2},content:{type:"string",id:3}},nested:{Network:{values:{WIRE:0,WIFI:1,NET_2G:2,NET_3G:3,NET_4G:4,NET_5G:5,UNKNOWN:6}}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){var r=[n(0)];void 0===(n="function"==typeof(n=function(e){return(e.roots.conversation||(e.roots.conversation=new e.Root)).addJSON({im:{nested:{floo:{nested:{protobuf:{nested:{Conversation:{fields:{type:{type:"Type",id:1},operation:{type:"ConversationOperation",id:2}},nested:{Type:{values:{UNKNOWN:0,OPER:1}}}},ConversationOperation:{fields:{type:{type:"OpType",id:1},xid:{type:"XID",id:2}},nested:{OpType:{values:{UNKNOWN:0,DELETE:1,DELETE_EVERYWHERE:2}}}},XID:{fields:{uid:{type:"uint64",id:1},deviceSN:{type:"uint32",id:2}}}}}}}}}})})?n.apply(t,r):n)||(e.exports=n)},function(e,t,n){e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},function(e,t,n){var r=new RegExp("%[a-f0-9]{2}","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function i(e){try{return decodeURIComponent(e)}catch(o){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=function e(t,n){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;var r=t.slice(0,n=n||1);return n=t.slice(n),Array.prototype.concat.call([],e(r),e(n))}(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},n=o.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=i(n[0]);r!==n[0]&&(t[n[0]]=r)}n=o.exec(e)}t["%C2"]="\ufffd";for(var s=Object.keys(t),a=0;a<s.length;a++){var u=s[a];e=e.replace(new RegExp(u,"g"),t[u])}return e}(e)}}},function(e,t,n){e.exports=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function o(e){return!0===(e&&e.__isLong__)}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=o;var i={},s={};function a(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=c(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=c(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function u(e,t){if(isNaN(e))return t?m:v;if(t){if(e<0)return m;if(h<=e)return O}else{if(e<=-g)return A;if(g<=e+1)return N}return e<0?u(-e,t).neg():c(e%p|0,e/p|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=u,r.fromBits=c;var f=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if(t="number"==typeof t?(n=t,!1):!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return d(e.substring(1),t,n).neg();for(var o=u(f(n,8)),i=v,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),n);i=a<8?(a=u(f(n,a)),i.mul(a).add(u(c))):(i=i.mul(o)).add(u(c))}return i.unsigned=t,i}function l(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?d(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=l;var p=4294967296,h=p*p,g=h/2,y=a(1<<24),v=a(0);r.ZERO=v;var m=a(0,!0);r.UZERO=m;var _=a(1);r.ONE=_;var E=a(1,!0);r.UONE=E;var b=a(-1);r.NEG_ONE=b;var N=c(-1,2147483647,!1);r.MAX_VALUE=N;var O=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=O;var A=c(0,-2147483648,!1);r.MIN_VALUE=A;var w=r.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},w.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(A)){var t=u(e),n=this.div(t);return t=n.mul(t).sub(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=u(f(e,6),this.unsigned),o=this,i="";;){var s=o.div(r),a=(o.sub(s.mul(r)).toInt()>>>0).toString(e);if((o=s).isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||0<=this.high},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(e){return o(e)||(e=l(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},w.eq=w.equals,w.notEquals=function(e){return!this.eq(e)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(e){return this.comp(e)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(e){return this.comp(e)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(e){return 0<this.comp(e)},w.gt=w.greaterThan,w.greaterThanOrEqual=function(e){return 0<=this.comp(e)},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(e){if(o(e)||(e=l(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(_)},w.neg=w.negate,w.add=function(e){o(e)||(e=l(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,f=0,d=0,p=0,h=0;return p+=(h+=i+(65535&e.low))>>>16,d+=(p+=r+u)>>>16,f+=(d+=n+a)>>>16,f+=t+s,c((p&=65535)<<16|(h&=65535),(f&=65535)<<16|(d&=65535),this.unsigned)},w.subtract=function(e){return o(e)||(e=l(e)),this.add(e.neg())},w.sub=w.subtract,w.multiply=function(e){if(this.isZero())return v;if(o(e)||(e=l(e)),n)return c(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(A))return e.isOdd()?A:v;if(e.eq(A))return this.isOdd()?A:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,f=65535&e.high,d=e.low>>>16,p=65535&e.low,h=0,g=0,m=0;return e=0,m+=(e+=s*p)>>>16,g+=(m+=i*p)>>>16,m&=65535,g+=(m+=s*d)>>>16,h+=(g+=r*p)>>>16,g&=65535,h+=(g+=i*d)>>>16,g&=65535,h+=(g+=s*f)>>>16,h+=t*p+r*d+i*f+s*a,c((m&=65535)<<16|(e&=65535),(h&=65535)<<16|(g&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(e){if((e=o(e)?e:l(e)).isZero())throw Error("division by zero");var t,r;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:v;if(this.unsigned){if((e=e.unsigned?e:e.toUnsigned()).gt(this))return m;if(e.gt(this.shru(1)))return E;r=m}else{if(this.eq(A))return e.eq(_)||e.eq(b)?A:e.eq(A)?_:(i=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?_:b:(t=this.sub(e.mul(i)),i.add(t.div(e)));if(e.eq(A))return this.unsigned?m:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=v}for(t=this;t.gte(e);){for(var i=Math.max(1,Math.floor(t.toNumber()/e.toNumber())),s=Math.ceil(Math.log(i)/Math.LN2),a=s<=48?1:f(2,s-48),d=u(i),p=d.mul(e);p.isNegative()||p.gt(t);)p=(d=u(i-=a,this.unsigned)).mul(e);d.isZero()&&(d=_),r=r.add(d),t=t.sub(p)}return r},w.div=w.divide,w.modulo=function(e){return o(e)||(e=l(e)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.and=function(e){return o(e)||(e=l(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},w.or=function(e){return o(e)||(e=l(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},w.xor=function(e){return o(e)||(e=l(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},w.shiftLeft=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(e){if(o(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},w.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t){e.exports=function(e,t,n){var r=n||8192,o=r>>>1,i=null,s=r;return function(n){return n<1||o<n?e(n):(r<s+n&&(i=e(r),s=0),n=t.call(i,s,s+=n),7&s&&(s=1+(7|s)),n)}}},function(e,t){function n(e){return"undefined"!=typeof Float32Array?(p=new Float32Array([-0]),g=128===(h=new Uint8Array(p.buffer))[3],e.writeFloatLE=g?m:_,e.writeFloatBE=g?_:m,e.readFloatLE=g?E:b,e.readFloatBE=g?b:E):(e.writeFloatLE=y.bind(null,r),e.writeFloatBE=y.bind(null,o),e.readFloatLE=v.bind(null,i),e.readFloatBE=v.bind(null,s)),"undefined"!=typeof Float64Array?(d=new Float64Array([-0]),g=128===(l=new Uint8Array(d.buffer))[7],e.writeDoubleLE=g?a:u,e.writeDoubleBE=g?u:a,e.readDoubleLE=g?c:f,e.readDoubleBE=g?f:c):(e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,i,0,4),e.readDoubleBE=n.bind(null,s,4,0)),e;function t(e,t,n,r,o,i){var s,a,u=r<0?1:0;0===(r=u?-r:r)?(e(0,o,i+t),e(0<1/r?0:2147483648,o,i+n)):isNaN(r)?(e(0,o,i+t),e(2146959360,o,i+n)):17976931348623157e292<r?(e(0,o,i+t),e((u<<31|2146435072)>>>0,o,i+n)):r<22250738585072014e-324?(e((s=r/5e-324)>>>0,o,i+t),e((u<<31|s/4294967296)>>>0,o,i+n)):(1024===(a=Math.floor(Math.log(r)/Math.LN2))&&(a=1023),e(4503599627370496*(s=r*Math.pow(2,-a))>>>0,o,i+t),e((u<<31|a+1023<<20|1048576*s&1048575)>>>0,o,i+n))}function n(e,t,n,r,o){return t=e(r,o+t),o=2*((r=e(r,o+n))>>31)+1,t=4294967296*(1048575&r)+t,2047==(n=r>>>20&2047)?t?NaN:1/0*o:0==n?5e-324*o*t:o*Math.pow(2,n-1075)*(t+4503599627370496)}function a(e,t,n){d[0]=e,t[n]=l[0],t[n+1]=l[1],t[n+2]=l[2],t[n+3]=l[3],t[n+4]=l[4],t[n+5]=l[5],t[n+6]=l[6],t[n+7]=l[7]}function u(e,t,n){d[0]=e,t[n]=l[7],t[n+1]=l[6],t[n+2]=l[5],t[n+3]=l[4],t[n+4]=l[3],t[n+5]=l[2],t[n+6]=l[1],t[n+7]=l[0]}function c(e,t){return l[0]=e[t],l[1]=e[t+1],l[2]=e[t+2],l[3]=e[t+3],l[4]=e[t+4],l[5]=e[t+5],l[6]=e[t+6],l[7]=e[t+7],d[0]}function f(e,t){return l[7]=e[t],l[6]=e[t+1],l[5]=e[t+2],l[4]=e[t+3],l[3]=e[t+4],l[2]=e[t+5],l[1]=e[t+6],l[0]=e[t+7],d[0]}var d,l,p,h,g;function y(e,t,n,r){var o=t<0?1:0;0===(t=o?-t:t)?e(0<1/t?0:2147483648,n,r):isNaN(t)?e(2143289344,n,r):e(34028234663852886e22<t?(o<<31|2139095040)>>>0:t<11754943508222875e-54?(o<<31|Math.round(t/1401298464324817e-60))>>>0:(o<<31|(o=Math.floor(Math.log(t)/Math.LN2))+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}function v(e,t,n){return t=2*((e=e(t,n))>>31)+1,n=e>>>23&255,e&=8388607,255==n?e?NaN:1/0*t:0==n?1401298464324817e-60*t*e:t*Math.pow(2,n-150)*(8388608+e)}function m(e,t,n){p[0]=e,t[n]=h[0],t[n+1]=h[1],t[n+2]=h[2],t[n+3]=h[3]}function _(e,t,n){p[0]=e,t[n]=h[3],t[n+1]=h[2],t[n+2]=h[1],t[n+3]=h[0]}function E(e,t){return h[0]=e[t],h[1]=e[t+1],h[2]=e[t+2],h[3]=e[t+3],p[0]}function b(e,t){return h[3]=e[t],h[2]=e[t+1],h[1]=e[t+2],h[0]=e[t+3],p[0]}}function r(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=n(n)},function(e,t,n){e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,o=2,i=!0;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,s){n[r]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,s(e))}}))}},function(e,t,n){function r(){this._listeners={}}(e.exports=r).prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t){var n=(e=e.exports).isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},r=e.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=n(e);e="",r&&(e=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?0<o&&".."!==t[o-1]?t.splice(--o,2):r?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return e+t.join("/")};e.resolve=function(e,t,o){return o||(t=r(t)),n(t)?t:(e=(e=o?e:r(e)).replace(/(?:\/|^)[^/]+$/,"")).length?r(e+"/"+t):t}},function(t,n,r){r.r(n),r.d(n,"flooim",(function(){return fo}));var o={};r.r(o),r.d(o,"STATIC_FRAME_VSN",(function(){return l})),r.d(o,"STATIC_FRAME_COMMAND",(function(){return p})),r.d(o,"STATIC_FRAME_COMPRESS_METHOD",(function(){return h})),r.d(o,"STATIC_FRAME_ERROR_STATUS",(function(){return g})),r.d(o,"STATIC_FRAME_OSTYPE",(function(){return y})),r.d(o,"STATIC_FRAME_ENCRYPTMETHOD",(function(){return v})),r.d(o,"STATIC_META_NAMESPACE",(function(){return m})),r.d(o,"STATIC_MESSAGE_OPTYPE",(function(){return E})),r.d(o,"STATIC_MESSAGE_TYPE",(function(){return _})),r.d(o,"STATIC_MESSAGE_CONTENT_TYPE",(function(){return b})),r.d(o,"STATIC_MESSAGE_QOS",(function(){return N})),r.d(o,"STATIC_GROUPNOTICE_TYPE",(function(){return O})),r.d(o,"STATIC_INFO_NETWORK",(function(){return A})),r.d(o,"STATIC_USERNOTICE_TYPE",(function(){return S})),r.d(o,"STATIC_ROSTERNONTICE_TYPE",(function(){return w})),r.d(o,"STATIC_CONVERSATION_TYPE",(function(){return T})),r.d(o,"STATIC_CONVERSATION_OPTYPE",(function(){return R})),r.d(o,"STATIC_MESSAGE_STATUS",(function(){return I}));var i={};r.r(i),r.d(i,"getServers",(function(){return ve})),r.d(i,"tokenUser",(function(){return me})),r.d(i,"tokenId",(function(){return _e})),r.d(i,"userRegister",(function(){return Ee})),r.d(i,"userBindMobile",(function(){return be})),r.d(i,"userSendSms",(function(){return Oe})),r.d(i,"userNameCheck",(function(){return Ae})),r.d(i,"userMobileBind",(function(){return we})),r.d(i,"userMobileBindSign",(function(){return Se})),r.d(i,"userMobileLogin",(function(){return Te})),r.d(i,"userUpdateMobile",(function(){return Ne})),r.d(i,"captchaImagePost",(function(){return Re})),r.d(i,"captchaSms",(function(){return Ie})),r.d(i,"rosterAccept",(function(){return Ce})),r.d(i,"rosterApply",(function(){return ke})),r.d(i,"rosterDecline",(function(){return Me})),r.d(i,"rosterDelete",(function(){return De})),r.d(i,"rosterExt",(function(){return Ue})),r.d(i,"rosterId",(function(){return Pe})),r.d(i,"rosterList",(function(){return xe})),r.d(i,"rosterListPost",(function(){return Le})),r.d(i,"rosterName",(function(){return je})),r.d(i,"rosterApplylist",(function(){return Ge})),r.d(i,"rosterBlockedlist",(function(){return Be})),r.d(i,"rosterBlockedAdd",(function(){return Ve})),r.d(i,"rosterBlockeRemove",(function(){return Fe})),r.d(i,"groupAdminAdd",(function(){return Qe})),r.d(i,"groupAdminList",(function(){return qe})),r.d(i,"groupAdminRemove",(function(){return Ke})),r.d(i,"groupAnnouncement",(function(){return Je})),r.d(i,"groupAnnouncementDelete",(function(){return We})),r.d(i,"groupAnnouncementEdit",(function(){return He})),r.d(i,"groupAnnouncementList",(function(){return Ye})),r.d(i,"groupCreate",(function(){return ze})),r.d(i,"groupDestroy",(function(){return Xe})),r.d(i,"groupInfo",(function(){return $e})),r.d(i,"groupInfoAvatar",(function(){return Ze})),r.d(i,"groupInfoDdscription",(function(){return et})),r.d(i,"groupInfoName",(function(){return tt})),r.d(i,"groupMemberlist",(function(){return nt})),r.d(i,"groupMsgMutemode",(function(){return rt})),r.d(i,"groupMsgNotdisturb",(function(){return ot})),r.d(i,"groupPubliclist",(function(){return it})),r.d(i,"groupBannedList",(function(){return st})),r.d(i,"groupBab",(function(){return at})),r.d(i,"groupUnban",(function(){return ut})),r.d(i,"groupSettings",(function(){return ct})),r.d(i,"groupSettingsAllowmemberinvitation",(function(){return ft})),r.d(i,"groupSettingsAllowmembermodify",(function(){return dt})),r.d(i,"groupSettingsEnablereadack",(function(){return lt})),r.d(i,"groupSettingsHistoryvisible",(function(){return pt})),r.d(i,"groupSettingsRequireadminapproval",(function(){return ht})),r.d(i,"groupTransfer",(function(){return gt})),r.d(i,"groupUserjoined",(function(){return yt})),r.d(i,"groupApply",(function(){return vt})),r.d(i,"groupApplicationlist",(function(){return It})),r.d(i,"groupInvitationlist",(function(){return Ct})),r.d(i,"groupApplyHandle",(function(){return mt})),r.d(i,"groupBockedlist",(function(){return _t})),r.d(i,"groupBlock",(function(){return Et})),r.d(i,"groupUnblock",(function(){return bt})),r.d(i,"groupKick",(function(){return Nt})),r.d(i,"groupInvite",(function(){return Ot})),r.d(i,"groupInviteHandle",(function(){return At})),r.d(i,"groupInfoBatch",(function(){return wt})),r.d(i,"groupMembersDidpayname",(function(){return St})),r.d(i,"groupLeave",(function(){return Tt})),r.d(i,"groupDisplayname",(function(){return Rt})),r.d(i,"groupFilelist",(function(){return kt})),r.d(i,"groupFiledelete",(function(){return Mt})),r.d(i,"groupFileupload",(function(){return Dt})),r.d(i,"userAuthmode",(function(){return Ut})),r.d(i,"userAvatar",(function(){return Pt})),r.d(i,"userMobile",(function(){return xt})),r.d(i,"userNickname",(function(){return Lt})),r.d(i,"userProfile",(function(){return jt})),r.d(i,"userProfilePost",(function(){return Gt})),r.d(i,"userPush",(function(){return Bt})),r.d(i,"userPushDetail",(function(){return Vt})),r.d(i,"userPushLimit",(function(){return Ft})),r.d(i,"userPushNickname",(function(){return Qt})),r.d(i,"userSettings",(function(){return qt})),r.d(i,"userSettingsPost",(function(){return Kt})),r.d(i,"userSounds",(function(){return Jt})),r.d(i,"userVibratory",(function(){return Wt})),r.d(i,"bindDeviceToken",(function(){return Ht})),r.d(i,"unbindDeviceToken",(function(){return Yt})),r.d(i,"fileForward",(function(){return zt})),r.d(i,"asyncFileUpload",(function(){return Xt})),r.d(i,"fileUploadAvatarUrl",(function(){return $t})),r.d(i,"fileUploadGroupAvatarUrl",(function(){return Zt})),r.d(i,"fileUploadChatFileUrl",(function(){return en})),r.d(i,"fileDownloadChatFileUrl",(function(){return tn})),r.d(i,"qrcode",(function(){return nn})),r.d(i,"qrlogin",(function(){return rn})),r.d(i,"qrcodeGroupsign",(function(){return on})),r.d(i,"qrcodeGroupinvite",(function(){return sn})),r.d(i,"wxbind",(function(){return an})),r.d(i,"wxlogin",(function(){return un})),r.d(i,"getStaticContact",(function(){return cn})),r.d(i,"wechatUnbind",(function(){return fn})),r.d(i,"wechatIsbind",(function(){return dn})),r.d(i,"wechatBind",(function(){return ln}));var s={};r.r(s),r.d(s,"decode",(function(){return Jn})),r.d(s,"encode",(function(){return Wn}));var a={};r.r(a),r.d(a,"decode",(function(){return or})),r.d(a,"encode",(function(){return ir}));var u={};r.r(u),r.d(u,"decode",(function(){return fr})),r.d(u,"encode",(function(){return dr}));var c={error:console.error,log:console.log,info:console.info,warn:console.warn,dir:console.dir,req:function(e){}},f=r(3),d=r.n(f),l={XSYNC_V1:0,XSYNC_V2:1},p={UNREAD:0,SYNC:1,NOTICE:2,PROVISION:3},h={NONE:0,ZLIB:1},g={UNKNOWN:0,OK:1,FAIL:2,UNKNOWN_COMMAND:3,PB_PARSER_ERROR:4,DECRYPT_FAILURE:5,PUBLIC_KEY_CHANGED:6,INVALID_TOKEN:7,INVALID_PARAMETER:8,UNAUTHORIZED:9,USER_FROZEN:10,USER_BANNED:11,WORD_CENSORED:12,TOO_MANY_DEVICES:13,ENCRYPT_METHOD_UNSUPPORTED:14,DEVICE_GUID_CONFLICT:15,CHECK_SUM_FAILURE:16,INVALID_LICENSE:17,LICENSE_LIMIT:18,APP_FROZEN:19},y={UNKNOWN:0,IOS:1,ANDR:2,WIN:3,OSX:4,LINUX:5,WEB:6},v={ENCRYPT_NONE:0,AES_CBC_128:1,AES_CBC_256:2,CUSTOM:3},m={UNKNOWN:0,MESSAGE:1,GROUP_NOTICE:2,ROSTER_NOTICE:3,USER_NOTICE:4,INFO:5,CONVERSATION:6},_={NORMAL:0,OPER:1,CHAT:2,GROUPCHAT:3},E={UNKNOWN:0,READ_ACK:1,READ_ALL:2,READ_CANCEL:3,DELIVER_ACK:4,RECALL:5,DELETE:6},b={TEXT:0,IMAGE:1,AUDIO:2,VIDEO:3,FILE:4,LOCATION:5,COMMAND:6,FORWARD:7},N={AT_LEAST_ONCE:0,AT_MOST_ONCE:1,EXACTLY_ONCE:2},O={UNKNOWN:0,PRESENCE:1,ABSENCE:2,CREATED:3,DESTROYED:4,JOINED:5,LEAVED:6,APPLYED:7,APPLY_ACCEPTED:8,APPLY_DECLINED:9,INVITED:10,INVITE_ACCEPTED:11,INVITE_DECLINED:12,KICKED:13,BLOCKED:14,UNBLOCKED:15,OWNER_ASSIGNED:16,ADMIN_GRANTED:17,ADMIN_REVOKED:18,MUTED:19,UNMUTED:20,BANNED:21,UNBANNED:22,INFO_UPDATED:23,ANNOUNCEMENT_UPDATED:24,MESSAGE_SETTING:25,FILE_UPLOADED:26,FILE_DELETED:27,FILE_UPDATED:28},A={WIRE:0,WIFI:1,NET_2G:2,NET_3G:3,NET_4G:4,NET_5G:5,UNKNOWN:6},w={UNKNOWN:0,ADDED:1,REMOVED:2,ACCEPTED:3,DECLINED:4,BLOCKED:5,UNBLOCKED:6,APPLIED:7,INFO_UPDATED:8,MUTED:9,UNMUTED:10},S={UNKNOWN:0,PASSWORD_CHANGED:1,FROZEN:2,REMOVED:3,KICK_BY_SAME_DEVICE:4,KICKED_BY_OTHER_DEVICE:5,INFO_UPDATED:6,DEVICE_LOGIN:7,DEVICE_LOGOUT:8,DEVICE_ADDED:9,DEVICE_REMOVED:10,CLUSTER_CHANGED:11},T={UNKNOWN:0,OPER:1},R={UNKNOWN:0,DELETE:1,DELETE_EVERYWHERE:2},I={UNREAD:0,DELIVERED:1,READ:2},C=function e(t){if(t instanceof d.a)return t.toString();var n=t.low,r=t.high,o=t.unsigned,i=void 0===o||o;if(void 0!==n&&void 0!==r)return new d.a(n,r,i).toString();var s=typeof t;if("boolean"==s||"string"==s||"number"==s)return t;if(Array.isArray(t)){var a=[];return t.forEach((function(t){void 0!==t&&a.push(e(t))})),a}var u={};return Object.keys(t).forEach((function(n){void 0!==t[n]&&(u[n]=e(t[n]))})),u},k=function e(t){var n=t.low,r=t.high,o=t.unsigned;if(void 0!==n&&void 0!==r)return new d.a(n,r,o);var i=typeof t;if("boolean"==i||"string"==i||"number"==i)return t;if(Array.isArray(t)){var s=[];return t.forEach((function(t){s.push(e(t))})),s}var a={};return Object.keys(t).forEach((function(n){a[n]=e(t[n])})),a},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){if("string"==typeof e)return+e;if("number"==typeof e)return e;var t=e,n=t.low,r=t.high,o=t.unsigned;return e=void 0===o||o,void 0!==n&&"undefined"!==r?new d.a(n,r,e).toNumber():void 0}(e)},D=function(e){if("string"==typeof e)return d.a.fromString(e);var t=e.low,n=e.high,r=e.unsigned,o=void 0===r||r;return void 0!==t&&"undefined"!==n?new d.a(t,n,o):"number"==typeof e?d.a.fromNumber(e):new d.a},U=function(e){return void 0===e?"":"string"==typeof e?e:"number"==typeof e?e+"":(void 0!==e.low&&void 0!==e.high?new d.a(e.low,e.high,!0):new d.a(e)).toString()},P=function(e){if(!e.payload)return e;var t=e.payload,n=e.from,r=void 0===n?{}:n,o=e.to,i=void 0===o?{}:o,s=e.id,a=void 0===s?{}:s,u=e.status,c=e.timestamp,f=t.content,d=void 0===f?"":f,l=t.attachment,p=void 0===l?"":l,h=t.ctype,g=void 0===h?0:h,y=t.ext,v=t.config,m=t.type,_=null,E=null;try{_=JSON.parse(p)}catch(e){}try{E=JSON.parse(v)}catch(e){}var N=u||t.status,O={id:U(a),from:U(r.uid),to:U(i.uid),content:d,type:Object.keys(b)[g].toLowerCase(),ext:y,status:N||I.UNREAD,timestamp:U(c||0),toType:2==m?"roster":"group"};return _&&(O.attach=_),E&&(O.config=E),O},x=function(){var e=wx.getStorageSync("key_user_id");if(e)return+e},L=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(void 0!==t&&void 0!==e){var o=e;if(n&&(o=x()+"_"+e),0<r&&(o=o+"_"+r%31),"string"!=typeof t){r=Array.isArray(t)?{data:t}:t;try{var i=JSON.stringify(r);i&&wx.setStorageSync(o,i)}catch(e){c.error("stringify error:",e,o,t)}}else wx.setStorageSync(o,t)}else c.error("localstorage save error:",e,t)},j=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(void 0!==e){var r=e;if(t&&(r=x()+"_"+e),0<n&&(r=r+"_"+n%31),r=wx.getStorageSync(r)){var o=r;try{o=JSON.parse(r)}catch(e){}return(o=k(o)).data||o}}else c.error("localstorage get error:",e)},G=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=e;t&&(r=x()+"_"+e),0<=n&&(r=r+"_"+n%31),wx.removeStorageSync(r)},B=function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<31;n++)G(e,t,n)},V={saveJoinedGroups:function(e){if(e){var t=(e=Array.isArray(e)?e:[e]).map((function(e){return e.group_id||e})),n=j("key_group_lists")||[],r=Array.from(new Set(t.concat(n)));L("key_group_lists",r)}},removeGroup:function(e){var t=j("key_group_lists")||[],n=t.findIndex((function(t){return t===e}));0<=n&&(t.splice(n,1),L("key_group_lists",t))},getJoinedGroups:function(){return j("key_group_lists")},saveGroupInfo:function(e){Array.isArray(e)||(e=[e]);var t=j("key_group_infos")||{};e.forEach((function(e){var n={},r=e.group_id;Object.keys(e).forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),t[r]=t[r]||{},Object.assign(t[r],n)})),L("key_group_infos",t)},getGroupInfo:function(e){var t=j("key_group_infos")[e]||{};return Object.assign(t,{group_id:e})},getGroupInfoList:function(){var e=V.getJoinedGroups()||[],t=V.getAllGroupInfos()||{},n=[];return e.forEach((function(e){var r=t[e]||{};n.push(Object.assign({},r,{group_id:e}))})),n},getAllGroupInfos:function(){return j("key_group_infos")||{}},saveGroupMembers:function(e,t,n){Array.isArray(t)||(t=[t]);var r=j("key_group_members")||{},o=r[e]||[];if(n)return r[e]=t,void L("key_group_members",r);t.forEach((function(e){o.findIndex((function(t){return t===e}))<0&&o.push(e)})),r[e]=o},removeGroupMembers:function(e,t){var n=(j("key_group_members")||{})[e]||[];t.forEach((function(e){var t=n.findIndex((function(t){return t===e}));0<=t&&n.splice(t,1)})),L("key_group_members",n)},getGroupMembers:function(e){return(j("key_group_members")||{})[e]||[]},clear:function(){G("key_group_infos"),G("key_group_members"),G("key_group_lists")}},F=V,Q=function(){var e=j("key_user_id",!1);if(e)return+e},q=function(){G("key_user_id")},K=function(){G("key_user_token")},J=function(){G("key_user_aes_key")},W=function(){G("key_user_device_sn")},H={saveToken:function(e){return L("key_user_token",e)},getToken:function(){return j("key_user_token")},deleteToken:K,getAesKey:function(){return j("key_user_aes_key")},saveAesKey:function(e){return L("key_user_aes_key",e)},deleteAesKey:J,saveDeviceSN:function(e){return L("key_user_device_sn",e)},getDeviceSN:function(){var e=j("key_user_device_sn");return+(e=e||999999999+Math.floor(214e4*Math.random())+"")},deleteDeviceSN:W,saveUid:function(e){if(!e)throw c.error("uid error:",e),new Error("uid is error ...");L("key_user_id",e+"",!1)},getUid:Q,removeUid:q,getDeviceGuid:function(){if(!Q())return"";var e=j("key_user_device_guid");return e||(e=Q()+"_"+Math.floor(2147483648*Math.random()),L("key_user_device_guid",e)),e},saveProfile:function(e){return L("key_user_profile",e)},getProfile:function(){return j("key_user_profile")},clear:function(){W(),J(),K(),q()},saveAppid:function(e){if(!e)throw c.error("Invalid appid :",e),new Error("Invalid appid ...");L("key_app_id",e+"",!1)},getAppid:function(){return j("key_app_id",!1)}},Y={},z=function(e){return void 0===Y[e]&&(Y[e]=[]),Y[e]},X=function(e,t){var n=z(e).findIndex((function(e){return e.toString()===t.toString()}));-1<n&&z(e).splice(n,1),z(e).push(t)},$=function(e,t){var n=z(e).findIndex((function(e){return e.toString()===t.toString()}));0<=n&&Y[e].splice(n,1)},Z=function(e,t){z(e).forEach((function(e){e(t)}))},ee={saveRecent:function(e){if(!function(){var t=e.ext,n={};try{n=JSON.parse(t)}catch(t){}return void 0!==n.input_status&&(n.input_status,!0)}()){var t=e.from,n=e.to,r=e.type,o=e.toType,i=e.attach,s=e.ext,a=e.timestamp,u=e.content;if(u||i){"text"!=r&&(u=r);var c=M(n),f=H.getUid();c===f&&(c=M(t));var d=j("key_recent_store")||[],l=d.findIndex((function(e){return e.type===o&&e.id===c}));-1<l&&d.splice(l,1),d.unshift({type:o,id:c,content:u,ext:s,timestamp:a}),L("key_recent_store",d),Z("recentlistUpdate")}else s&&s.typing&&Z("onInputStatusMessage",{from:t,to:n,ext:s})}},saveUnreadRecent:function(e,t){e.forEach((function(e){var n=t,r=j("key_recent_store")||[],o="",i="",s=r.findIndex((function(t){return t.type===n&&t.id===e}));-1<s&&(o=r[s].content,i=r[s].timestamp,r.splice(s,1)),r.unshift({type:n,id:e,content:o,timestamp:i}),L("key_recent_store",r)})),Z("recentlistUpdate")},getRecents:function(){var e=j("key_recent_store")||[],t=e.filter((function(e){return"roster"==e.type})).map((function(e){return e.id}));return Z("imGetRecent",t),e},getRecentById:function(e){var t=j("key_recent_store")||[],n=t.findIndex((function(t){return t.id+""==e+""}));if(n<0)return{idx:n};var r=t[n].type;return{idx:n,id:e,type:r}},deleteRecentById:function(e){if(!((e=ee.getRecentById(e).idx)<0)){var t=j("key_recent_store")||[];t.splice(e,1),L("key_recent_store",t)}},clear:function(){G("key_recent_store")}},te=ee,ne=function(e){if(!(t=e.payload))return!1;var t,n=t,r=(e=n.type,n.operation);return!(!(t=void 0===r?{}:r)||e!==_.OPER||(t=t.type)!==E.READ_ACK&&t!=E.READ_ALL)},re=function(e,t){var n=D(t.id);if(0===e.length)e.push(t);else{var r=e[0],o=e[e.length-1];if(-1===n.comp(D(r.id)))e.unshift(t);else if(1===n.comp(D(o.id)))e.push(t);else{for(var i=0,s=0;i<e.length;){var a=e[i],u=n.comp(D(a.id));if(0===u&&(s=1),1!==u)break;i++}e.splice(i,s,t)}}return e},oe={saveSendingRosterMessage:function(e){var t=j("key_roster_sending_message")||[];t.push(e),100<(r=t.length)&&t.splice(0,r-100),L("key_roster_sending_message",t);var n=e,r=n.to;e=n.id,Z("onSendingMessageStatusChanged",{status:"sending",uid:r.uid,mid:e})},dealSendedRosterMessage:function(e){var t=e.client_mid,n=e.server_mid,r=j("key_roster_sending_message")||[];if(n){var o=r.findIndex((function(e){return M(e.id)===M(t)}));if(-1<o){var i=r[o];i.id=n;var s=P(i);s.status=I.UNREAD,oe.saveRosterMessage(s),s.toType="roster",te.saveRecent(s),r.splice(o,1),L("key_roster_sending_message",r),Z("onRosterMessage",s),ne(s)||Z("onSendingMessageStatusChanged",{status:"sent",mid:M(t)})}}else{c.log("===================== there is something error:=============="),c.log(e);var a=r.findIndex((function(e){return M(e.id)===M(t)}));-1<a&&(j("key_roster_sending_message")||[]).splice(a,1)}},saveRosterMessage:function(e){var t=e.from,n=e.to,r=e.type;if("command"!=r&&"forward"!=r){r=M(t),t=M(H.getUid()),n=M(n);var o=j("key_roster_message_store",!0,r=r===t?n:r)||{},i=o[r]||[];re(i,e),100<i.length?o[r]=i.slice(i.length-100):o[r]=i,L("key_roster_message_store",o,!0,r)}},getRosterMessage:function(e){return(j("key_roster_message_store",!0,e)||{})[e]||[]},saveFormatedRosterMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=j("key_roster_message_store",!0,e)||{};n[e]=t,L("key_roster_message_store",n,!0,e)},getRosterUnreadMessageIdsByRosterid:function(e){var t=(j("key_roster_message_store",!0,e)||{})[e]||[],n=[];return t.forEach((function(e){var t=e,r=t.status,o=void 0===r?I.READ:r;e=t.id,o==I.UNREAD&&n.push(e)})),n},deleteRosterMessageByRosterId:function(e){var t=j("key_roster_message_store",!0,e)||{};t[e]&&delete t[e],L("key_roster_message_store",t,!0,e)},deleteSingleRosterMessage:function(e,t){var n=j("key_roster_message_store",!0,e)||{},r=U(t),o=n[e]||[],i=o.findIndex((function(e){return U(e.id)===r}));-1<i&&(o.splice(i,1),n[e]=o,L("key_roster_message_store",n,!0,e))},saveSendingGroupMessage:function(e){var t=j("key_group_sending_message")||[];t.push(e),100<(r=t.length)&&t.splice(0,r-100),L("key_group_sending_message",t);var n=e,r=n.to;e=n.id,Z("onSendingMessageStatusChanged",{status:"sending",uid:r.uid,mid:e})},dealSendedGroupMessage:function(e){var t=e.client_mid,n=e.server_mid,r=j("key_group_sending_message")||[],o=r.findIndex((function(e){return M(e.id)===M(t)}));if(-1<o){var i=r[o];i.id=n;var s=P(i);s.status=I.UNREAD,oe.saveGroupMessage(s),s.toType="group",te.saveRecent(s),r.splice(o,1),L("key_group_sending_message",r),Z("onGroupMessage",s),ne(s)||Z("onSendingMessageStatusChanged",{status:"sent",mid:M(t)})}},saveGroupMessage:function(e){var t=e.to,n=e.type;if("command"!=n&&"forward"!=n){var r=M(t),o=j("key_group_message_store",!0,r)||{},i=o[r]||[];re(i,e),100<i.length?o[r]=i.slice(i.length-100):o[r]=i,L("key_group_message_store",o,!0,r)}},getGroupMessage:function(e){return(j("key_group_message_store",!0,e)||{})[e]||[]},saveFormatedGroupMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=j("key_group_message_store",!0,e)||{};n[e]=t,L("key_group_message_store",n,!0,e)},getGroupUnreadMessageIdsByGid:function(e){var t=(j("key_group_message_store",!0,e)||{})[e]||[],n=[];return t.forEach((function(e){var t=e,r=t.r,o=void 0!==r&&r;e=t.id,o||n.push(e)})),n},deleteGroupMessageByGid:function(e){var t=j("key_group_message_store",!0,e)||{};t[e]&&delete t[e],L("key_group_message_store",t,!0,e)},deleteSingleGroupMessage:function(e,t){var n=j("key_group_message_store",!0,e)||{};t=U(t);var r=n[e]||[],o=r.findIndex((function(e){return U(e.id)===t}));-1<o&&(r.splice(o,1),n[e]=r,L("key_group_message_store",n,!0,e))},getUnreadByRosterId:function(e){var t=oe.getRosterMessage(e)||[],n=0,r=H.getUid();return t.forEach((function(e){var t=e,o=t.from;e=t.status,0<(o=M(o))&&o!==r&&e!=I.READ&&n++})),n},getUnreadByGroupId:function(e){var t=oe.getGroupMessage(e)||[],n=0,r=H.getUid();return t.forEach((function(e){var t=e,o=t.from;e=t.status,0<(o=M(o))&&o!==r&&e!=I.READ&&n++})),n},getRosterMessageById:function(e,t){var n=j("key_roster_message_store",!0,e)||{};for(var r in n){var o=n[r];if(o&&o.length){var i=o.find((function(e){return e.id==t}));if(i)return i}}},getGroupMessageById:function(e,t){var n=j("key_group_message_store",!0,e)||{};for(var r in n){var o=n[r];if(o&&o.length){var i=o.find((function(e){return e.id==t}));if(i)return i}}},clear:function(e,t){"group"==t?oe.deleteGroupMessageByGid(e):oe.deleteRosterMessageByRosterId(e)},clearAll:function(){B("key_roster_message_store"),B("key_group_message_store")}},ie=oe,se=function(e){var t=j("key_notice_store")||[];t.push(e),50<(e=t.length)&&t.splice(0,e-50),L("key_notice_store",t)},ae=function(){return j("key_notice_store")||[]},ue={saveRosterList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(e=Array.isArray(e)?e:[e]).map((function(e){return e.roster_user_id||e.user_id||e})),n=ue.getRosterList()||[],r=Array.isArray(n)?Array.from(new Set(n.concat(t))):t;L("key_roster_lists",r),ue.saveRosterInfo(e)},getRosterList:function(){return j("key_roster_lists")},getRosterInfoList:function(){var e=ue.getRosterList()||[],t=ue.getAllRosterInfos()||{},n=[];return e.forEach((function(e){var r=t[e]||{};n.push(Object.assign({},r,{user_id:e}))})),n},removeRoster:function(e){var t=ue.getRosterList(),n=t.indexOf(e);0<=n&&t.splice(n,1),L("key_roster_lists",t)},removeRosterList:function(){return G("key_roster_lists")},saveRosterInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(e)||(e=[e]);var t=ue.getAllRosterInfos()||{};e.forEach((function(e){var n=e.user_id,r={};Object.keys(e).forEach((function(t){var n=e[t];void 0!==n&&(r[t]=n)})),n&&(t[n]=t[n]||{},Object.assign(t[n],r))})),L("key_roster_infos",t)},getRosterInfo:function(e){var t=(j("key_roster_infos")||{})[e];return t&&Object.assign(t,{user_id:e})},getAllRosterInfos:function(){return j("key_roster_infos")},clear:function(){G("key_roster_infos"),G("key_roster_lists")}},ce=ue,fe=(s=r(14),r.n(s)),de={errTimer:null,errCount:0},le="";X("refresh_ratel",(function(e){e&&(le=e)}));var pe=["app_dns","app/captcha/image","app/captcha/sms","app/captcha/sms_web","app/user/info_pwd","app/wechat_login","mobile_bind_with_sign","qr_code","qr_login","token/id","token/user","user/register"],he=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};c.log("========request=============",t,n,r,o,i);var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return t.forEach((function(t){if("string"==typeof t&&void 0===e[t]&&n.push(t+" can not be null.."),Array.isArray(t)){var r=!1;t.forEach((function(t){void 0!==e[t]&&(r=!0)})),r||n.push(t.join("\u3001")+" can not be all null")}})),n}(r,o);if(a.length){var u=a.join(",");return Promise.reject(new Error(u))}var f={};"get"===(o=n.toLowerCase())||"post"===o&&i?(0<t.indexOf("?")?t+="&":t+="?",t+=fe.a.stringify(r)):((l=r).group_id&&(l.group_id=+l.group_id),l.user_id&&(l.user_id=+l.user_id),l.new_owner&&(l.new_owner=+l.new_owner),l.apply_approval&&(l.apply_approval=+l.apply_approval),l.duration&&(l.duration=+l.duration),l.limit&&(l.limit=+l.limit),l.version&&(l.version=+l.version),l.announcement_id&&(l.announcement_id=+l.announcement_id),l.user_list&&Array.isArray(l.user_list)&&(l.user_list=l.user_list.map((function(e){return+e}))),l.user_list&&Array.isArray(l.user_list)&&(l.user_list=l.user_list.map((function(e){return+e}))),l.file_list&&Array.isArray(l.file_list)&&(l.file_list=l.file_list.map((function(e){return+e}))),f=l);var d=s.headers||function(e){var t=H.getToken(),n=H.getAppid();if(function(e){var t=!0;return pe.forEach((function(n){-1<e.indexOf(n)&&(t=!1)})),t}(e)&&!t)throw Z("flooNotice",{category:"action",desc:"relogin"}),new Error("you should login ...");return{"access-token":t,app_id:n}}(t);if(t.indexOf("http")<0&&(t=le+t),s.operation&&"upload_file"===s.operation)return new Promise((function(n,o){var i={url:t,header:d,filePath:r.filePath,formData:r.formData,name:r.name,success:function(t){ge(),200===t.statusCode?n(t.tempFilePath):(e("error","Upload file error: ",t," at libs/qnuniapp-im.js:1"),o(t))},fail:function(e){ye(),o(e)}};wx.uploadFile(i)}));if(s.operation&&"download_file"===s.operation)return new Promise((function(n,r){var o={url:t,header:d,success:function(t){ge(),200===t.statusCode?n(t.tempFilePath):(e("error","Download file error: ",t," at libs/qnuniapp-im.js:1"),r(t))},fail:function(e){ye(),r(e)}};wx.downloadFile(o)}));var l=s.content_type||"application/json";return d=Object.assign(d,{"Content-Type":l}),new Promise((function(e,r){var o={url:t,data:f,header:d,method:n,dataType:"json",success:function(n){ge();var o=n.data,i=void 0===o?{}:o;if(s.headers&&0!==Object.keys(s.headers).length)return"boolean"==typeof i.data&&i.data||"string"==typeof i.Status&&"OK"===i.Status?void 0:Promise.reject({config:s,url:t});var a=i.data,u=i.code;n=i.message,200===u?(c.log("======request success, ",t,a),e(a)):(402===u&&Z("flooNotice",{category:"action",desc:"relogin"}),c.req(t+""==""+n),r({message:n,url:t,data:i}))},fail:function(e){ye(),r(e)},complete:function(){}};wx.request(o)}))};function ge(){de.errTimer&&clearTimeout(de.errTimer),de.errTimer=null,de.errCount=0}function ye(){de.errTimer&&clearTimeout(de.errTimer),de.errTimer=null,de.errCount=de.errCount+1,5<=de.errCount?(de.errCount=0,Z("ratelError")):de.errTimer=setTimeout((function(){de.errCount=0}),18e5)}var ve=function(e,t){return he(e,"get",t,["app_id"],!0)},me=function(e){return he("/token/user","post",e,[["mobile","name"],"password"])},_e=function(e){return he("/token/id","post",e,["user_id","password"])},Ee=function(e){return he("/user/register/v2","post",e,["username","password"])},be=function(e){return he("/app/user/mobile_bind","post",e,["captcha","mobile"])},Ne=function(e){return he("/app/user/mobile_update","post",e,["mobile"])},Oe=function(e){return he("/app/captcha/sms","get",e,["mobile"],!0)},Ae=function(e){return he("/app/user/name_check","get",e,["username"],!0)},we=function(e){return he("/app/user/mobile_bind","post",e,["captcha","mobile"])},Se=function(e){return he("/app/user/mobile_bind_with_sign","post",e,["sign","mobile"])},Te=function(e){return he("/app/user/info_pwd","get",e,["captcha","mobile"],!0)},Re=function(e){return he("/app/captcha/image","post",e,[])},Ie=function(e){return he("/app/captcha/sms_web","get",e,["captcha","image_id","mobile"],!0)},Ce=function(e){return he("/roster/accept","post",e,["user_id"],!0)},ke=function(e){return he("/roster/apply","post",e,["user_id","alias"])},Me=function(e){return he("/roster/decline","post",e,["user_id"])},De=function(e){return he("/roster/delete","post",e,["user_id"],!0)},Ue=function(e){return he("/roster/ext","post",e,["user_id","ext"])},Pe=function(e){return he("/roster/id","get",e,["user_id"])},xe=function(e){return he("/roster/list","get",e,[])},Le=function(e){return he("/roster/list","post",e,["list"])},je=function(e){return he("/roster/name","get",e,["username"])},Ge=function(e){return he("/roster/apply/list","get",e,["cursor"],!0)},Be=function(e){return he("/roster/blocked_list","get",e,[""],!0)},Ve=function(e){return he("/roster/block","post",e,["user_id"],!0)},Fe=function(e){return he("/roster/unblock","post",e,["user_id"],!0)},Qe=function(e){return he("/group/admin/add","post",e,["group_id","user_list"])},qe=function(e){return he("/group/admin_list","get",e,["group_id"],!0)},Ke=function(e){return he("/group/admin/remove","post",e,["group_id","user_list"])},Je=function(e){return he("/group/announcement","get",e,["announcement_id","group_id"])},We=function(e){return he("/group/announcement/delete","post",e,["announcement_id","group_id"],!0)},He=function(e){return he("/group/announcement/edit","post",e,["group_id","content","title"])},Ye=function(e){return he("/group/announcement/list","get",e,["group_id"],!0)},ze=function(e){return he("/group/create","post",e,["name"])},Xe=function(e){return he("/group/destroy","post",e,["group_id"],!0)},$e=function(e){return he("/group/info","get",e,["group_id"])},Ze=function(e){return he("/group/info/avatar","post",e,["group_id","value"])},et=function(e){return he("/group/info/description","post",e,["group_id","value"])},tt=function(e){return he("/group/info/name","post",e,["group_id","value"])},nt=function(e){return he("/group/member_list","get",e,["group_id"])},rt=function(e){return he("/group/msg/mute_mode","post",e,["group_id","msg_mute_mode"])},ot=function(e){return he("/group/msg/not_disturb","post",e,["group_id","value"])},it=function(){return he("/group/public_list","get",{},[])},st=function(e){return he("/group/banned_list","get",e,["group_id"])},at=function(e){return he("/group/ban","post",e,["group_id","duration","user_list"])},ut=function(e){return he("/group/unban","post",e,["group_id","user_list"])},ct=function(e){return he("/group/settings","get",e,["group_id"])},ft=function(e){return he("/group/settings/allow_member_invitation","post",e,["group_id","value"])},dt=function(e){return he("/group/settings/allow_member_modify","post",e,["group_id","value"])},lt=function(e){return he("/group/settings/enable_read_ack","post",e,["group_id","value"])},pt=function(e){return he("/group/settings/history_visible","post",e,["group_id","value"])},ht=function(e){return he("/group/settings/require_admin_approval","post",e,["group_id","apply_approval"])},gt=function(e){return he("/group/transfer","post",e,["group_id","new_owner"])},yt=function(e){return he("/group/user_joined","get",e)},vt=function(e){return he("/group/apply","post",e,["group_id"])},mt=function(e){return he("/group/apply/handle","post",e,["approval","group_id","user_id"])},_t=function(e){return he("/group/blocked_list","get",e,["group_id"])},Et=function(e){return he("/group/block","post",e,["user_list","group_id"])},bt=function(e){return he("/group/unblock","post",e,["user_list","group_id"])},Nt=function(e){return he("/group/kick","post",e,["user_list","group_id"])},Ot=function(e){return he("/group/invite","post",e,["user_list","group_id"])},At=function(e){return he("/group/invite/handle","post",e,["approval","user_id","group_id"])},wt=function(e){return he("/group/info/batch","post",e,["group_list"])},St=function(e){return he("/group/members/display_name","post",e,["group_id","user_list"])},Tt=function(e){return he("/group/leave","post",e,["group_id"],!0)},Rt=function(e){return he("/group/display_name","post",e,["group_id","value"])},It=function(e){return he("/group/application_list","post",e,["group_list"])},Ct=function(){return he("/group/invitation_list","get",{},[])},kt=function(e){return he("/group/file/list","get",e,["group_id"],!0)},Mt=function(e){return he("/group/file/delete","post",e,["file_list","group_id"])},Dt=function(e){return he("/group/file/upload","post",e,["name","size","url","group_id"])},Ut=function(e){return he("/user/authmode","post",e,["value"],!0)},Pt=function(e){return he("/user/avatar","post",e,["avatar"])},xt=function(e){return he("/user/mobile","post",e,["mobile"],!0)},Lt=function(e){return he("/user/nickname","post",e,["nick_name"],!0)},jt=function(){return he("/user/profile","get",{},[])},Gt=function(e){return he("/user/profile","post",e,[])},Bt=function(e){return he("/user/push","post",e,["value"])},Vt=function(e){return he("/user/push/detail","post",e,["value"])},Ft=function(e){return he("/user/push/limit","post",e,["no_push_end_hour","no_push_start_hour"])},Qt=function(e){return he("/user/push/nickname","post",e,["value"])},qt=function(){return he("/user/settings","get",{},[])},Kt=function(e){return he("/user/settings","post",e,["user_id"])},Jt=function(e){return he("/user/sounds","post",e,["value"])},Wt=function(e){return he("/user/vibratory","post",e,["value"])},Ht=function(e){return he("/user/token/bind","post",e,["device_sn","device_token","notifier_name"])},Yt=function(e){return he("/user/token/unbind","post",e,[],!0)},zt=function(e){return he("/file/upload/forward","get",e,["file_sign","access-token","to_id","to_type"],!0)},Xt=function(e,t,n){return he(e,"post",t,[],!1,n)},$t=function(e){return he("/file/upload/avatar/user","get",e,[],!0)},Zt=function(e){return he("/file/upload/avatar/group","get",e,["group_id"],!0)},en=function(e){return he("/file/upload/chat","get",e,["file_type","to_id","to_type"],!0)},tn=function(e,t,n){return he(e,"get",t,[],!0,n)},nn=function(e){return he("/app/qr_code","get",e,[])},rn=function(e){return he("/app/qr_login","get",e,["qr_code"])},on=function(e){return he("/app/qrcode/group_sign","get",e,["group_id"],!0)},sn=function(e){return he("/app/qrcode/group_invite","get",e,["qr_info"],!0)},an=function(e){return he("/user/bind_openid","get",e,["open_id"],!0)},un=function(e){return he("/app/wechat_login","get",e,["code"],!0)},cn=function(e){return he("/app/support_staff","get",e,[],!0)},fn=function(){return he("/app/wechat/unbind","post")},dn=function(){return he("/app/wechat/is_bind","get")},ln=function(e){return he("/app/wechat/bind","post",e,["open_id","type"])},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.uid=e.uid||0,e=void 0===e.deviceSN?H.getDeviceSN():e.deviceSN,this.deviceSN=e};pn.prototype.setUid=function(e){this.uid=e},pn.prototype.setDeviceSN=function(e){this.deviceSN=e};var hn=pn;function gn(e){var t=e.operation,n=void 0===t?{type:E.UNKNOWN,mid:0}:t;void 0!==(e=Object.assign({},{type:_.NORMAL,ctype:b.TEXT,content:"",operation:n},e)).type&&(this.type=e.type),void 0!==e.from&&(this.from=e.from),void 0!==e.to&&(this.to=e.to),void 0!==e.content&&(this.content=e.content),void 0!==e.ctype&&(this.ctype=e.ctype),void 0!==e.operation&&(this.operation=e.operation),void 0!==e.config&&(this.config=e.config),void 0!==e.attachment&&(this.attachment=e.attachment),void 0!==e.ext&&(this.ext=e.ext),void 0!==e.qos&&(this.qos=e.qos),void 0!==e.sender_name&&(this.sender_name=e.sender_name),void 0!==e.is_system&&(this.is_system=e.is_system),void 0!==e.priority&&(this.priority=e.priority)}gn.prototype={setType:function(e){this.type=e},setFrom:function(e){this.from=e},setTo:function(e){this.to=e},setContent:function(e){this.content=e},setCtype:function(e){this.ctype=e},setOperation:function(e){this.operation=e},setConfig:function(e){this.config=e},setAttachment:function(e){this.attachment=e},setExt:function(e){this.ext=e},setQos:function(e){this.qos=e},setSendername:function(e){this.sender_name=e},setIssystem:function(e){this.is_system=e},setPriority:function(e){this.priority=e}};var yn=gn;function vn(e){void 0!==(e=Object.assign({},{vsn:l.XSYNC_V1,compress_method:h.NONE},e)).vsn&&(this.vsn=e.vsn),void 0!==e.compress_method&&(this.compress_method=e.compress_method),void 0!==e.command&&(this.command=e.command),void 0!==e.payload&&(this.payload=e.payload),void 0!==e.encrypt_method&&(this.encrypt_method=e.encrypt_method),void 0!==e.encrypt_key&&(this.encrypt_key=e.encrypt_key),void 0!==e.check_sum&&(this.check_sum=e.check_sum),void 0!==e.tag&&(this.tag=e.tag)}vn.prototype={setVsn:function(e){this.vsn=e},setCompressmethod:function(e){this.compress_method=e},setCommond:function(e){this.command=e},setPayload:function(e){this.payload=e},setEncryptmethod:function(e){this.encrypt_method=e},setEncryptkey:function(e){this.encrypt_key=e},setChecksum:function(e){this.check_sum=e},setTag:function(e){this.tag=e}};var mn=vn;function _n(e){void 0!==(e=Object.assign({},{encrypt_method:v.ENCRYPT_NONE,os_type:y.WEB},e)).status&&(this.status=e.status),void 0!==e.xid&&(this.xid=e.xid),void 0!==e.encrypt_method&&(this.encrypt_method=e.encrypt_method),void 0!==e.encrypt_key&&(this.encrypt_key=e.encrypt_key),void 0!==e.password&&(this.password=e.password),void 0!==e.token&&(this.token=e.token),void 0!==e.os_type&&(this.os_type=e.os_type),void 0!==e.sdk_vsn&&(this.sdk_vsn=e.sdk_vsn),void 0!==e.is_manual_login&&(this.is_manual_login=e.is_manual_login),void 0!==e.device_guid&&(this.device_guid=e.device_guid),void 0!==e.device_notifier&&(this.device_notifier=e.device_notifier),void 0!==e.device_token&&(this.device_token=e.device_token),void 0!==e.device_info&&(this.device_info=e.device_info),void 0!==e.last_login_time&&(this.last_login_time=e.last_login_time)}_n.prototype={setStatus:function(e){this.status=e},setXid:function(e){this.xid=e},setEncryptmethod:function(e){this.encrypt_method=e},setEncryptkey:function(e){this.encrypt_key=e},setPassword:function(e){this.password=e},setToken:function(e){this.token=e},setOstype:function(e){this.os_type=e},setSdkvsn:function(e){this.sdk_vsn=e},setIsmanuallogin:function(e){this.is_manual_login=e},setDeviceguid:function(e){this.device_guid=e},setDevicenotifier:function(e){this.device_notifier=e},setDevicetoken:function(e){this.device_token=e},setDeviceinfo:function(e){this.device_info=e},setLastlogintime:function(e){this.last_login_time=e}};var En=_n;function bn(e){void 0!==(e=Object.assign({},e)).xid&&(this.xid=e.xid),void 0!==e.key&&(this.key=e.key),void 0!==e.meta&&(this.meta=e.meta),void 0!==e.is_full_sync&&(this.is_full_sync=e.is_full_sync),void 0!==e.full_sync_num&&(this.full_sync_num=e.full_sync_num)}bn.prototype={setXid:function(e){this.xid=e},setKey:function(e){this.key=e},setMeta:function(e){this.meta=e},setIsfullsync:function(e){this.is_full_sync=e},setFullsyncnum:function(e){this.full_sync_num=e}};var Nn=bn;function On(e){void 0!==(e=Object.assign({},e)).id&&(this.id=e.id),void 0!==e.from&&(this.from=e.from),void 0!==e.to&&(this.to=e.to),void 0!==e.timestamp&&(this.timestamp=e.timestamp),void 0!==e.ns&&(this.ns=e.ns),void 0!==e.payload&&(this.payload=e.payload)}On.prototype={setId:function(e){this.id=e},setFrom:function(e){this.from=e},setTo:function(e){this.to=e},setTimestamp:function(e){this.timestamp=e},setNs:function(e){this.ns=e},setPayload:function(e){this.payload=e}};var An=On;function wn(e){void 0!==e.type&&(this.type=e.type),void 0!==e.operation&&(this.operation=e.operation)}wn.prototype={setType:function(e){this.type=e},setOperation:function(e){this.operation=e}};var Sn=wn,Tn=H.getDeviceSN(),Rn=H.getDeviceGuid();X("userKicked",(function(){c.log("user is kicked ... will new devicesn and guid, old Guid",Rn),Tn=0,Rn=999999999+Math.floor(214e4*Math.random())+"",c.log("new Guid",Rn)})),X("temporary_deviceSN",(function(e){Tn=e}));var In=function(e){var t=new mn;t.setCommond(p.SYNC);var n=new Nn;return e.xid&&n.setXid(e.xid),e.next_key&&n.setKey(e.next_key),t.setPayload(n),t},Cn=function(e){var t=e,n=t.gid,r=t.content,o=t.type,i=void 0===o?"text":o,s=t.attachment,a=t.ext,u=t.priority;e=Object.keys(b).indexOf(i.toUpperCase());var c=new hn({uid:+H.getUid(),deviceSN:Tn}),f=new hn({uid:n,deviceSN:0}),d=new mn;d.setCommond(p.SYNC);var l=new Nn,h=new yn({from:c,to:f,content:r,ctype:e,type:_.GROUPCHAT,ext:a});return 0<u&&(h.priority=u),0<e&&s&&(h.attachment=JSON.stringify(s)),e=new An({id:(new Date).getTime(),from:c,to:f,payload:h,ns:m.MESSAGE,timestamp:(new Date).getTime()}),l.setMeta(e),d.setPayload(l),d},kn=function(e){var t=e,n=t.uid,r=t.content,o=t.type,i=void 0===o?"text":o,s=t.ext,a=t.attachment;Z("imSendRosterMessage",e),e=Object.keys(b).indexOf(i.toUpperCase());var u=new hn({uid:+H.getUid(),deviceSN:Tn}),c=new hn({uid:+n,deviceSN:0}),f=new mn;f.setCommond(p.SYNC);var d=new Nn,l=new yn({from:u,to:c,content:r,ctype:e,type:_.CHAT,ext:s});return 0<e&&a&&(l.attachment=JSON.stringify(a)),e=new An({id:(new Date).getTime(),from:u,to:c,payload:l,ns:m.MESSAGE,timestamp:(new Date).getTime()}),d.setMeta(e),f.setPayload(d),f},Mn=function(e,t){t=D(t);var n=new mn;n.setCommond(p.SYNC);var r=new hn({uid:H.getUid(),deviceSN:Tn}),o=new hn({uid:M(e),deviceSN:0}),i=new Nn,s=new yn({from:r,to:o,ctype:b.COMMAND,type:_.OPER,operation:{type:E.READ_ACK,mid:t}}),a=new An({id:(new Date).getTime()+Math.floor(256*Math.random()),from:r,to:o,payload:s,ns:m.MESSAGE});return i.setMeta(a),n.setPayload(i),n},Dn=function(e,t){t=D(t);var n=new mn;n.setCommond(p.SYNC);var r=new hn({uid:H.getUid(),deviceSN:Tn}),o=new hn({uid:M(e),deviceSN:0}),i=new Nn,s=new yn({ctype:b.COMMAND,type:_.OPER,operation:{type:E.RECALL,mid:t,xid:o}}),a=new An({id:parseInt((new Date).getTime()+""+Math.floor(256*Math.random())),from:r,to:o,payload:s,ns:m.MESSAGE});return i.setMeta(a),n.setPayload(i),n},Un=function(e,t){var n=new mn;n.setCommond(p.SYNC);var r=new hn({uid:H.getUid(),deviceSN:Tn}),o=new hn({uid:M(e),deviceSN:0}),i=new Nn,s=new yn({from:r,to:r,ctype:b.COMMAND,type:_.OPER,operation:{type:E.READ_ALL,xid:o,mid:t}}),a=new An({id:parseInt((new Date).getTime()+""+Math.floor(256*Math.random())),from:r,to:r,payload:s,ns:m.MESSAGE});return i.setMeta(a),n.setPayload(i),n},Pn=function(e,t,n){var r=n,o=r.content,i=r.attach;return n=r.type,e?kn({uid:e,content:o,type:n,attachment:i}):Cn({gid:t,content:o,type:n,attachment:i})},xn={},Ln=!1,jn=function(e){var t=e.status,n=void 0===t?{}:t,r=n.code,o=n.reason;return r===g.OK||void 0===n.code||(r!==g.INVALID_TOKEN&&r!==g.UNAUTHORIZED||Z("flooNotice",{category:"action",desc:"relogin"}),r!==g.USER_FROZEN&&r!==g.INVALID_LICENSE&&r!==g.LICENSE_LIMIT&&r!==g.APP_FROZEN||Z("flooNotice",{category:"action",desc:"relogin_manually"}),r===g.USER_BANNED?Z("flooError",{category:"USER_BANNED",desc:"\u7528\u6237\u88ab\u7981\u8a00"}):r===g.USER_FROZEN?Z("flooError",{category:"USER_FROZEN",desc:"\u7528\u6237\u88ab\u51bb\u7ed3\uff0c\u8bf7\u8054\u7cfbApp\u7ba1\u7406\u5458\u3002"}):r===g.APP_FROZEN?Z("flooError",{category:"APP_FROZEN",desc:"APP \u88ab\u51bb\u7ed3\uff0c\u8bf7\u767b\u9646\u7f8e\u4fe1\u62d3\u6251\u63a7\u5236\u53f0\u67e5\u770b\u8be6\u60c5\u3002"}):r===g.INVALID_LICENSE?Z("flooError",{category:"LICENSE",desc:"\u65e0\u6548 LICENSE\uff0c\u8bf7\u786e\u8ba4\u670d\u52a1\u5df2\u6309\u65f6\u4ed8\u8d39\u3002"}):r===g.LICENSE_LIMIT?Z("flooError",{category:"LICENSE",desc:"\u8d85\u51fa LICENSE \u7528\u6237\u6570\u9650\u5236\uff0c\u8bf7\u8d2d\u4e70\u66f4\u9ad8\u89c4\u683c\u670d\u52a1\u3002"}):Z("flooError",{category:r,desc:o}),(e=e.client_mid)&&Z("onSendingMessageStatusChanged",{status:"failed",mid:M(e)}),c.error("ret error ......code:",r,"...reason:",o),!1)},Gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){var t=e.ns;t===m.UNKNOWN&&c.log("received unknown message ...",e),t===m.MESSAGE&&Vn(e),t===m.GROUP_NOTICE&&Fn(e),t===m.ROSTER_NOTICE&&Qn(e),t===m.USER_NOTICE&&qn(e),t===m.CONVERSATION&&Bn(e)}))},Bn=function(e){var t=e.payload,n=o=void 0===t?{}:t,r=n.type,o=n.operation;if(r===T.OPER)if(o.op_type==R.DELETE||o.op_type==R.DELETE_EVERYWHERE){var i=o.xid;Z("deleteConveration",{id:i.uid,source:"other_operation"})}else c.log("received unknown conversation operation: ",o);else c.log("received unknown conversation: ",e)},Vn=function(e){var t=e.payload,n=o=void 0===t?{}:t,r=n.type,o=n.operation;r===_.NORMAL&&Z("messageNormal",e),r===_.CHAT&&Z("imRosterMessage",e),r===_.GROUPCHAT&&Z("imGroupMessage",e),r===_.OPER&&(o.type===E.UNKNOWN&&c.log("received unknown operation: ",e),e.isReceived=!0,Z("onActionMessage",e))},Fn=function(e){var t,n=e.payload;(t=(t=void 0===n?{}:n).type)===O.UNKNOWN&&c.log("received unknown groupnotice: ",e),t===O.PRESENCE&&Z("imGroupPresence",e),t===O.ABSENCE&&Z("imGroupAbesence",e),t===O.CREATED&&Z("imGroupCreated",e),t===O.DESTROYED&&Z("imGroupDestoryed",e),t===O.JOINED&&Z("imGroupJoined",e),t===O.APPLYED&&Z("imGroupApplyed",e),t===O.APPLY_ACCEPTED&&Z("imGroupApplyAccepted",e),t===O.APPLY_DECLINED&&Z("imGroupApplyDeclined",e),t===O.INVITED&&Z("imGroupInvited",e),t===O.INVITE_ACCEPTED&&Z("imGroupInvitedAccepted",e),t===O.INVITE_DECLINED&&Z("imGroupInvitedDeclined",e),t===O.KICKED&&Z("imGroupKicked",e),t===O.BANNED&&Z("imGroupBaned",e),t===O.UNBANNED&&Z("imGroupUnbaned",e),t===O.OWNER_ASSIGNED&&Z("imGroupOwnerAssigned",e),t===O.ADMIN_GRANTED&&Z("imGroupAdminGranted",e),t===O.ADMIN_REVOKED&&Z("imGroupAdminRevoked",e),t===O.BLOCKED&&Z("imGroupBlocked",e),t===O.UNBLOCKED&&Z("imGroupUnblocked",e),t===O.MUTED&&Z("imGroupMuted",e),t===O.UNMUTED&&Z("imGroupUnmuted",e),t===O.INFO_UPDATED&&Z("imGroupInfoUpdated",e),t===O.ANNOUNCEMENT_UPDATED&&Z("imGroupAnnouncementUpdated",e)},Qn=function(e){var t,n=e.payload;(t=(t=void 0===n?{}:n).type)===w.UNKNOWN&&c.log("received unknown rosterNotice: ",e),t===w.ADDED&&Z("imRosterAdded",e),t===w.REMOVED&&Z("imRosterRemoved",e),t===w.ACCEPTED&&Z("imRosterAccepted",e),t===w.DECLINED&&Z("imRosterDeclined",e),t===w.BANNED&&Z("imRosterBaned",e),t===w.UNBANNED&&Z("imRosterUnbaned",e),t===w.INFO_UPDATED&&Z("imRosterInfoUpdated",e)},qn=function(e){var t,n=e.payload;(t=(t=void 0===n?{}:n).type)!==S.UNKNOWN&&t!==S.PASSWORD_CHANGED&&t!==S.FROZEN&&t!==S.REMOVED&&t!==S.KICKED_BY_OTHER_DEVICE&&t!==S.DEVICE_REMOVED&&t!==S.CLUSTER_CHANGED||(H.deleteToken(),H.deleteDeviceSN(),Z("flooNotice",{category:"action",desc:"relogin_manually"})),t===S.UNKNOWN&&c.log("received unknown userNotice: ",e),t===S.KICK_BY_SAME_DEVICE&&(Ln=!0,Z("userKicked")),Z("flooNotice",{category:"userNotice",desc:Object.keys(S)[t]})};a=r(0),f=r.n(a),s=r(2),a=r.n(s);var Kn=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.Provision"),Jn=function(e){return Kn.decode(e)},Wn=function(e){return Kn.encode(e).finish()},Hn=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.XID"),Yn=function(e){return Hn.encode(e).finish()};s=r(32),s=r.n(s);var zn=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.MessageBody");s=r(33),s=r.n(s);var Xn=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.GroupNotice");s=r(34),s=r.n(s);var $n=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.RosterNotice");s=r(35),s=r.n(s);var Zn=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.UserNotice");s=r(36),s=r.n(s);var er=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.Info");s=r(37),s=r.n(s);var tr=f.a.Root.fromJSON(s.a).lookupType("im.floo.protobuf.Conversation"),nr=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.Meta"),rr=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.SyncUL"),or=function(e){return rr.decode(e)},ir=function(e){return e.meta&&(e.meta=function(e){var t,n,r=e.ns,o=e.payload;return r===m.MESSAGE&&(e.payload=(n=o,zn.encode(n).finish())),r===m.GROUP_NOTICE&&(e.payload=function(e){e.from=Yn(e.from);var t=[];return(e.to||[]).forEach((function(e){t.push(Yn(e))})),e.to=t,Xn.encode(e).finish()}(o)),r===m.ROSTER_NOTICE&&(e.payload=(n=o,$n.encode(n).finish())),r===m.USER_NOTICE&&(e.payload=(t=o,Zn.encode(t).finish())),r===m.INFO&&(e.payload=(t=o,er.encode(t).finish())),r===m.CONVERSATION&&(e.payload=(o=o,tr.encode(o).finish())),nr.create(e)}(e.meta)),rr.encode(e).finish()},sr=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.UnreadDL"),ar=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.SyncDL"),ur=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.Notice"),cr=f.a.Root.fromJSON(a.a).lookupType("im.floo.protobuf.Frame"),fr=function(e){e=new Uint8Array(e);var t=cr.decode(e),n=t.command,r=t.payload;return n===p.UNREAD?t.payload=(e=r,sr.decode(e)):n===p.SYNC?t.payload=function(e){var t=ar.decode(e),n=t.metas,r=[];return(void 0===n?[]:n).forEach((function(e){var t,n,o,i=e.ns,s=e.payload;i===m.MESSAGE&&(e.payload=(o=s,zn.decode(o))),i===m.GROUP_NOTICE&&(e.payload=(n=s,Xn.decode(n))),i===m.ROSTER_NOTICE&&(e.payload=(n=s,$n.decode(n))),i===m.USER_NOTICE&&(e.payload=(t=s,Zn.decode(t))),i===m.INFO&&(e.payload=(t=s,er.decode(t))),i===m.CONVERSATION&&(e.payload=(s=s,tr.decode(s))),r.push(e)})),t.metas=r,t}(r):n===p.NOTICE?t.payload={xid:function(e){return Hn.decode(e)}(r)}:n===p.PROVISION&&(t.payload=Jn(r)),t},dr=function(e){var t,n=e.payload,r=e.command;return n&&(r===p.UNREAD?e.payload=(t=n,sr.encode(t).finish()):r===p.SYNC?e.payload=ir(n):r===p.NOTICE?e.payload=(t=n,ur.encode(t).finish()):r===p.PROVISION&&(e.payload=Wn(n))),cr.encode(e).finish()};f.a.util.Long=d.a,f.a.configure();var lr=u.encode,pr=u.decode,hr={},gr=0,yr=null,vr="normal",mr=null;X("refresh_fireplace",(function(e){hr=Object.assign({fireplace:e},hr)})),X("loginSuccess",(function(){gr=0,yr&&clearInterval(yr),yr=setInterval((function(){Ar({vsn:0,compress_method:0,command:0})}),5e4)})),X("sendMessage",(function(e){Ar(e)})),X("userKicked",(function(){vr="kick"})),X("reconnect",(function(e){var t=e.reason;c.warn("socket reconnect due to ",t," user status: ",vr),"normal"===vr&&Er()}));var _r=function(){var e=hr.fireplace;c.log("................................. will connect : ",e),Z("flooNotice",{category:"loginMessage",desc:"socket connecting..."}),(mr=wx.connectSocket({url:e,tcpNoDelay:!0,timeout:1e4+2e4*gr,success:function(){c.info("================= Success connect to",e),Z("flooNotice",{category:"loginMessage",desc:"socket connect success..."})},fail:function(t){c.error("================= Failed to connect ",e," error: ",t),Z("reconnect",{reason:"ConnectFail"})}})).onOpen((function(){c.log("=================  socket connected "),Nr()})),mr.onMessage((function(e){Or(e.data)})),mr.onError((function(e){c.error("=================  socket error: ",e),mr.close()})),mr.onClose((function(e){c.error("=================  socket disconnected due to ",e),Z("reconnect",{reason:"closed_by_peer"})}))},Er=function(){5<=gr?(gr=0,Z("fireplaceError")):gr++,br()},br=function(){var e=Math.floor(9e3*Math.random())+1e3;c.error("================= socket will reconnect in ",e," ms (",gr,")"),setTimeout((function(){_r()}),e)},Nr=function(){c.log("=============== sending proversion =========="),Z("flooNotice",{category:"loginMessage",desc:"logining socket service..."}),Z("sendMessage",function(e){var t=new hn({uid:+e.uid,deviceSN:Tn}),n=new En;Rn=Rn||H.getDeviceGuid(),n.setXid(t),n.setToken(e.token),n.setDeviceguid(Rn),n.setSdkvsn("2.0.0"),n.setEncryptmethod(v.AES_CBC_128),n.setEncryptkey(H.getAesKey()),n.setDeviceinfo("Uniapp");var r=new mn;return r.setCommond(p.PROVISION),r.setPayload(n),r}({token:H.getToken(),uid:H.getUid()}))},Or=function(e){e=pr(e=e),c.info("RECV :"+JSON.stringify(C(e))),function(e){var t=e,n=t.command,r=void 0===n?0:n;e=t.payload,r===p.UNREAD&&function(e){var t=e.unread,n=void 0===t?[]:t;Z("imReceivedUnread",n),n.forEach((function(e){var t=e,n=t.xid;0<(e=t.n)&&Z("sendMessage",In({xid:n,next_key:0}))}))}(e),r===p.SYNC&&function(e){if(jn(e)){var t=e.metas,n=void 0===t?[]:t,r=e.xid,o=e.is_full_sync,i=e.client_mid;if(!o&&i&&D(i).gt(0))return Z("receivedSendMessage",i),setTimeout((function(){ie.dealSendedRosterMessage(e),ie.dealSendedGroupMessage(e)}),20);var s=e.next_key;if(0===(i=void 0===s?0:s)||D(i).eq(0)){var a=r.uid;delete xn[(void 0===a?0:a)+""]}o?(n&&n.length&&Gn(n),Z("onReceiveHistoryMsg",{next:i})):(n.length&&Gn(n),0===i||D(i).eq(0)||Z("sendMessage",In({xid:r,next_key:i})))}}(e),r===p.NOTICE&&function e(t){var n=t.xid,r=n.uid,o=void 0===r?0:r;xn[o+""]?setTimeout((function(){xn[o]=!1,e(t)}),3e3):(xn[o+""]=!0,Z("sendMessage",function(e){e.uid=e.uid||0;var t=new mn;t.setCommond(p.SYNC);var n=new Nn;return n.setXid(e),t.setPayload(n),t}(n)))}(e),r===p.PROVISION&&function(e){if(!jn(e))return Z("flooNotice",{category:"loginMessage",desc:"login socket failure ......"}),Z("loginFail","socket_failure");var t=e.xid;e=(e=void 0===t?{}:t).deviceSN,Z("temporary_deviceSN",e),Ln||e&&H.saveDeviceSN(e),Z("flooNotice",{category:"loginMessage",desc:"login socket success....."}),Z("loginSuccess",{}),Z("sendMessage",{vsn:0,compress_method:0,command:0})}(e)}(e)},Ar=function(e){c.info("SEND :"+JSON.stringify(C(e)));var t=lr(e),n=new ArrayBuffer(t.length),r=new Uint8Array(n);t.forEach((function(e,t){r[t]=e})),mr.send({data:n,fail:function(e){e=e.errMsg,c.error("=============== fail to send message, err: ",e),mr.close(),Z("reconnect",{reason:"SendFail"})}})},wr=Object.assign(i,{connect:function(e){hr=e,gr=0,vr="normal",_r()},sendMessage:Ar,disConnect:function(){vr="logout",mr&&mr.close()}}),Sr={asyncGetRosterIdList:function(e){return e?wr.rosterList({}).then((function(e){return ce.saveRosterList(e),e.map((function(e){return e.user_id||e}))})):Promise.resolve(ce.getRosterList())},asyncGetRosterInfo:function(e,t){var n=ce.getRosterInfo(e);return n&&n.username&&!t?Promise.resolve(n):wr.rosterListPost({list:[e]}).then((function(t){return ce.saveRosterInfo(t),Z("onRosterInfoUpdate",[e]),t.length&&t[0]||{}}))},asyncRegester:function(e){return wr.userRegister(e)},asnycGetRosterListDetailByIds:function(e){if(!e||!e.length)return Promise.resolve({});var t=ce.getAllRosterInfos(),n=[];e.forEach((function(e){var r=t[e];r&&r.username||n.push(e)}));var r=Array.from(new Set(n));return r.length?wr.rosterListPost({list:r}).then((function(e){return ce.saveRosterInfo(e),Z("onRosterInfoUpdate",r),e})):Promise.resolve()},asyncGetUserProfile:function(e){var t=H.getProfile();return t&&(t.name||t.mobile)&&!e?Promise.resolve(t):wr.userProfile().then((function(e){return H.saveProfile(e),e}))},getRosterMessageByRid:function(e){return ie.getRosterMessage(e)},readRosterMessage:function(e,t){Z("imReadRosterMessage",{roster_id:e,mid:t})},asyncDeleteRoster:function(e){return wr.rosterDelete(e).then((function(t){return ce.removeRoster(e.user_id),te.deleteRecentById(e.user_id),Z("onRosterListUpdate"),t}))},getAllRosterDetail:function(){return ce.getAllRosterInfos()},recallMessage:function(e,t){t=Dn(e,t),Z("swapSendMessage",C(t)),Z("sendMessage",t)},deleteMessage:function(e,t){t=function(e,t){t=D(t);var n=new mn;n.setCommond(p.SYNC);var r=new hn({uid:H.getUid(),deviceSN:Tn}),o=new hn({uid:M(e),deviceSN:0}),i=new Nn,s=new yn({ctype:b.COMMAND,type:_.OPER,operation:{type:E.DELETE,mid:t,xid:o}}),a=new An({id:parseInt((new Date).getTime()+""+Math.floor(256*Math.random())),from:r,to:r,payload:s,ns:m.MESSAGE});return i.setMeta(a),n.setPayload(i),n}(e,t),Z("swapSendMessage",C(t)),Z("sendMessage",t)},getUnreadCount:function(e){return ie.getUnreadByRosterId(e)},unreadMessage:function(e,t){t=function(e,t){t=D(t);var n=new mn;n.setCommond(p.SYNC);var r=new hn({uid:H.getUid(),deviceSN:Tn}),o=new hn({uid:M(e),deviceSN:0}),i=new Nn,s=new yn({ctype:b.COMMAND,type:_.OPER,operation:{type:E.READ_CANCEL,mid:t,xid:o}}),a=new An({id:parseInt((new Date).getTime()+""+Math.floor(256*Math.random())),from:r,to:r,payload:s,ns:m.MESSAGE});return i.setMeta(a),n.setPayload(i),n}(e,t),Z("swapSendMessage",C(t)),Z("sendMessage",t)},getRosterInfo:function(e){return ce.getRosterInfo(e)},asyncGetApplyList:wr.rosterApplylist,asyncGetBlockedlist:wr.rosterBlockedlist,asyncBlockeAdd:wr.rosterBlockedAdd,asyncBlockeRemove:wr.rosterBlockeRemove,asyncApply:wr.rosterApply,asyncAccept:wr.rosterAccept,asyncDecline:wr.rosterDecline,asyncUpdateRosterExt:wr.rosterExt,asyncSearchRosterByName:wr.rosterName,asyncSearchRosterById:wr.rosterId};X("imRostersGroupslistReady",(function(e){e=e.rosters,ce.saveRosterList([].concat(e)),Cr(e)}));var Tr={},Rr=function(e){return(new Date).getTime()-(Tr[e]||0)<1e3},Ir=function(e){var t=(new Date).getTime();Tr[e]=t},Cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(e)||(e=[e]);var t=ce.getAllRosterInfos()||{},n=[];e.forEach((function(e){var r,o,i,s;0<(e=e.user_id||e)&&(o=(r=t[e]||{}).avatar,i=r.nick_name,s=r.username,o||i||s||e&&!Rr(e)&&n.push(e)&&Ir(e))})),n.length&&Dr(n)},kr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e)||(e=[e]),t)Ur(e);else{var n=F.getAllGroupInfos()||{},r=[];e.forEach((function(e){var t=e.group_id||e;0<e&&((n[t]||{}).name||r.push(t))})),r.length&&Ur(r)}},Mr=[],Dr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return Mr.indexOf(e)<0}));t.length&&Le({list:t}).then((function(e){t.forEach((function(t){e.findIndex((function(e){return e.user_id==t}))<0&&Mr.push(t)})),ce.saveRosterInfo(e),Z("onRosterInfoUpdate")}))},Ur=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&wt({group_list:e}).then((function(e){F.saveGroupInfo(e),Z("onGroupListUpdate")}))},Pr=function(e,t,n,r){if(n){var o=F.getGroupMembers(e);if(!o||!o.length)return}void 0!==t&&(Array.isArray(t)||(t=[t]),St({group_id:e,user_list:t}).then((function(t){if(t&&t.length){var n=[],o=ce.getAllRosterInfos();t.forEach((function(e){o[e.user_id]&&o[e.user_id].username?(e.display_name=e.display_name||o[e.user_id].username,e.avatar=o[e.user_id].avatar):n.push(e.user_id)})),n.length?Le({list:n}).then((function(n){ce.saveRosterInfo(n);var o=ce.getAllRosterInfos();t=t.map((function(e){return e.display_name||(e.display_name=e.display_name||o[e.user_id].username),e.avatar=o[e.user_id].avatar,e})),F.saveGroupMembers(e,t,r),Z("onGroupMemberChanged",e)})):(F.saveGroupMembers(e,t,r),Z("onGroupMemberChanged",e))}})))},xr=function(e,t){var n,r=F.getGroupMembers(e);!r||0===r.length||0<=(n=r.findIndex((function(e){return e.user_id===t})))&&(r.splice(n,1),F.saveGroupMembers(e,r,!0),Z("onGroupMemberChanged",e))};X("imRostersGroupslistReady",(function(e){e=e.groups,F.saveJoinedGroups([].concat(e)),kr(e)})),X("imRosterMessage",(function(e){var t=P(e),n=t.ext,r=void 0===n?"":n,o=t.from,i=t.to,s={};try{s=JSON.parse(r)}catch(e){}if(void 0!==s.input_status&&o!=H.getUid())Z("onInputStatusMessage",{ext:r,from:o,to:i});else{ie.saveRosterMessage(t),t.toType="roster",te.saveRecent(t);var a=H.getUid()==o?i:o;Cr(a),Z("onUnreadChange",a)}Z("onRosterMessage",t)})),X("imSendRosterMessage",(function(e){Cr(e.uid)})),X("imGetRecent",(function(e){Cr(e)})),X("imGroupMessage",(function(e){var t=P(e);ie.saveGroupMessage(t),t.toType="group",te.saveRecent(t);var n=H.getUid(),r=t.config;r&&r.mentionList&&0<=r.mentionList.indexOf(n)&&Z("onMentionMessage",t),Z("onGroupMessage",t)})),X("imReceivedUnread",(function(e){var t=e.filter((function(e){return 1===e.type})).map((function(e){return M(e.xid.uid)}));e=e.filter((function(e){return 2===e.type})).map((function(e){return M(e.xid.uid)})),Lr(t),Cr(t),jr(e),kr(e)}));var Lr=function(e){var t=ce.getAllRosterInfos()||{},n=[];e.forEach((function(e){var r=t[e]||{},o=r.avatar,i=r.nick_name,s=r.username;o||i||s||e&&!Rr(e)&&n.push(e)&&Ir(e)})),n.length?Le({list:n}).then((function(t){ce.saveRosterInfo(t),te.saveUnreadRecent(e,"roster")})):te.saveUnreadRecent(e,"roster")},jr=function(e){var t=F.getAllGroupInfos()||{},n=[];e.forEach((function(e){(t[e]||{}).name||e&&n.push(e)})),n.length?wt({group_list:n}).then((function(t){F.saveGroupInfo(t),Z("onGroupListUpdate"),te.saveUnreadRecent(e,"group")})):te.saveUnreadRecent(e,"group")};X("imRosterAdded",(function(e){var t=i=e.payload,n=t.to,r=void 0===n?[]:n,o=t.from,i=H.getUid();1===r.length&&M(r[0].uid)===i&&(Cr([M(o.uid)]),ce.saveRosterList(M(o.uid)),Z("onRosterListUpdate",e))})),X("imRosterRemoved",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=H.getUid();if(M(n.uid)===i&&1===o.length){var s=M(o[0].uid);ce.removeRoster(s),se(e),te.deleteRecentById(s),ie.deleteRosterMessageByRosterId(s),Z("onRosterRemoved",e)}})),X("imRosterAccepted",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=H.getUid(),s=M(n.uid);if(1===o.length){var a=M(o[0].uid);s===i?(ce.saveRosterList(a),Cr(a)):a===i&&(ce.saveRosterList(s),Cr(s)),Z("onRosterAccepted",e)}})),X("imRosterDeclined",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=H.getUid(),s=M(n.uid);if(1===o.length){var a=M(o[0].uid);s!==i&&a!==i||se(e),Z("onRosterDeclined",e)}})),X("imRrosterBaned",(function(e){Z("onRosterNotice",e)})),X("imRosterUnbaned",(function(e){Z("onRosterNotice",e)})),X("imRosterInfoUpdated",(function(e){var t=o=e.payload,n=t.from,r=t.content,o=void 0===r?"{}":r,i=(n=M(n.uid),{});try{i=JSON.parse(o)}catch(e){}Object.keys(i).length&&(n=Object.assign({},ce.getRosterInfo(n),i),ce.saveRosterInfo([n]),Z("onRosterInfoUpdated"),Z("onRosterListUpdate"))})),X("imGroupCreated",(function(e){var t=o=e.payload,n=t.gid,r=t.from,o=H.getUid();n=M(n.uid),r=M(r.uid),F.saveJoinedGroups(n),r!==o&&Cr(r),kr(n),Z("onGroupListUpdate",e),Z("onGroupCreated",e)})),X("imGroupDestoryed",(function(e){var t=i=e.payload,n=t.gid,r=t.from,o=H.getUid(),i=M(n.uid);(r=M(r.uid))!==o&&Cr(r),F.removeGroup(i),se(e),te.deleteRecentById(n),ie.deleteGroupMessageByGid(n),Z("onGroupListUpdate"),Z("onGroupDestoryed",e)})),X("imGroupJoined",(function(e){var t=e.payload,n=t.gid,r=t.from,o=t.to,i=void 0===o?[]:o,s=M(r.uid),a=H.getUid(),u=M(n.uid),c=[];i.forEach((function(e){c.push(M(e.uid))})),s===a?(F.saveJoinedGroups(u),kr(u),Z("onGroupListUpdate")):(Pr(u,s,!0),Cr(s),Z("onGroupMemberChanged",u)),Z("onGroupJoined",e)})),X("imGroupApplyed",(function(e){var t=(t=e.payload).from;(t=M(t.uid))!==H.getUid()&&(Cr([t]),se(e))})),X("imGroupApplyAccepted",(function(e){var t=e.payload,n=t.gid,r=t.from,o=t.to,i=void 0===o?[]:o,s=M(r.uid),a=H.getUid(),u=M(n.uid),c=[];i.forEach((function(e){c.push(M(e.uid))})),s===a?(Cr(c),Pr(u,c,!0),Z("onGroupMemberChanged",u)):(F.saveJoinedGroups(u),kr(u),Cr(s),Z("onGroupListUpdate")),Z("onGroupApplyAccepted",e)})),X("imGroupApplyDeclined",(function(e){var t=e.payload,n=t.from,r=t.to,o=M(n.uid),i=H.getUid(),s=[];r.forEach((function(e){s.push(M(e.uid))})),o===i?Cr(s):se(e),Z("onGroupApplyDeclined",e)})),X("imGroupInvited",(function(e){var t=e.payload,n=t.gid,r=t.from,o=t.to,i=void 0===o?[]:o,s=M(r.uid),a=H.getUid(),u=M(n.uid),c=[];i.forEach((function(e){c.push(M(e.uid))})),s!==a&&-1<c.findIndex((function(e){return e===a}))?(Cr(s),kr(u),se(e)):Cr(c),Z("onGroupNotice",e)})),X("imGroupInvitedAccepted",(function(e){var t=e.payload,n=t.gid,r=t.from,o=t.to,i=void 0===o?[]:o,s=M(r.uid),a=H.getUid(),u=M(n.uid),c=[];i.forEach((function(e){c.push(M(e.uid))})),s===a?(F.saveJoinedGroups(u),kr(u),Z("onGroupListUpdate")):(Pr(u,s,!0),Cr(s),Z("onGroupMemberChanged",u)),Z("onGroupInvitedAccepted",e)})),X("imGroupInvitedDeclined",(function(e){var t=o=e.payload,n=t.gid,r=t.from,o=M(r.uid);r=H.getUid(),n=M(n.uid),o===r?(se(e),kr(n)):Cr(o),Z("onGroupInvitedDeclined",e)})),X("imGroupKicked",(function(e){var t=(e=Object.assign({},e)).payload,n=t.gid,r=t.to,o=void 0===r?[]:r,i=H.getUid(),s=M(n.uid),a=[];o.forEach((function(e){a.push(M(e.uid))})),-1<a.findIndex((function(e){return e===i}))?(F.removeGroup(s),se(e),te.deleteRecentById(n),ie.deleteGroupMessageByGid(n),Z("onGroupListUpdate")):xr(s,a)})),X("imGroupBlocked",(function(e){var t=e.payload,n=t.gid,r=t.to,o=void 0===r?[]:r,i=H.getUid(),s=M(n.uid),a=[];o.forEach((function(e){a.push(M(e.uid))})),-1<a.findIndex((function(e){return e===i}))?(F.removeGroup(s),se(e),te.deleteRecentById(n),ie.deleteGroupMessageByGid(n),Z("onGroupListUpdate")):(Cr(a),xr(s,a))})),X("imGroupUnblocked",(function(e){var t=e.payload.to,n=[];(void 0===t?[]:t).forEach((function(e){n.push(M(e.uid))})),Cr(n)})),X("imGroupOwnerAssigned",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=M(n.uid),s=H.getUid(),a=[];o.forEach((function(e){a.push(M(e.uid))})),i!==s&&a.push(i),Cr(a),Z("onGroupOwnerAssigned",e)})),X("imGroupAdminGranted",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=M(n.uid),s=H.getUid(),a=[];o.forEach((function(e){a.push(M(e.uid))})),i!==s&&a.push(i),Cr(a),Z("onGroupAdminGranted",e)})),X("imGroupAdminRevoked",(function(e){var t=e.payload,n=t.from,r=t.to,o=void 0===r?[]:r,i=M(n.uid),s=H.getUid(),a=[];o.forEach((function(e){a.push(M(e.uid))})),i!==s&&a.push(i),Cr(a),Z("onGroupAdminRevoked",e)})),X("imGroupMuted",(function(e){Z("onGroupMuted",e)})),X("imGroupUnblocked",(function(e){Z("onGroupUnblocked",e)})),X("imGroupBaned",(function(e){Z("onGroupBaned",e)})),X("imGroupUnbaned",(function(e){Z("onGroupUnbaned",e)})),X("imGroupInfoUpdated",(function(e){var t=o=e.payload,n=t.gid,r=t.content,o=void 0===r?"{}":r,i=(n=M(n.uid),{});try{i=JSON.parse(o)}catch(e){}Object.keys(i).length&&(n=Object.assign({},F.getGroupInfo(n),i),F.saveGroupInfo([n]),Z("onGroupListUpdate"))})),X("imGroupAnnouncementUpdated",(function(e){var t=(t=e.payload).gid;t=M(t.uid),kr(t,!0),Z("onGroupAnnouncementUpdated",e)})),X("imReadRosterMessage",(function(e){var t=e.roster_id,n=e.mid,r=e.isReceived,o=!1;if(n){var i=ie.getRosterMessageById(t,n);if(Gr(i)&&!r){o=!0;var s=Mn(t,n);Z("sendMessage",s)}}else{var a,u=ie.getRosterMessage(t);if(u.forEach((function(e){if(Gr(e)&&!r){o=!0;var n=Mn(t,e.id);Z("sendMessage",n)}a=e.id})),ie.saveFormatedRosterMessage(t,u),!r&&o){var c=Un(t,a);Z("sendMessage",c)}}o&&Z("onUnreadChange",t)}));var Gr=function(e){var t=!1,n=Br(e,I.READ);if(e&&n){var r=H.getUid(),o=M(e.from);0<o&&o!=r&&(t=!0)}return t},Br=function(e,t){var n=!1;if(e&&e.status!=t){var r=e;r.status=t,ie.saveRosterMessage(P(r)),n=!0}return n};X("imReadGroupMessage",(function(e){var t=e.group_id,n=e.mid,r=e.isReceived,o=!1;if(n){var i=ie.getGroupMessageById(t,n);if(Vr(i)&&!r){o=!0;var s=U(i.from),a=Mn(s,n);Z("sendMessage",a)}}else{var u,c=ie.getGroupMessage(t);if(c.forEach((function(e){if(Vr(e)&&!r){o=!0;var t=U(e.from),n=Mn(t,e.id);Z("sendMessage",n)}u=e.id})),ie.saveFormatedGroupMessage(t,c),!r&&o){var f=Un(t,u);Z("sendMessage",f)}}o&&Z("onUnreadChange",t)}));var Vr=function(e){var t=!1,n=Fr(e,I.READ);if(e&&n){var r=H.getUid(),o=M(e.from);0<o&&o!=r&&e.config&&e.config.groupMemberList&&(t=!0)}return t},Fr=function(e,t){var n=!1;if(e&&e.status!=t){var r=e;r.status=t,ie.saveGroupMessage(P(r)),n=!0}return n},Qr=function(e,t){var n;0<(n=t?ie.getGroupMessage(e):ie.getRosterMessage(e)).length&&te.saveRecent(n[n.length-1])};X("onActionMessage",(function(e){var t,n=e,r=n.payload,o=n.from,i=n.to,s=n.isReceived,a=r,u=a.type,c=a.operation,f=void 0===c?{}:c;e=H.getUid()+"",r=i?U(i.uid):0,o=e==(i=U(o.uid))+""?r:i,e=-1!=F.getJoinedGroups().indexOf(+r),u===_.OPER&&(i=(t=f).type,r=t.mid,u=t.xid,f=e?ie.getGroupMessageById(o,r):ie.getRosterMessageById(o,r),i===E.READ_ACK?(e||Gr(f),e&&Vr(f)):i===E.DELIVER_ACK?(e||Br(f,I.DELIVERED),e&&Fr(f,I.DELIVERED)):i===E.RECALL?(e||ie.deleteSingleRosterMessage(o,r),e&&ie.deleteSingleGroupMessage(o,r),Qr(o,e),Z("onMessageRecalled",{uid:o,mid:r})):i===E.DELETE?(e||ie.deleteSingleRosterMessage(u.uid,r),e&&ie.deleteSingleGroupMessage(u.uid,r),Qr(u.uid,e),Z("onMessageDeleted",{uid:u.uid,mid:r})):i===E.READ_CANCEL?(e||Br(f,I.UNREAD),e&&Fr(f,I.UNREAD),Z("onMessageCanceled",{uid:o,mid:r})):i===E.READ_ALL&&(e?Z("imReadGroupMessage",{group_id:u.uid,mid:r,isReceived:s}):Z("imReadRosterMessage",{roster_id:u.uid,mid:r,isReceived:s})),o=U(u&&u.uid?u.uid:o),Z("onMessageStatusChanged",{uid:o,mid:U(r)}),Z("onUnreadChange",o))}));var qr={};X("swapSendMessage",(function(e){var t=(t=(t=e.payload).meta).id;qr[U(t)]=e})),X("receivedSendMessage",(function(e){if(e=U(e),e=qr[e]){var t=e.payload.meta;t.payload.type===_.OPER&&Z("onActionMessage",t)}})),X("deleteConversation",(function(e){var t=e.id;return function(e){Z("flooNotice",{category:"conversation_deleted",desc:{id:t,source:e}});var n=te.getRecentById(t),r=n.idx;e=n.type,r<0||("group"==e?ie.deleteGroupMessageByGid(t):ie.deleteRosterMessageByRosterId(t),te.deleteRecentById(t))}(e.source)}));var Kr=Pr,Jr={asyncGetGroupInfo:function(e,t){var n=F.getGroupInfo(e-=0)||{};return n.name&&!t?Promise.resolve(n):wr.groupInfo({group_id:e}).then((function(e){return F.saveGroupInfo([e]),e}))},asyncGetJoinedGroups:function(e){return e?wr.groupUserjoined({}).then((function(e){return Array.isArray(e)?e:F.getGroupInfoList()})):Promise.resolve(F.getGroupInfoList())},openGroup:function(e){wr.groupMemberlist({group_id:e}).then((function(t){F.saveGroupMembers(e,t),(t=t.map((function(e){return e.user_id}))).length&&Kr(e,t,!1,!0),Z("onGroupMemberChanged",e)}))},getAllGroupDetail:function(){return F.getAllGroupInfos()},asyncGetGroupMembers:function(e){return wr.groupMemberlist({group_id:e}).then((function(t){return F.saveGroupMembers(e,t),(t=t.map((function(e){return e.user_id}))).length&&Kr(e,t,!1,!0),t}))},getGroupMembers:function(e){return F.getGroupMembers(e)||[]},asyncGetGroupListDetail:function(e){return e&&e.length?wr.groupInfoBatch({group_list:e}).then((function(e){return F.saveGroupInfo(e),e})):Promise.resolve({})},getGruopMessage:function(e){return ie.getGroupMessage(e)},readGroupMessage:function(e,t){Z("imReadGroupMessage",{group_id:e,mid:t})},recallMessage:function(e,t){t=Dn(e,t),Z("sendMessage",t),Z("swapSendMessage",t)},getUnreadCount:function(e){return ie.getUnreadByGroupId(e)},asyncGetAdminList:wr.groupAdminList,asyncAdminAdd:wr.groupAdminAdd,asyncAdminRemove:wr.groupAdminRemove,asyncGetAnouncementById:wr.groupAnnouncement,asyncAnouncementDelete:wr.groupAnnouncementDelete,asyncAnnouncementEdit:wr.groupAnnouncementEdit,asyncGetAnnouncementList:wr.groupAnnouncementList,asyncCreate:wr.groupCreate,asyncDestroy:wr.groupDestroy,asyncGetInfo:function(e){return e.group_id||(e={group_id:e}),wr.groupInfo(e)},asyncUpdateAvatar:wr.groupInfoAvatar,asyncUpdateDescription:wr.groupInfoDdscription,asyncUpdateName:wr.groupInfoName,asyncGetMemberList:function(e){return e.group_id||(e={group_id:e}),wr.groupMemberlist(e)},asyncGroupMsgMutemode:wr.groupMsgMutemode,asyncGetPublicList:wr.groupPubliclist,asyncUpdateMsgNotDisturb:wr.groupMsgNotdisturb,asyncGroupBannedList:wr.groupBannedList,asyncGroupBab:wr.groupBab,asyncGroupUnban:wr.groupUnban,asyncGetSettings:wr.groupSettings,asyncUpdateAllowMemberInvitation:wr.groupSettingsAllowmemberinvitation,asyncUpdateAllowMemberModify:wr.groupSettingsAllowmembermodify,asyncUpdateEnableReadack:wr.groupSettingsEnablereadack,asyncUpdateHistoryVisible:wr.groupSettingsHistoryvisible,asyncUpdateRequireadminapproval:wr.groupSettingsRequireadminapproval,asyncOwnerTransfer:wr.groupTransfer,asyncGetUserJoined:wr.groupUserjoined,asyncApply:wr.groupApply,asyncApplyHandle:wr.groupApplyHandle,asyncGroupBockedlist:wr.groupBockedlist,asyncGroupBlock:wr.groupBlock,asyncGroupUnblock:wr.groupUnblock,asyncKick:wr.groupKick,asyncGetInvitationList:wr.groupInvitationlist,asyncInvite:wr.groupInvite,asyncInviteHandle:wr.groupInviteHandle,asyncGetMemberDisplayName:wr.groupMembersDidpayname,asyncLeave:wr.groupLeave,asyncUpdateDisplayName:wr.groupDisplayname,asncGetApplicationList:wr.groupApplicationlist,asyncGetFileList:wr.groupFilelist,asyncFileDelete:wr.groupFiledelete,asyncFileUpload:wr.groupFileupload};i={getToken:function(){return H.getToken()},getUid:function(){return H.getUid()},getAppid:function(){return H.getAppid()},getConversationList:function(){return te.getRecents()},deleteToken:H.deleteToken,getDeviceSN:function(){return H.getDeviceSN()},asyncBindDeviceToken:wr.bindDeviceToken,asyncUnbindDeviceToken:wr.unbindDeviceToken,asyncTokenUser:wr.tokenUser,asyncTokenId:wr.tokenId,asyncRegister:wr.userRegister,asyncUserBindMobile:wr.userBindMobile,asyncUserUpdateMobile:wr.userUpdateMobile,asyncUserSendSms:wr.userSendSms,asyncCaptchaSms:wr.captchaSms,asyncUserNameCheck:wr.userNameCheck,asyncUserMobileBind:wr.userMobileBind,asyncUserMobileBindSign:wr.userMobileBindSign,asyncUserMobileLogin:wr.userMobileLogin,asyncCaptchaImagePost:wr.captchaImagePost,asyncUpdateAuthmode:wr.userAuthmode,asyncUpdateAvatar:wr.userAvatar,asyncUpdateMobile:wr.userMobile,asyncUpdateNickName:wr.userNickname,asyncGetProfile:wr.userProfile,asyncUpdateProfile:wr.userProfilePost,asyncGetSettings:wr.userSettings,asyncUpdateSettings:wr.userSettingsPost};var Wr=function(e,t){return t&&e?e+"_"+t:""},Hr=function(e){if(!e)return{};var t=$r("ws"),n=zr(e),r=n.clusters,o=n.clusterIndex,i=n.ratelIndex;return e=n.fireIndex,r&&r.length?(i=(o=r[o]).ratel[i],e=(o.webim||o.ws)[e],i&&e?{ratel:i.protocol+"://"+i.host,fireplace:(t?"https"===e.protocol?"wss":"ws":e.protocol)+"://"+e.host}:{}):{}};X("ratelError",(function(){c.log("Ratel error, should try next in list"),function(e){var t=zr(e),n=t.clusters,r=t.clusterIndex,o=t.ratelIndex,i=t.fireIndex;n[r].ratel.length>o+1?(o++,Xr(e,{clusters:n,clusterIndex:r,ratelIndex:o,fireIndex:i})):Yr(e)}(e=$r("app_id"));var e=(Hr(e)||{}).ratel;Z("refresh_ratel",e)})),X("fireplaceError",(function(){var e=$r("app_id");c.log("Fireplace error, should try next in list, appid: ",e),function(e){var t=zr(e),n=t.clusters,r=t.clusterIndex,o=t.ratelIndex,i=t.fireIndex,s=n[r];(s.webim||s.ws).length>i+1?(i++,Xr(e,{clusters:n,clusterIndex:r,ratelIndex:o,fireIndex:i})):Yr(e)}(e),e=(Hr(e)||{}).fireplace,Z("refresh_fireplace",e)}));var Yr=function(e){for(var t=zr(e),n=t.clusters,r=t.clusterIndex;n.length>r+1;){var o=n[++r];if(0<=(o.webim||o.ws).length)return void Xr(e,{clusters:n,clusterIndex:r,ratelIndex:0,fireIndex:0})}Z("retrieve_dns")},zr=function(e){return j(Wr("key_dns_infos",e),!1)||{}},Xr=function(e,t){L(Wr("key_dns_infos",e),t,!1)},$r=function(e){return e?j(Wr("key_dns_config",e),!1):""},Zr=function(e,t){e&&t&&L(Wr("key_dns_config",e),t,!1)};X("retrieve_dns",(function(){var e=$r("dns_server"),t=$r("app_id"),n=$r("ws");c.warn("Retrieve DNS for appid: ",t),eo(e,t,n)}));var eo=function(e,t,n){return Zr("dns_server",e),Zr("app_id",t),Zr("ws",n),(n=Hr(t)).ratel?Promise.resolve(n):ve(e,{app_id:t}).then((function(e){return c.info("DNS SUCCESS: ",e),function(t){if(t){var n=e.version,r=e.dns_list,o=r.findIndex((function(e){return 0==e.group_level}));if(o<0)return c.error("DNS ERROR: no available clusters (version:",n,")");var i={clusters:r[o].clusters,clusterIndex:0,ratelIndex:0,fireIndex:0};Xr(t,i)}}(t),Hr(t)}))},to={asyncGetDns:eo,getServers:Hr},no=function(e){var t=e.url,n=void 0===t?"":t,r=e.params,o=void 0===r?{}:r;if(!n)return"";var i=H.getToken(),s=H.getAppid();return o=Object.assign(o,{"access-token":i,app_id:s}),0<n.indexOf("?")?n+="&":n+="?",n+fe.a.stringify(o)};ae={getStaticVars:function(){return o},sendRosterMessage:function(e){var t=kn(e);e=t.payload.meta,ie.saveSendingRosterMessage(e),wr.sendMessage(t)},sendGroupMessage:function(e){var t=Cn(e);e=t.payload.meta,ie.saveSendingGroupMessage(e),wr.sendMessage(t)},sendMentionMessage:function(e){var t=function(){var t=e.gid,n=e.txt,r=e.mentionAll,o=e.mentionList,i=e.mentionedMessage,s=e.pushMessage,a=e.senderNickname,u=b.TEXT,c=new hn({uid:+H.getUid(),deviceSN:Tn}),f=new hn({uid:t,deviceSN:0}),d=new mn;d.setCommond(p.SYNC);var l=new Nn,h=new yn({from:c,to:f,content:n,ctype:u,type:_.GROUPCHAT});return h.config=JSON.stringify({mentionAll:r,mentionList:o,mentionedMessage:i,pushMessage:s,senderNickname:a}),a=new An({id:(new Date).getTime(),from:c,to:f,payload:h,ns:m.MESSAGE}),l.setMeta(a),d.setPayload(l),d}(),n=t.payload.meta;ie.saveSendingGroupMessage(n),wr.sendMessage(t)},sendInputStatusMessage:function(e,t){t=function(e,t){var n=b.TEXT,r=new hn({uid:+H.getUid(),deviceSN:Tn}),o=new hn({uid:+e,deviceSN:0}),i=new mn;i.setCommond(p.SYNC);var s=new Nn,a=new yn({from:r,to:o,ctype:n,type:_.CHAT,ext:JSON.stringify({input_status:t}),qos:N.AT_MOST_ONCE}),u=new An({id:(new Date).getTime(),from:r,to:o,payload:a,ns:m.MESSAGE});return s.setMeta(u),i.setPayload(s),i}(e,t),wr.sendMessage(t)},sendMessage:wr.sendMessage,getNoticeMessage:ae(),getMessageStatus:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?ie.getGroupMessageById(e,t):ie.getRosterMessageById(e,t),o=Object.keys(I)[r.status];return o?o.toLowerCase():void 0},forwardMessage:function(e){var t,n=e,r=n.uid,o=n.mid,i=n.gid,s=(t=r?ie.getRosterMessageById(r,o):ie.getGroupMessageById(i,o)).attach;if(s&&s.url){e=s.url.split("sign=")[1];var a=H.getToken();wr.fileForward({file_sign:e,"access-token":a,to_id:+(r||i),to_type:r?1:2}).then((function(e){t.attach.url=e;var n=Pn(r,i,t);e=n.payload.meta,r?ie.saveSendingRosterMessage(e):ie.saveSendingGroupMessage(e),wr.sendMessage(n)}))}else{var u=Pn(r,i,t),c=u.payload.meta;r?ie.saveSendingRosterMessage(c):ie.saveSendingGroupMessage(c),wr.sendMessage(u)}},asyncFileUpload:function(e){return new Promise((function(t,n){var r=e.group_id,o=e.to_id,i=e.toType,s=e.file,a=e.fileType,u=e.chatType,f="rosterAvatar"===i?"fileUploadAvatarUrl":"chat"==i?"fileUploadChatFileUrl":"fileUploadGroupAvatarUrl",d={},l=H.getToken();"groupAvatar"===i&&(d["access-token"]=l),a&&(d.file_type=["file","audio","image","video","audio-mp3"].indexOf(a)+100),d<100&&(d.file_type=["shareFile","shareAudio","shareImage","shareVideo"].indexOf(a)+200),r&&(d.group_id=r),"group"==u&&(d.to_type=2),"roster"==u&&(d.to_type=1),o&&(d.to_id=o),wr[f](d).then((function(e){var n={filePath:s,name:"file"};e.oss_body_param&&e.oss_body_param.key&&(n=Object.assign(n,{formData:{OSSAccessKeyId:e.oss_body_param.OSSAccessKeyId,policy:e.oss_body_param.policy,signature:e.oss_body_param.signature,callback:e.oss_body_param.callback,key:e.oss_body_param.key}})),wr.asyncFileUpload(e.upload_url,n,{operation:"upload_file"}).then((function(){t({url:e.download_url})})).catch((function(e){c.error("Fail to upload file due to ",e)}))})).catch((function(e){n(e)}))}))},requireHistoryMessage:function(e,t,n){n=function(e,t,n){t=D(t);var r=new mn;r.setCommond(p.SYNC);var o=new hn({uid:M(e),deviceSN:0}),i=new Nn;return i.setXid(o),i.setKey(M(t)),i.setFullsyncnum(n),i.setIsfullsync(!0),r.setPayload(i),r}(e,t,n),wr.sendMessage(n)},makeSearch:function(e){var t=[],n=[];return(ce.getRosterInfoList()||[]).forEach((function(n){var r=!1,o=n.user_id,i=n.username,s=n.avatar;(ie.getRosterMessage(o)||[]).forEach((function(n){if(!r){var a=n.payload,u=(void 0===a?{}:a).content,c=void 0===u?"":u;0<=c.indexOf(e)&&(r=!0,t.push({user_id:o,username:i,avatar:s,content:c}))}})),r||0<=i.indexOf(e)&&t.push({user_id:o,username:i,avatar:s})})),F.getGroupInfoList().forEach((function(t){var r=!1,o=t.group_id,i=t.name;(ie.getGroupMessage(o)||[]).forEach((function(t){if(!r){var s=t.payload,a=(void 0===s?{}:s).content,u=void 0===a?"":a;0<=u.indexOf(e)&&(r=!0,n.push({group_id:o,name:i,content:u}))}})),r||0<=i.indexOf(e)&&n.push({group_id:o,name:i})})),{rosterArr:t,groupArr:n}},asyncGetUserAvatarUploadUrl:wr.fileUploadAvatarUrl,asyncGetGroupAvatarUploadUrl:wr.fileUploadGroupAvatarUrl,asyncGetFileUploadChatFileUrl:wr.fileUploadChatFileUrl,asyncQrcode:wr.qrcode,asyncQrlogin:wr.qrlogin,asyncQrcodeGroupsign:wr.qrcodeGroupsign,asyncQrcodeGroupinvite:wr.qrcodeGroupinvite,asyncWxlogin:wr.wxlogin,asyncWxbind:wr.wxbind,asyncGetStaticContact:wr.getStaticContact,getImage:function(e){var t=e.avatar,n=void 0===t?"":t,r=e.type,o=void 0===r?"roster":r,i=e.thumbnail,s=void 0===i||i,a=e.sdefault;return function(e){if(/^\//.test(n))return n;if(!n)return"roster"===o?e||"/static/image/roster.png":e||"/static/image/group.png";var t=n,r={};if(0!==n.indexOf("http")){var i=H.getAppid();e=(to.getServers(i)||{}).ratel,!/\/$/.test(e)&&5<e.length&&(t=e+"/file/download/avatar"),r=Object.assign(r,{object_name:n})}return s&&(r=Object.assign(r,{image_type:2})),no({url:t,type:"image",params:r})}(void 0===a?"":a)},getAudio:function(e){var t=e.url,n=e.type;return no({url:t,type:void 0===n?"audio":n,params:{format:"mp3"}})},getChatFile:no,downloadAudio:function(e){var t=e.url,n=void 0===t?"":t,r=e.type;return function(e){var t=e.url,n=void 0===t?"":t,r=e.params,o=void 0===r?{}:r;return n?wr.fileDownloadChatFileUrl(n,o,{operation:"download_file"}):""}({url:n,type:void 0===r?"audio":r,params:{format:"mp3"}})},getServers:to.getServers,asyncWechatUnbind:wr.wechatUnbind,asyncWechatIsbind:wr.wechatIsbind,asyncWechatBind:wr.wechatBind,deleteConversation:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Z("deleteConversation",{id:e,other_devices:t,source:"user_operation"}),t=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=R.DELETE;t&&(n=R.DELETE_EVERYWHERE);var r=new hn({uid:+H.getUid(),deviceSN:Tn}),o=new hn({uid:e}),i=new Sn({type:T.OPER,operation:{xid:o,type:n}}),s=new An({id:(new Date).getTime(),from:r,payload:i,ns:m.CONVERSATION}),a=new Nn;a.setMeta(s);var u=new mn;return u.setCommond(p.SYNC),u.setPayload(a),u}(e,t),wr.sendMessage(t)}};var ro={},oo=null,io=!1,so=!1,ao=function e(t){var n=t.autoLogin,r=void 0===n||n,o=t.dnsServer,i=void 0===o?"https://dns.maximtop.com/v2/app_dns":o,s=t.appid,a=void 0===s?"welovemaxim":s,u=t.ws,f=void 0!==u&&u;H.saveAppid(a),to.asyncGetDns(i,a,f).then((function(t){var n=t,o=n.ratel;if(t=n.fireplace,!o||!t)return c.log("DNS error, check the server: ",i),void Z("flooError",{category:"DNS_FAILED",desc:i});if(uo(a),e.baseUrl=(ro={appid:a,baseUrl:o,autoLogin:r,fireplace:t}).baseUrl,io=!0,oo){var s=oo.type;return"login"==s&&e.login(oo.opt),"qrlogin"==s&&e.qrlogin(oo.opt),void("tokenLogin"==s&&e.tokenLogin(oo.user_id,oo.token))}if(ro.autoLogin){so=!0;var u=H.getUid(),f=H.getToken();if(u&&f){var d=Sr.asyncGetRosterIdList(!0),l=Jr.asyncGetJoinedGroups(!0);Promise.all([d,l]).then((function(e){var t=e[0];e=e[1],Z("imRostersGroupslistReady",{rosters:t,groups:e}),c.log("get roster, group over .... will io connect"),wr.connect(ro)})).catch((function(e){Z("flooNotice",{category:"loginMessage",desc:"get roster list failure:"+e.message})}))}}})).catch((function(e){}))},uo=function(e){c.log("setup servers for app: ",e);var t=to.getServers(e)||{},n=t.ratel;e=t.fireplace,Z("refresh_ratel",n),Z("refresh_fireplace",e)};ao.login=function(e){io?(Z("flooNotice",{category:"loginMessage",desc:"getting token..."}),wr.tokenUser(e).then((function(e){var t=e,n=t.token,r=t.user_id,o=t.public_key;H.saveUid(r),H.saveToken(n),H.saveAesKey(o);var i=Sr.asyncGetRosterIdList(!0);e=Jr.asyncGetJoinedGroups(!0),so=!0,Z("flooNotice",{category:"loginMessage",desc:"token sucecc, getting roster lists.."}),Promise.all([i,e]).then((function(e){var t=e[0];e=e[1],Z("imRostersGroupslistReady",{rosters:t,groups:e}),c.log("get roster, group over .... will io connect"),ro=Object.assign({uid:r,token:n},ro),wr.connect(ro),oo=null})).catch((function(e){Z("flooNotice",{category:"loginMessage",desc:"get roster list failure:"+e.message})}))})).catch((function(e){Z("loginFail","token failure:"+e.message)}))):oo={type:"login",opt:e}},ao.qrlogin=function(e){io?(Z("flooNotice",{category:"loginMessage",desc:"getting token..."}),wr.tokenId(e).then((function(e){var t=e,n=t.token,r=t.user_id,o=t.public_key;H.saveUid(r),H.saveToken(n),H.saveAesKey(o);var i=Sr.asyncGetRosterIdList(!0);e=Jr.asyncGetJoinedGroups(!0),Z("flooNotice",{category:"loginMessage",desc:"token sucecc, getting roster lists.."}),so=!0,Promise.all([i,e]).then((function(e){var t=e[0];e=e[1],Z("imRostersGroupslistReady",{rosters:t,groups:e}),c.log("get roster, group over .... will io connect"),ro=Object.assign({uid:r,token:n},ro),wr.connect(ro),oo=null})).catch((function(e){Z("flooNotice",{category:"loginMessage",desc:"get roster list failure:"+e.message})}))})).catch((function(e){Z("loginFail","token failure:"+e.message)}))):oo={type:"qrlogin",opt:e}},ao.tokenLogin=function(e,t,n){var r;io?(H.saveUid(e),H.saveToken(t),H.saveAesKey(n),r=Sr.asyncGetRosterIdList(!0),n=Jr.asyncGetJoinedGroups(!0),Z("flooNotice",{category:"loginMessage",desc:"token sucecc, getting roster lists.."}),so=!0,Promise.all([r,n]).then((function(n){var r=n[0];n=n[1],Z("imRostersGroupslistReady",{rosters:r,groups:n}),c.log("get roster, group over .... will io connect"),ro=Object.assign({uid:e,token:t},ro),wr.connect(ro),oo=null})).catch((function(e){Z("flooNotice",{category:"loginMessage",desc:"get roster list failure:"+e.message})}))):oo={type:"tokenLogin",user_id:e,token:t}},ao.idLogin=function(e){wr.tokenId(e).then((function(e){var t=e,n=t.token,r=t.user_id,o=t.public_key;H.saveUid(r),H.saveToken(n),H.saveAesKey(o);var i=Sr.asyncGetRosterIdList(!0);e=Jr.asyncGetJoinedGroups(!0),Z("flooNotice",{category:"loginMessage",desc:"token success, getting roster lists.."}),so=!0,Promise.all([i,e]).then((function(e){var t=e[0]||[];t.push(r),e=e[1],Z("imRostersGroupslistReady",{rosters:t,groups:e}),c.log("get roster, group over .... will io connect"),ro=Object.assign({uid:r,token:n},ro),wr.connect(ro),oo=null})).catch((function(e){Z("flooNotice",{category:"loginMessage",desc:"get roster list failure:"+e.message})}))})).catch((function(e){Z("loginFail","token failure:"+e.message)}))},ao.wxlogin=function(){},ao.cleanup=function(){c.log("FLOO: IM logout, cleanup the data."),te.clear(),ce.clear(),F.clear(),H.clear(),ie.clearAll()},ao.isLogin=function(){return so&&H.getUid()&&H.getToken()},ao.on=ao.listen=function(e,t){t?X(e,t):Object.keys(e).forEach((function(t){X(t,e[t])}))},ao.off=function(e,t){t?$(e,t):Object.keys(e).forEach((function(t){$(t,e[t])}))},ao.logout=function(){wr.disConnect(),ao.cleanup()},ao.isReady=function(){return io},ao.disConnect=wr.disConnect;var co=ao;function fo(e){return new co(e),co}co.rosterManage=Sr,co.groupManage=Jr,co.userManage=i,co.sysManage=ae,n.default=fo}]).default);t.init=function(e){return(e=s(i({autoLogin:!0,ws:!0},e))).chatroomManage={create:function(e){var t=this;return this.groupManage.asyncCreate({name:e,type:2}).then((function(e){return t.groupManage.asyncUpdateRequireadminapproval({group_id:e.group_id,apply_approval:0})}))}.bind(e),join:function(e){return this.groupManage.asyncApply({group_id:e})}.bind(e),leave:function(e){return this.groupManage.asyncLeave({group_id:e})}.bind(e),destroy:function(e){return this.groupManage.asyncDestroy({group_id:e})}.bind(e)},e},t.version="1.0.1",Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,n(10).default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}));var o=n(42);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var i=n(14);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var s=n(13);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseApi=void 0;var r=n(13);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"signUpOrIn",value:function(e){return(0,r.request)({url:"/v1/signUpOrIn",method:"POST",data:e})}},{key:"getSmsCode",value:function(e){return(0,r.request)({url:"/v1/getSmsCode",method:"POST",data:e})}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();t.BaseApi=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRoomApi=void 0;var r=n(13),o=n(14);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(e){return Object.assign({type:"voiceChatRoom"},e)},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"createRoom",value:function(e){return(0,r.request)({url:"/v1/base/createRoom",method:"POST",header:{Authorization:o.StorageApi.getAuthorization()},data:s(e)})}},{key:"joinRoom",value:function(e){return(0,r.request)({url:"/v1/base/joinRoom",method:"POST",header:{Authorization:o.StorageApi.getAuthorization()},data:s(e)})}},{key:"leaveRoom",value:function(e){return(0,r.request)({url:"/v1/base/leaveRoom",method:"POST",header:{Authorization:o.StorageApi.getAuthorization()},data:s(e)})}},{key:"listRoom",value:function(e){return(0,r.request)({url:"/v1/base/listRoom",method:"GET",header:{Authorization:o.StorageApi.getAuthorization()},data:s(e)})}},{key:"heartBeat",value:function(e){return(0,r.request)({url:"/v1/base/heartBeat",method:"GET",header:{Authorization:o.StorageApi.getAuthorization()},data:s(e)})}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}();t.BaseRoomApi=a}]);